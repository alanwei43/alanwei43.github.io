<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Alan&#39;s Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Alan&#39;s Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Alan&#39;s Blog" href="/opensearch.xml">
<script src="/scripts/baidu.js"></script><title data-rh="true">Why Java Sucks and C# Rocks（2）：基础类型与面向对象  -  Alan&#x27;s Blog</title><meta data-rh="true" name="baidu-site-verification" content="code-7RGpEH8jty"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://blog.alanwei.com/docs/articles/why-java-sucks-and-csharp-rocks/basic-type-and-oop"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Why Java Sucks and C# Rocks（2）：基础类型与面向对象  -  Alan&#x27;s Blog"><meta data-rh="true" name="description" content="Why Java Sucks and C# Rocks"><meta data-rh="true" property="og:description" content="Why Java Sucks and C# Rocks"><meta data-rh="true" name="keywords" content="java,c#,csharp"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://blog.alanwei.com/docs/articles/why-java-sucks-and-csharp-rocks/basic-type-and-oop"><link data-rh="true" rel="alternate" href="https://blog.alanwei.com/docs/articles/why-java-sucks-and-csharp-rocks/basic-type-and-oop" hreflang="en"><link data-rh="true" rel="alternate" href="https://blog.alanwei.com/docs/articles/why-java-sucks-and-csharp-rocks/basic-type-and-oop" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://7SQ6A6EP36-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" src="/scripts/bing-clarity.js"></script><link rel="stylesheet" href="/assets/css/styles.b54318fb.css">
<link rel="preload" href="/assets/js/runtime~main.f0cbfc16.js" as="script">
<link rel="preload" href="/assets/js/main.e36c032d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_aKYr"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.png" alt="logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Alan&#x27;s Blog</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">文档</a><a class="navbar__item navbar__link" href="/blog">博客</a><a class="navbar__item navbar__link" href="/me">关于我</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/alanwei43" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_S7eR toggle_TdHA toggleDisabled_f9M3"><div class="toggleButton_rCf9" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" class="toggleScreenReader_g2nN" aria-label="Switch between dark and light mode (currently light mode)"></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y sidebarWithHideableNavbar_FoYL"><a tabindex="-1" class="sidebarLogo_FJUI" href="/"><img src="/img/logo.png" alt="logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.png" alt="logo" class="themedImage_W2Cr themedImage--dark_oUvU"><b>Alan&#x27;s Blog</b></a><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs">我的文档列表</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/docker">Docker</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" href="/docs/articles">系列文章</a><button aria-label="Toggle the collapsible sidebar category &#x27;系列文章&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/articles/es6-in-depth/introduction">深入浅出ES6</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/articles/okhttp-guide/overview">OkHttp 简介</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/articles/rabbitmq-guide/install">RabbitMQ 简介</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/articles/why-java-sucks-and-csharp-rocks/compare-purpose">Why Java Sucks and C# Rocks</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/articles/why-java-sucks-and-csharp-rocks/compare-purpose">比较的意义与目的</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/articles/why-java-sucks-and-csharp-rocks/basic-type-and-oop">基础类型与面向对象</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/articles/why-java-sucks-and-csharp-rocks/attribute-and-annotation">Attribute与Annotation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/articles/why-java-sucks-and-csharp-rocks/generics">泛型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/articles/why-java-sucks-and-csharp-rocks/anonymous-method">匿名方法</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/articles/why-java-sucks-and-csharp-rocks/yield">yield及其作用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/articles/why-java-sucks-and-csharp-rocks/4-1-reddit-and-property">Reddit，兼谈C#属性</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/articles/why-java-sucks-and-csharp-rocks/5-1-standard-event-model">标准事件模型</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/archives">博文分类</a><button aria-label="Toggle the collapsible sidebar category &#x27;博文分类&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/reading">阅读笔记</a><button aria-label="Toggle the collapsible sidebar category &#x27;阅读笔记&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/guides/api/client">Docusaurus文档翻译</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_cwdi"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_xORG"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/">🏠</a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/docs/articles">系列文章</a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link breadcrumbsItemLink_e5ie">Why Java Sucks and C# Rocks</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/docs/articles/why-java-sucks-and-csharp-rocks/basic-type-and-oop">基础类型与面向对象</a></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Why Java Sucks and C# Rocks（2）：基础类型与面向对象</h1></header><section><ul style="margin-left:-1em"><li>作者: <a href="http://blog.zhaojie.me/" target="_blank">老赵点滴</a></li><li>来源: <a href="http://blog.zhaojie.me/" target="_blank">http://blog.zhaojie.me/</a></li><li>本文仅用于本人学习和存档, 文章所有权归作者 <a href="http://blog.zhaojie.me/" target="_blank">老赵点滴</a> 所有, 如有侵权请发送邮件至 <a href="mailto:me@alanwei.com?subject=删除侵权文章" target="_top">me#alanwei.com(<i>#换成@</i>)</a> 删除此文.</li></ul></section><p><a href="http://blog.zhaojie.me/2010/04/why-java-sucks-and-csharp-rocks-2-primitive-types-and-object-orientation.html" target="_blank" rel="noopener noreferrer">原文 - Why Java Sucks and C# Rocks（2）：基础类型与面向对象</a></p><p>既然已经谈过<a href="http://blog.zhaojie.me/2010/04/why-java-sucks-and-csharp-rocks-1-thoughts-and-goals.html" target="_blank" rel="noopener noreferrer">这次语言比较的意义与目的</a>，而<a href="http://blog.zhaojie.me/2010/04/why-java-sucks-and-csharp-rocks-slides-final-version.html" target="_blank" rel="noopener noreferrer">完整的幻灯片和录音</a>也已经放出，那么接下来自然是详细讨论了。在这篇文章中，我会对两个语言的基本特征进行简单描述，并主要讨论两者对于基础类型的处理方式。在我看来，Java语言对于基础类型的处理方式，并不如C#中值类型般妥当。如果您有任何觉得不妥或是想要补充的意见，请不吝回复。由于C# 1.0发布于2002年，因此本文内容将基于Java 1.4及C# 1.0的情况。</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="java语言简单描述">Java语言简单描述<a class="hash-link" href="#java语言简单描述" title="Direct link to heading">​</a></h2><p>Java既是一个完整的平台，也是一门语言。Java语言是1995年由James Gosling在Sun Microsystems公司设计，作为Java平台的组成部分之一的语言。Java平台除了语言之外，还有两个组成部分，虚拟机（JVM）和类库。不过在这一系列文章中，我会将关注里放在Java语言这个单独的方面，偶尔会谈到一点JVM，而对于类库方面则几乎不会涉及。</p><p>Java语言参考了C语言和C++的设计，因此在代码整体风格上与它们比较类似。不过与C++相比，Java语言设计的更为小巧，简单和可靠。Java的类型分为两种：类（class）和基本类型（primitive type），并没有C++中的struct和union类型。同时，Java还提供了boolean类型，并对布尔类型的定义和使用作出了限制。此外，Java中也不允许开发人员进行运算符重载，但提供如synchronize等进行并发控制的语言特性。</p><p>Java语言设计的一大目标是可靠性，因此在Java中，部分元素的抽象级别被提高了，例如数组在Java中是预定义类的实例，在C++中就不是。此外，例如在数组访问中会进行下标范围检测，同时也去除了指针等不安全的语言特性。虽然Java中的“引用”也有些“指针”的意味，但更为安全，例如程序员不可以对指针进行算术运算，这样便避免了一些容易出错的做法。</p><p>在面向对象类型系统的设计中，Java不允许C++中的多重继承，因为许多人认为多重继承所带了许多复杂性和混乱，可谓弊大于利。不过Java允许开发人员定义“接口”，即一种“契约”而不包含实现，这在一定程度上也可以带来部分多重继承的优点。</p><p>总体而言，Java语言去除了C++中大量的复杂或是不安全的特性，这使的Java成为了一门灵活而强大，同时又更为小巧，简单和可靠的语言。从现在的角度看，Java语言大大降低了C++本身所带来的复杂度，让编程工作变的更为简单，具有很高的历史意义。</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="c语言简单描述">C#语言简单描述<a class="hash-link" href="#c语言简单描述" title="Direct link to heading">​</a></h2><p>C#语言是Anders Hejlsberg为微软.NET平台设计的一门语言。与Java语言不同的是，C#的定位只是.NET平台上各种语言中的一种——尽管如此，从现在来看，.NET平台和Java平台虽然起步不同，但可谓殊途同归。与Java平台比较类似，.NET平台除了多种语言之外，也有对应的虚拟机（CLR）及基础类库（BCL）。</p><p>C#的语言设计同样是基于C和C++的，但是也包括了一些Delphi和VB的思想。许多人觉得Java语言相比C++的优越之处在于“简单”，不过似乎C#的设计人员认为Java语言简化的有些太过了，因此C#将指针（受到一定限制）、struct、enum、运算符重载及goto等语言特性包含在C#语言中。不过，C#的设计人员同时也改进了这些特性，例如C#中的enum类型不能同整数类型进行隐式转换。同样，在C#的struct中，我们也可以为它定义构造函数和成员，并可以实现接口。</p><p>C#中还提供了一种数据类型“委托（Delegate）”，它可以被视为是一种类型安全的函数指针。一个委托也是一个对象，它明确定义了函数的签名，可以用来保存一个包含了调用时所需的上下文的函数。在.NET程序中，一个回调函数往往会使用委托进行表示，而在Java中，则一般会使用接口。</p><p>C#还提供了一些方便开发的特性，例如foreach，using，以及使用params定义可变长数组等等。此外，C#还提供了事件（event）及属性（property）两种对象的成员类型。属性可以简单理解为带有读写器（也可以只读或只写）的字段。Java语言虽然不包含属性，但很早便形成了一个约定，会将getXyz/setXyz方法作为属性处理，许多开发工具和类库都会以这种方式进行处理。</p><p>C#语言的初衷是要成为优越于C++和Java的通用程序设计语言。经过多年的发展，C#在语言设计方面的确遥遥领先于Java语言，这也是我写这一系列文章的事实依据。</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="java是个纯面向对象语言吗">Java是个纯面向对象语言吗？<a class="hash-link" href="#java是个纯面向对象语言吗" title="Direct link to heading">​</a></h2><p>Java在诞生于面向对象理论在业界愈发普及和流行的时期（著名的GoF设计模式一书便出版于1994年），在当时Java声称自己是个“纯面向对象语言”，但事实果真如此吗？我不这么认为，因为有很明显的一点是，Java语言中的基础类型不是对象。</p><p>在Java中定义了一系列基础数据类型，例如int，double，boolean等等。这些类型不是对象，它们不包含成员，也不继承于公共基类Object，因此Java并不是一门纯面向对象语言。</p><p>不过，其实我关注的并不是“纯面向对象”这个称号，我更关注Java语言在设计时是如何对待这些类型的。从代码上看，这个特点的确造成了诸多不便：</p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx java"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ArrayList list = new ArrayList();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">list.add(5); // cannot compile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int i = (int)list.get(0); // cannot compile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int hash = 3.hashCode(); // cannot compile</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>上面这行代码有三处会编译不通过。ArrayList是个用于保存Object类型对象的容器，可以存放任何类型的对象。不过由于int类型的数值5不是对象，因此它无法被添加到ArrayList中。同样，在通过get方法获取到一个Object类型的对象后，我们也无法将其转换成int类型。自然，int类型没有成员，因此我们也无法通过它调用定义在Object类型上的hashCode方法。</p><p>直至Java 1.4，开发人员都必须编写这样的代码：</p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx java"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ArrayList list = new ArrayList();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">list.add(Integer.valueOf(5));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int i = ((Integer)list.get(0)).intValue();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int hash = Integer.valueOf(3).hashCode();</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>在Java类库中也为每个基础类型分别指定了封装类（wrapper class），当遇到一些需要和Object进行互操作的时候，便可以把基础类型包装为一个对象。这些对象继承于Object类型，自然能够被添加到ArrayList中，也拥有hashCode等定义在基类中的方法。只是，在获取到Object对象并转换成封装对象时，还需要调用对象上的某个方法（如上面的intValue方法）才能重新获取到基础类型。</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="c中的值类型">C#中的值类型<a class="hash-link" href="#c中的值类型" title="Direct link to heading">​</a></h2><p>在此期间微软发布了.NET平台和C#语言。在C#语言中并没有所谓的“基础类型”，或者说C#的“基础类型”是作为.NET中的struct类型统一对待的。在.NET框架中定义了一系列struct类型，如Int32，Boolean，Double等等，在C#语言中使用关键字int，bool，double与之对应，这便有了一些“基础类型”的意味。自然，在C#代码中我们也可以直接使用那些类型的名称，完全等价。</p><p>开发人员可以在程序中定义自己的struct类型，并包含构造函数，方法或是属性等等，并统一继承于ValueType类型（值类型），而ValueType也是统一基类Object的子类。因此，在C#中那些“基础类型”也拥有Object类及自己的成员，并可以直接应用在需要Object的地方（即隐式转换）。因此，在C#中我们可以直接编写这样的代码：</p><div class="codeBlockContainer_I0IT language-csharp theme-code-block"><div class="codeBlockContent_wNvx csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ArrayList list = new ArrayList();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">list.Add(5);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int i = (int)list[0];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int hash = 3.GetHashCode();</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>相信看了这几行代码您就能明白了。可以看出，在C#中，值类型和普通的类（也被称为引用类型）在使用上并没有任何区别。</p><p>当然，既然被称为“值类型”，它自然和普通的引用类型有所区别。首先，在.NET中值类型在赋值时是“整体拷贝”而引用类型只是复制一个引用。更重要的是，值类型是分配在方法的调用栈上，而引用类型则是分配在托管堆上。这意味着前者在当前方法退出后会被自动释放，而后者则必须等待GC运行时将无用的对象消除。</p><p>换句话说，值类型不会对GC造成压力（除非进行了装箱），这点很重要。在某些场景中，例如在并行计算时，假如每个线程临时对象创建地过于频繁，则可能导致GC频率加大。而GC在启动时会暂停运行中的所有线程，因此并行计算最终的瓶颈可能就落在了单线程的GC上——此时您投入再多的CPU等运算资源也无济于事。解决这个问题一般有两种办法，首先是启用并行GC，则为每个CPU分配一个独立的托管堆。在执行时，对象会分配在当前CPU的托管堆上，每个托管堆也有一个线程负责GC操作，这样GC能力也会随着计算能力加大而提高，因此不会成为性能瓶颈。另一种，有时候也可能是更为合适的做法，便是将创建的临时对象设定为值类型，这样一切便是在调用栈上的读写操作，便不会对GC造成压力。</p><p>在.NET平台中，一旦将一个值类型的对象用作引用类型时（即转化为Object类型或接口），运行时便会对它进行“装箱”：此时运行时会在堆上创建一个对象，并将值类型的内容复制到对象内部。将一个装箱后的对象转化为值类型时，则会将托管堆上的对象内容复制到方法的调用栈上，这便是所谓的“拆箱”。装箱和拆箱在.NET中是由运行时负责的，不需要特定的封装类，支持任意值类型。</p><p>在Java中，开发人员无法自定义值类型，因此所有的对象都是分配在托管堆上。不过这些倒也是和平台密切相关的内容，这里便只作一提吧，毕竟我们的目标主要还是在语言方面。</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="java-15中的自动装箱拆箱">Java 1.5中的自动装箱/拆箱<a class="hash-link" href="#java-15中的自动装箱拆箱" title="Direct link to heading">​</a></h2><p>Java语言基础类型和封装类型之间的这种转化方式，从1995年Java语言出现开始，一直保持到2004年Java 1.5出现才有所改变，将近十年时间。那么，Java语言究竟是因为缺少竞争对手而不思进取，还是因为没有比较就体会不到麻烦呢？无论怎样，我相信C#在这方面对Java语言产生的影响是毋庸置疑的。</p><p>不管怎么样，在Java 1.5中引入了一个新特性：自动装箱/拆箱（auto boxing/unboxing）。此时，我们便可以编写这样的代码了：</p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx java"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ArrayList list = new ArrayList();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">list.add(5); // auto boxing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int i = (Integer)list.get(0); // auto unboxing</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>在int值5用在Object参数的时候，Java语言的编译器将自动生成创建Integer对象的bytecode。同样，将Integer类型的对象赋值给基础类型int的时候，Java语言的编译器也会自动生成intValue等方法的调用。那么，它和C#中的装箱和拆箱有什么不同呢？自然，区别之一在于C#的装箱和拆箱是.NET平台已有的功能，C#编译器只要直接使用即可，而Java的自动装箱和拆箱完全是编译器的工作。但我倒认为，这个区别并不是我这里特别关注的。</p><p>毕竟我现在关注的是语言，也就是通过代码本身所表现出来的，尤其是可以体现出两种语言在设计理念上有所不同的区别。</p><p>如果我们仔细观察代码的话，就可以发现，Java编译器其实是将Integer对象与int值互转，例如在上面的第3行代码中，我们先将Object对象转化成Integer类型，然后再隐式地转化至int基本类型。而在C#中，int类型是直接和Object类型相互转化的。我认为，Java的这种做法，表示Java的设计者依然不希望开发人员将int等基本类型看作是一种对象，他们只是让编译器可以帮助开发人员少些一些代码而已。换句话说，Java的设计者认为，int可以看作是Integer对象，boolean是Boolean对象，但是int和boolean仍然是基础类型，而不是对象。</p><p>下面的这行代码可能更加能够直接说明这个问题：</p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx java"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">int hash = 3.hashCode(); // cannot compile</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>在Java中，这行代码是无法编译通过的，因为Java编译器并不会将int自动视作Integer对象，基础类型在这里依然是基础类型，不是对象。</p><p>在之前的讨论过程中，有朋友说，Java在这里不做自动装箱，是因为要在bytecode层面上保持与之前兼容。我不同意这个说法，因为我想象不到实现如C#这样的自动装箱和拆箱会破坏bytecode的兼容性，Java编译器完全也可以在语言级别将int类型和Integer类型等同起来，所以在这方面我认为完全是语言设计理念上的区别。</p><p>说实话，我不喜欢Java的思路，我更认同C#这种更为“面向对象”的设计方式。</p><div>本文为 <a href="https://www.zhihu.com/people/jeffz" target="_blank">赵劼</a> 发表在 <a href="http://blog.zhaojie.me" target="_blank">个人博客</a> 的系列文章之一。</div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/alanwei43/blog/tree/master/src/docs/articles/why-java-sucks-and-csharp-rocks/2-basic-type-and-oop.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/articles/why-java-sucks-and-csharp-rocks/compare-purpose"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">比较的意义与目的</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/articles/why-java-sucks-and-csharp-rocks/attribute-and-annotation"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Attribute与Annotation</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#java语言简单描述" class="table-of-contents__link toc-highlight">Java语言简单描述</a></li><li><a href="#c语言简单描述" class="table-of-contents__link toc-highlight">C#语言简单描述</a></li><li><a href="#java是个纯面向对象语言吗" class="table-of-contents__link toc-highlight">Java是个纯面向对象语言吗？</a></li><li><a href="#c中的值类型" class="table-of-contents__link toc-highlight">C#中的值类型</a></li><li><a href="#java-15中的自动装箱拆箱" class="table-of-contents__link toc-highlight">Java 1.5中的自动装箱/拆箱</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">文章列表</h4><ul class="footer__items"><li class="footer__item"> <a class="footer__link-item" href="/docs/articles/es6-in-depth/introduction">深入浅出ES6 - InfoQ.cn</a> </li><li class="footer__item"> <a class="footer__link-item" href="/docs/articles/why-java-sucks-and-csharp-rocks/compare-purpose">Why Java Sucks and C# Rocks - 赵劼</a> </li><li class="footer__item"> <a class="footer__link-item" href="/docs/reading">阅读笔记</a> </li><li class="footer__item"> <a class="footer__link-item" href="/docs/archives/git-guides">博文归档</a> </li></ul></div><div class="col footer__col"><h4 class="footer__title">文档翻译</h4><ul class="footer__items"><li class="footer__item"> <a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="/docs/articles/why-java-sucks-and-csharp-rocks/docs/guides/blog">Docusaurus Blog</a> </li><li class="footer__item"> <a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="/docs/articles/why-java-sucks-and-csharp-rocks/docs/guides/docs/markdown-features">Docusaurus Markdown</a> </li></ul></div><div class="col footer__col"><h4 class="footer__title">更多</h4><ul class="footer__items"><li class="footer__item"> <a href="https://github.com/alanwei43/node-io-lib" target="_blank" rel="noopener noreferrer" class="footer__link-item">node-io-lib - GitHub</a> </li><li class="footer__item"> <a href="https://github.com/alanwei43/docker-puppeteer" target="_blank" rel="noopener noreferrer" class="footer__link-item">docker-puppeteer - GitHub</a> </li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Alan&#x27;s Blog<!-- --> <a href="https://beian.miit.gov.cn/" target="_blank" rel="noopener noreferrer"> </a></div></div></div></footer></div>
<script src="/assets/js/runtime~main.f0cbfc16.js"></script>
<script src="/assets/js/main.e36c032d.js"></script>
</body>
</html>