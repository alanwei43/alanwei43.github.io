<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Alan's Blog Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Alan's Blog Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WSJXZXE31N"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-WSJXZXE31N",{anonymize_ip:!0})</script>
<script src="/resources/scripts/baidu.js"></script><title data-react-helmet="true">Work Queues  -  Alan&#x27;s Blog</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Work Queues  -  Alan&#x27;s Blog"><meta data-react-helmet="true" name="description" content="è‹±æ–‡åŸæ–‡"><meta data-react-helmet="true" property="og:description" content="è‹±æ–‡åŸæ–‡"><meta data-react-helmet="true" name="keywords" content="rabbitmq"><meta data-react-helmet="true" property="og:url" content="https://blog.alanwei.com/docs/articles/rabbitmq-guide/2-WorkQueues"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://blog.alanwei.com/docs/articles/rabbitmq-guide/2-WorkQueues"><link rel="stylesheet" href="/styles.354d37b6.css">
<link rel="preload" href="/styles.662c80e0.js" as="script">
<link rel="preload" href="/runtime~main.83bebc2c.js" as="script">
<link rel="preload" href="/main.da5f51c0.js" as="script">
<link rel="preload" href="/1.e5cdeb53.js" as="script">
<link rel="preload" href="/2.37ac7cec.js" as="script">
<link rel="preload" href="/3.338728b3.js" as="script">
<link rel="preload" href="/1be78505.3001f991.js" as="script">
<link rel="preload" href="/309.74df1db2.js" as="script">
<link rel="preload" href="/935f2afb.7bea3a99.js" as="script">
<link rel="preload" href="/17896441.85b2881d.js" as="script">
<link rel="preload" href="/6c627f36.79d70a53.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top navbarHideable_17Wu navbarHidden_19ww"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.png" alt="logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Alan&#x27;s Blog</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">æ–‡æ¡£</a><a class="navbar__item navbar__link" href="/blog">åšå®¢</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/alanwei43" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ğŸŒ</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.png" alt="logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Alan&#x27;s Blog</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">æ–‡æ¡£</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">åšå®¢</a></li><li class="menu__list-item"><a href="https://github.com/alanwei43" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy sidebarWithHideableNavbar_CROi"><a tabindex="-1" class="sidebarLogo_xFc8" href="/"><img src="/img/logo.png" alt="logo" class="themedImage_YANc themedImage--light_3CMI"><img src="/img/logo.png" alt="logo" class="themedImage_YANc themedImage--dark_3ARp"><strong>Alan&#x27;s Blog</strong></a><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/">æˆ‘çš„æ–‡æ¡£åˆ—è¡¨</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">ç³»åˆ—æ–‡ç« </a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/articles">README.md</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">æ·±å…¥æµ…å‡ºES6</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/es6-in-depth/0-introduction">ES6æ˜¯ä»€ä¹ˆ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/es6-in-depth/1-iterators-and-the-for-of-loop">è¿­ä»£å™¨å’Œ for-of å¾ªç¯</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/es6-in-depth/2-generators">ç”Ÿæˆå™¨ Generators</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/es6-in-depth/3-template-string">æ¨¡æ¿å­—ç¬¦ä¸²</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/es6-in-depth/4-rest-parameters-and-defaults">ä¸å®šå‚æ•°å’Œé»˜è®¤å‚æ•°</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/es6-in-depth/5-destructuring">è§£æ„ Destructuring</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/es6-in-depth/6-arrow-functions">ç®­å¤´å‡½æ•° Arrow Functions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/es6-in-depth/7-symbols">Symbols</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/es6-in-depth/8-babel-and-broccoli">å­¦ä¹  Babel å’Œ Broccoliï¼Œé©¬ä¸Šå°±ç”¨ ES6</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/es6-in-depth/9-collections">é›†åˆ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/es6-in-depth/10-generators-continued">ç”Ÿæˆå™¨ Generatorsï¼Œç»­ç¯‡</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/es6-in-depth/11-proxies-and-reflect">ä»£ç† Proxies</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/es6-in-depth/12-classes">ç±» Class</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/es6-in-depth/13-let-and-const">let å’Œ const</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/es6-in-depth/14-subclassing">å­ç±» Subclassing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/es6-in-depth/15-modules">æ¨¡å— Modules</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/es6-in-depth/16-the-future">å±•æœ›æœªæ¥</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Why Java Sucks and C# Rocks</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/why-java-sucks-and-csharp-rocks/1-compare-purpose">æ¯”è¾ƒçš„æ„ä¹‰ä¸ç›®çš„</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/why-java-sucks-and-csharp-rocks/2-basic-type-and-oop">åŸºç¡€ç±»å‹ä¸é¢å‘å¯¹è±¡</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/why-java-sucks-and-csharp-rocks/3-attribute-and-annotation">Attributeä¸Annotation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/why-java-sucks-and-csharp-rocks/4-1-reddit-and-property">Redditï¼Œå…¼è°ˆC#å±æ€§</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/why-java-sucks-and-csharp-rocks/4-generics">æ³›å‹</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/why-java-sucks-and-csharp-rocks/5-1-standard-event-model">æ ‡å‡†äº‹ä»¶æ¨¡å‹</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/why-java-sucks-and-csharp-rocks/5-anonymous-method">åŒ¿åæ–¹æ³•</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/why-java-sucks-and-csharp-rocks/6-yield">yieldåŠå…¶ä½œç”¨</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">RabbitMQ Guide</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/articles/rabbitmq-guide/0-install">å®‰è£…</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/articles/rabbitmq-guide/1-hello-world">Hello World</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/articles/rabbitmq-guide/2-WorkQueues">Work Queues</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/articles/rabbitmq-guide/3-Publish-Subscribe">Publish/Subscribe</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/articles/rabbitmq-guide/4-Routing">Routing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/articles/rabbitmq-guide/5-Topic">Topics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/articles/rabbitmq-guide/6-RPC">Remote procedure call (RPC)</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">OkHttp Guide</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/okhttp-guide/1-overview">æ¦‚è¿°</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/okhttp-guide/2-calls">è°ƒç”¨</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/okhttp-guide/3-caching">ç¼“å­˜</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/okhttp-guide/4-connections">è¿æ¥</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/okhttp-guide/5-events">äº‹ä»¶</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/articles/okhttp-guide/6-https">HTTPS</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">é˜…è¯»ç¬”è®°</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reading">README.md</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reading/bulletproff-ssl-and-tls-understanding-and-deploying-ssl-tls-and-pki-to-secure-servers-and-web-applications">HTTPS æƒå¨æŒ‡å— åœ¨æœåŠ¡å™¨å’ŒWebåº”ç”¨ä¸Šéƒ¨ç½²SSL/TLSå’ŒPKI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reading/core-java-for-the-impatient">Core Java for the Impatient</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reading/mastering-spring-5">Mastering Spring 5.0</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reading/practical-vim">Vimå®ç”¨æŠ€å·§</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reading/spring-in-action">Spring in Action</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reading/understanding-ecmascript-6">Understanding ECMAScript 6</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reading/using-docker">Dockerå¼€å‘æŒ‡å—</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reading/you-dont-know-js-2">ä½ ä¸çŸ¥é“çš„JS(ä¸­)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reading/you-dont-konw-js-1">ä½ ä¸çŸ¥é“çš„JS(ä¸Š)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reading/zh.javascript.info">ç°ä»£ JavaScript æ•™ç¨‹</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Docusaurus æ–‡æ¡£ç¿»è¯‘</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/guides/intro">ç®€ä»‹</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/guides/blog">åšå®¢</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/guides/typescript-support">TypeScriptæ”¯æŒ</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">æ–‡æ¡£</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/guides/docs/markdown-features">Markdown ç‰¹æ€§</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">API</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/guides/api/client">Client API</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">åšæ–‡æ•´ç†</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/archives">README.md</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/archives/bookmarks">ä¹¦ç­¾</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/archives/docker">Docker</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/archives/editor">ç¼–è¾‘å™¨</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/archives/git-guides">Git</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/archives/literature">è¯—å’Œè¿œæ–¹</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/archives/mirrors">é•œåƒåˆ—è¡¨</a></li></ul></li></ul></div><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_2WRA"><svg width="20" height="20" role="img" class="collapseSidebarButtonIcon_CoMu"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Work Queues</h1></header><div class="markdown"><p><a href="http://www.rabbitmq.com/tutorials/tutorial-two-dotnet.html" target="_blank" rel="noopener noreferrer">è‹±æ–‡åŸæ–‡</a></p><p>åœ¨<a href="https://github.com/Allen-Wei/GitBlog/blob/master/RabbitMQ/RabbitMQ-Tutorials-1-HelloWorld.md" target="_blank" rel="noopener noreferrer">ç¬¬ä¸€ç¯‡æ•™ç¨‹</a>é‡Œï¼Œæˆ‘ä»¬å†™äº†ä»å·²å‘½åé˜Ÿåˆ—å‘é€å’Œæ¥æ”¶æ¶ˆæ¯çš„ç¨‹åºã€‚åœ¨è¿™ç¯‡æ•™ç¨‹é‡Œï¼Œæˆ‘ä»¬å°†åˆ›å»ºå·¥ä½œé˜Ÿåˆ—åœ¨å¤šä¸ªå·¥ä½œè€…ä¸Šåˆ†å‘è€—æ—¶ä»»åŠ¡ã€‚</p><p>å·¥ä½œé˜Ÿåˆ—ï¼ˆä¹Ÿç§°ä»»åŠ¡é˜Ÿåˆ—ï¼‰çš„ä¸»è¦ç›®çš„æ˜¯é¿å…ç«‹å³æ‰§è¡Œèµ„æºå¯†é›†å‹ä»»åŠ¡è€Œä¸”å¿…é¡»ç­‰å¾…å®Œæˆã€‚ç›¸åæˆ‘ä»¬æ¨è¿Ÿä»»åŠ¡æ‰§è¡Œã€‚æˆ‘ä»¬æŠŠä¸€ä¸ªä»»åŠ¡å°è£…æˆæ¶ˆæ¯ï¼Œå‘é€åˆ°ä¸€ä¸ªé˜Ÿåˆ—ã€‚ä¸€ä¸ªå·¥ä½œè€…è¿›ç¨‹åœ¨åå°å®Œæˆä»»åŠ¡ã€‚å½“ä½ è¿è¡Œå¤šä¸ªå·¥ä½œè€…è¿›ç¨‹æ—¶ï¼Œä»»åŠ¡ä¼šè¢«åœ¨ä»–ä»¬ä¹‹é—´å…±äº«ã€‚</p><p>ä¸Šé¢æè¿°çš„æ¦‚å¿µï¼Œåœ¨çŸ­æš‚çš„HTTPè¯·æ±‚æœŸé—´å¯èƒ½è¦å¤„ç†å¤æ‚ä»»åŠ¡çš„Webç¨‹åºé‡Œå°¤å…¶æœ‰ç”¨ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="preparation"></a>Preparation<a class="hash-link" href="#preparation" title="Direct link to heading">#</a></h2><p>åœ¨è¿™ä¸ªæ•™ç¨‹çš„ä¸Šä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å‘é€äº†åŒ…å«â€œhello worldâ€çš„æ¶ˆæ¯ã€‚ç°åœ¨æˆ‘ä»¬å°†è¦å‘é€ä»£è¡¨å¤æ‚ä»»åŠ¡çš„å­—ç¬¦ä¸²ã€‚ æˆ‘ä»¬æ²¡æœ‰çœŸå®ç¯å¢ƒçš„ä»»åŠ¡ï¼Œæ¯”å¦‚å›¾ç‰‡å°ºå¯¸å¤„ç†æˆ–è€…pdfæ–‡ä»¶æ¸²æŸ“ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨Thread.Sleepæ¥æ¨¡æ‹Ÿæˆ‘ä»¬å¾ˆå¿™çš„æ„å›¾ã€‚æˆ‘ä»¬ç”¨å­—ç¬¦ä¸²ä¸­çš„ç‚¹è¡¨ç¤ºå¤æ‚åº¦ï¼Œæ¯ä¸€ä¸ªç‚¹ä»£è¡¨ä¸€ç§’çš„å·¥ä½œé‡ã€‚æ¯”å¦‚æˆ‘ä»¬ä½¿ç”¨ <code>Hello...</code> æ¨¡æ‹Ÿä»»åŠ¡ï¼Œå°±ä»£è¡¨ä¸‰ç§’é’Ÿçš„ä»»åŠ¡ã€‚</p><p>æˆ‘ä»¬ä»æˆ‘ä»¬ä¹‹å‰çš„ä¾‹å­é‡Œç¨å¾®ä¿®æ”¹ä¸€ä¸‹Send.csä»£ç ï¼Œå…è®¸ä»å‘½ä»¤è¡Œå‘é€ä»»æ„æ¶ˆæ¯ã€‚è¿™ä¸ªç¨‹åºå°†ä¼šè®¡åˆ’ä»»åŠ¡åˆ°æˆ‘ä»¬çš„é˜Ÿåˆ—é‡Œï¼Œæ‰€ä»¥è®©æˆ‘ä»¬æŠŠå®ƒå‘½åä¸º <code>NewTsk.cs</code>:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">var message = GetMessage(args);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">var body = Encoding.UTF8.GetBytes(message);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">var properties = channel.CreateBasicProperties();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">properties.SetPersistent(true);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">channel.BasicPublish(exchange: &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                     routingKey: &quot;task_queue&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                     basicProperties: properties,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                     body: body);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>ä¸€ä¸ªä»å‘½ä»¤è¡Œå‚æ•°è·å–ä¿¡æ¯çš„å®ç”¨æ–¹æ³•:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">private static string GetMessage(string[] args)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return ((args.Length &gt; 0) ? string.Join(&quot; &quot;, args) : &quot;Hello World!&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>æˆ‘ä»¬çš„ <em>Receive.cs</em> ä¹Ÿéœ€è¦åšä¸€äº›ä¿®æ”¹ï¼šå®ƒéœ€è¦ä¸ºæ¶ˆæ¯å†…å®¹é‡Œçš„æ¯ä¸ªç‚¹æ¨¡æ‹Ÿä¸€ç§’é’Ÿçš„å·¥ä½œé‡ã€‚å®ƒä¼šå¤„ç†ç»ç”±RabbitMQé€’é€çš„æ¶ˆæ¯å’Œæ‰§è¡Œä»»åŠ¡ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬å«åš <code>Worker.cs</code> :</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">var consumer = new EventingBasicConsumer(channel);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">consumer.Received += (model, ea) =&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    var body = ea.Body;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    var message = Encoding.UTF8.GetString(body);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Console.WriteLine(&quot; [x] Received {0}&quot;, message);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    int dots = message.Split(&#x27;.&#x27;).Length - 1;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Thread.Sleep(dots * 1000);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Console.WriteLine(&quot; [x] Done&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    channel.BasicAck(deliveryTag: ea.DeliveryTag, multiple: false);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">};</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">channel.BasicConsume(queue: &quot;task_queue&quot;, noAck: false, consumer: consumer);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>æˆ‘ä»¬çš„ä¼ªè£…ä»»åŠ¡ä½¿ç”¨ä»¥ä¸‹ä»£ç æ¨¡æ‹Ÿæ‰§è¡Œæ—¶é—´ï¼š</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">int dots = message.Split(&#x27;.&#x27;).Length - 1;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Thread.Sleep(dots * 1000);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>åƒæ•™ç¨‹ä¸€é‚£æ ·ç¼–è¯‘å®ƒä»¬ï¼š</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ csc /r:&quot;RabbitMQ.Client.dll&quot; NewTask.cs</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ csc /r:&quot;RabbitMQ.Client.dll&quot; Worker.cs</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="round-robin-dispatching"></a>Round-robin dispatching<a class="hash-link" href="#round-robin-dispatching" title="Direct link to heading">#</a></h2><p>ä½¿ç”¨ä»»åŠ¡é˜Ÿåˆ—çš„å…¶ä¸­ä¸€ä¸ªä¼˜ç‚¹å°±æ˜¯å¾ˆå®¹æ˜“å°±èƒ½è¿›è¡Œå¹¶è¡Œä»»åŠ¡ã€‚å¦‚æœæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªåå°æ—¥å¿—ï¼Œæˆ‘ä»¬åªéœ€è¦æ·»åŠ æ›´å¤šçš„å·¥ä½œè€…è¿›ç¨‹ï¼Œæå…¶å®¹æ˜“ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬è¯•ç€åœ¨ç›¸åŒçš„æ—¶é—´è¿è¡Œä¸¤ä¸ª<code>Worker.cs</code>è„šæœ¬ï¼Œå®ƒä»¬ä¸¤ä¸ªéƒ½ä¼šä»é˜Ÿåˆ—ä¸­è·å–æ¶ˆæ¯ï¼Œä½†æ˜¯ç¡®åˆ‡æ˜¯æ€æ ·çš„å‘¢ï¼Ÿè®©æˆ‘ä»¬çœ‹çœ‹ï¼š</p><p>ä½ éœ€è¦æ‰“å¼€ä¸‰ä¸ªæ§åˆ¶å°ï¼Œä¸¤ä¸ªè¿è¡Œ<code>Worker.cs</code>è„šæœ¬ï¼Œè¿™ä¸¤ä¸ªå°±æ˜¯æˆ‘ä»¬çš„ä¸¤ä¸ªæ¶ˆè´¹è€… C1å’ŒC2.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">shell1$ Worker.exe</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Worker</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> [*] Waiting for messages. To exit press CTRL+C</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">shell2$ Worker.exe</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Worker</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> [*] Waiting for messages. To exit press CTRL+C</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>åœ¨ç¬¬ä¸‰ä¸ªæ§åˆ¶å° æˆ‘ä»¬å‘å¸ƒæ¶ˆæ¯ã€‚ä¸€æ—¦ä½ å¼€å§‹äº†æ¶ˆè´¹è€…è¿›ç¨‹ï¼Œä½ å°±å¯ä»¥å‘å¸ƒæ¶ˆæ¯äº†ï¼š</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">shell3$ NewTask.exe First message.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">shell3$ NewTask.exe Second message..</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">shell3$ NewTask.exe Third message...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">shell3$ NewTask.exe Fourth message....</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">shell3$ NewTask.exe Fifth message.....</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>è®©æˆ‘ä»¬çœ‹çœ‹éƒ½æœ‰ä»€ä¹ˆåˆ°è¾¾äº†æˆ‘ä»¬çš„å·¥ä½œè€…è¿›ç¨‹: </p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">shell1$ Worker.exe</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> [*] Waiting for messages. To exit press CTRL+C</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> [x] Received &#x27;First message.&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> [x] Received &#x27;Third message...&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> [x] Received &#x27;Fifth message.....&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">shell2$ Worker.exe</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> [*] Waiting for messages. To exit press CTRL+C</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> [x] Received &#x27;Second message..&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> [x] Received &#x27;Fourth message....&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>RabbitMQé»˜è®¤ä¼šå‘é€æ¯ä¸€ä¸ªæ¶ˆæ¯ç»™ä¸‹ä¸€ä¸ªé˜Ÿåˆ—ä¸­çš„æ¶ˆè´¹è€…ã€‚å¹³å‡æ¯ä¸ªæ¶ˆè´¹è€…éƒ½èƒ½è·å–ç›¸åŒæ•°é‡çš„æ¶ˆæ¯ã€‚è¿™ç§åˆ†å‘æ¶ˆæ¯çš„æ–¹å¼å«round-robin. å°è¯•ä¸‰ä¸ªæˆ–æ›´å¤šçš„å·¥ä½œè€…è¿›ç¨‹ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="message-acknowledgment"></a>Message acknowledgment<a class="hash-link" href="#message-acknowledgment" title="Direct link to heading">#</a></h2><p>å®Œæˆä¸€ä¸ªä»»åŠ¡åªéœ€æ•°ç§’ã€‚ä½ ä¹Ÿè®¸æƒ³çŸ¥é“å¦‚æœå…¶ä¸­ä¸€ä¸ªæ¶ˆè´¹è€…è¿›ç¨‹å¼€å§‹ä¸€ä¸ªè€—æ—¶ä»»åŠ¡ï¼Œåœ¨ä»…éƒ¨åˆ†å®Œæˆçš„æ—¶å€™æ­»å»äº†ä¼šå‘ç”Ÿä»€ä¹ˆã€‚å¯¹äºæˆ‘ä»¬å½“å‰çš„ä»£ç ï¼Œä¸€æ—¦RabbitMQå°†æ¶ˆæ¯é€’é€åˆ°æ¶ˆè´¹è€…ï¼Œå°±ä¼šç«‹å³å°†æ¶ˆæ¯ä»å†…å­˜ä¸­ç§»é™¤ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœä½ æ€æ­»ä¸€ä¸ªå·¥ä½œè€…è¿›ç¨‹ï¼Œä½ å°±ä¼šä¸¢å¤±é‚£æ¡æ¶ˆæ¯ã€‚æˆ‘ä»¬ä¹Ÿä¼šä¸¢å¤±æ‰€æœ‰åˆ†å‘åˆ°è¿™ä¸ªå·¥ä½œè€…è¿›ç¨‹ä½†å°šæœªå¤„ç†çš„æ¶ˆæ¯ã€‚</p><p>ä¸è¿‡æˆ‘ä»¬ä¸æƒ³ä¸¢å¤±ä»»ä½•ä»»åŠ¡ã€‚å¦‚æœä¸€ä¸ªå·¥ä½œè€…è¿›ç¨‹æ­»å»ï¼Œæˆ‘ä»¬å¸Œæœ›è¿™ä¸ªä»»åŠ¡è¢«é€’é€åˆ°å…¶ä»–å·¥ä½œè€…è¿›ç¨‹ã€‚</p><p>ä¸ºäº†ä¿è¯æ¶ˆæ¯ä¸ä¼šä¸¢å¤±ï¼ŒRabbitMQæ”¯æŒæ¶ˆæ¯ç¡®è®¤ã€‚æ¶ˆè´¹è€…å‘é€å›ä¸€ä¸ªæ¶ˆæ¯ç¡®è®¤ï¼Œå‘Šè¯‰RabbitMQæŒ‡å®šçš„æ¶ˆæ¯è¢«æ¥æ”¶ï¼Œå¤„ç†ï¼ŒRabbitMQå¯ä»¥è‡ªç”±åˆ é™¤é‚£æ¡æ¶ˆæ¯äº†ã€‚</p><p>å¦‚æœä¸€ä¸ªæ¶ˆè´¹è€…æ²¡æœ‰å‘é€æ¶ˆæ¯ç¡®è®¤å°±æ­»å»ï¼ˆæ¯”å¦‚ä¿¡é“è¢«å…³é—­ï¼Œè¿æ¥è¢«å…³é—­ï¼Œæˆ–è€…TCPè¿æ¥ä¸¢å¤±ï¼‰ï¼ŒRabbitMQä¾¿çŸ¥é“æ¶ˆæ¯æ²¡æœ‰è¢«å®Œå…¨å¤„ç†ï¼Œç„¶åä¼šé‡æ–°åŠ å…¥é˜Ÿåˆ—ã€‚æ­¤æ—¶ï¼Œå¦‚æœæœ‰å…¶ä»–çš„æ¶ˆè´¹è€…åœ¨çº¿ï¼ŒRabbitMQå¾ˆå¿«é‡æ–°é€’é€æ¶ˆæ¯ç»™å…¶ä»–æ¶ˆè´¹è€…äº†ã€‚è¿™æ ·ä½ å°±å¯ä»¥ç¡®ä¿æ²¡æœ‰æ¶ˆæ¯ä¼šä¸¢å¤±ï¼Œç”šè‡³å·¥ä½œè€…è¿›ç¨‹å¶å°”ä¼šæ­»å»ã€‚</p><p>æ²¡æœ‰æ¶ˆæ¯ä¼šè¶…æ—¶ã€‚å½“æ¶ˆè´¹è€…æ­»å»çš„æ—¶å€™ï¼ŒRabbitMQä¼šé‡æ–°é€’é€æ¶ˆæ¯ã€‚è¿™æ˜¯éå¸¸å¥½çš„è®¾è®¡ï¼Œå³ä¾¿æ¶ˆæ¯å¤„ç†èŠ±è´¹äº†å¾ˆé•¿å¾ˆé•¿çš„æ—¶é—´ã€‚</p><p>æ¶ˆæ¯ç¡®è®¤é»˜è®¤æ˜¯å¼€å¯çš„ã€‚åœ¨ä¸Šä¸€ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡è®¾ç½®å‚æ•°noAck(éæ‰‹åŠ¨ç¡®è®¤)çš„å€¼ä¸ºtrueæ˜¾å¼åœ°å…³é—­äº†æ¶ˆæ¯ç¡®è®¤åŠŸèƒ½ã€‚ä¸€æ—¦æˆ‘ä»¬å®Œæˆä»»åŠ¡ï¼Œéœ€è¦ç§»é™¤è¿™ä¸ªæ ‡ç¤ºï¼Œä»å·¥ä½œè€…è¿›ç¨‹å‘é€ä¸€ä¸ªæ°å½“çš„ç¡®è®¤ã€‚</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">var consumer = new EventingBasicConsumer(channel);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">consumer.Received += (model, ea) =&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    var body = ea.Body;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    var message = Encoding.UTF8.GetString(body);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Console.WriteLine(&quot; [x] Received {0}&quot;, message);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    int dots = message.Split(&#x27;.&#x27;).Length - 1;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Thread.Sleep(dots * 1000);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Console.WriteLine(&quot; [x] Done&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    channel.BasicAck(deliveryTag: ea.DeliveryTag, multiple: false);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">};</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">channel.BasicConsume(queue: &quot;task_queue&quot;, noAck: false, consumer: consumer);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>ä½¿ç”¨è¿™æ®µä»£ç æˆ‘ä»¬å¯ä»¥ç¡®ä¿å³ä¾¿æˆ‘ä»¬åœ¨å·¥ä½œè€…è¿›ç¨‹å¤„ç†æ¶ˆæ¯çš„æ—¶å€™ä½¿ç”¨Ctrl+Cæ€æ­»äº†å·¥ä½œè€…è¿›ç¨‹ï¼Œä¹Ÿä¸ä¼šæœ‰ä¸œè¥¿ä¸¢å¤±ã€‚åœ¨å·¥ä½œè€…è¿›ç¨‹æ­»å»åï¼Œæ‰€æœ‰æœªç¡®è®¤çš„æ¶ˆæ¯å¾ˆå¿«ä¼šè¢«é‡æ–°æŠ•é€’åˆ†å‘ã€‚</p><p>Note:
å¿˜è®°è°ƒç”¨BasicAckæ˜¯ä¸€ä¸ªå¸¸è§çš„é”™è¯¯ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„é”™è¯¯ï¼Œä½†å¯¹äºå¹¶å‘æ¥è¯´æ˜¯å¾ˆä¸¥é‡çš„é”™è¯¯ã€‚å½“ä½ çš„å®¢æˆ·ç«¯é€€å‡ºæ—¶æ¶ˆæ¯ä¼šè¢«é‡æ–°é€’é€ï¼ˆè¿™çœ‹èµ·æ¥åƒæ˜¯éšæœºé€’é€ï¼‰ï¼Œä½†æ˜¯RabbitMQå°†ä¼šåƒæ‰è¶Šæ¥è¶Šå¤šçš„å†…å­˜ï¼Œå› ä¸ºRanbitMQä¸èƒ½é‡Šæ”¾ä»»ä½•æœªè¢«ç¡®è®¤çš„æ¶ˆæ¯ã€‚</p><p>ä¸ºäº†è°ƒè¯•è¿™ç§ç±»å‹çš„é”™è¯¯ï¼Œä½ å¯ä»¥ä½¿ç”¨RabbitMQctlæ‰“å°messeages_unacknowledgedå­—æ®µï¼š</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ sudo rabbitmqctl list_queues name messages_ready messages_unacknowledged</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Listing queues ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">hello    0       0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">...done.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="message-durability"></a>Message durability<a class="hash-link" href="#message-durability" title="Direct link to heading">#</a></h2><p>æˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•ç¡®ä¿ä»»åŠ¡ä¸ä¼šä¸¢å¤±ï¼Œå³ä¾¿æ¶ˆè´¹è€…è¿›ç¨‹æ­»å»ã€‚ä½†æ˜¯å¦‚æœRabbitMQæœåŠ¡å™¨åœæ­¢æˆ‘ä»¬ä»»åŠ¡ä»ä¼šä¸¢å¤±ã€‚</p><p> å½“RabbitMQ é€€å‡ºæˆ–è€…å´©æºƒæ—¶ä¼šå¿˜è®°é˜Ÿåˆ—å’Œæ¶ˆæ¯ï¼Œé™¤éä½ å‘Šè¯‰RabbitMQ ä¸è¦è¿™æ ·åšã€‚ç¡®ä¿æ¶ˆæ¯ä¸ä¼šä¸¢å¤±éœ€è¦ç¡®ä¿ä¸¤ä»¶äº‹ï¼šæˆ‘ä»¬éœ€è¦è®©æ¶ˆæ¯å’Œé˜Ÿåˆ—æŒä¹…åŒ–ã€‚</p><p> é¦–å…ˆæˆ‘ä»¬è¦ç¡®ä¿RabbitMQ ä¸ä¼šä¸¢å¤±æˆ‘ä»¬çš„é˜Ÿåˆ—ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦è®²é˜Ÿåˆ—å£°æ˜ç§°å¯æŒä¹…åŒ–çš„ï¼š</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">channel.QueueDeclare(queue: &quot;hello&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 durable: true,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 exclusive: false,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 autoDelete: false,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 arguments: null);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>è™½ç„¶è¿™ä¸ªå‘½ä»¤æœ¬èº«æ˜¯æ­£ç¡®çš„ï¼Œä½†æ˜¯åœ¨æˆ‘ä»¬å½“å‰çš„è®¾ç½®é‡Œå®ƒä¸ä¼šå·¥ä½œã€‚é‚£æ˜¯å› ä¸ºæˆ‘ä»¬å·²ç»å®šä¹‰äº†ä¸€ä¸ªæœªæŒä¹…åŒ–çš„åä¸º<code>hello</code>çš„é˜Ÿåˆ—ã€‚</p><p>RabbitMQ ä¸å…è®¸æˆ‘ä»¬ä½¿ç”¨ä¸åŒçš„å‚æ•°é‡å®šä¹‰ä¸€ä¸ªå·²ç»å­˜åœ¨çš„é˜Ÿåˆ—ï¼Œè€Œä¸”å¦‚æœç¨‹åºè¯•ç€è¿™ä¹ˆåšäº†RabbitMQ ä¼šè¿”å›ä¸€ä¸ªé”™è¯¯ã€‚ä½†æ˜¯æœ‰ä¸€ä¸ªä¾¿æ·çš„æ›¿ä»£æ–¹æ¡ˆ å£°æ˜ä¸€ä¸ªä¸åŒåå­—çš„é˜Ÿåˆ—ï¼Œæ¯”å¦‚<code>task_queue</code>:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">channel.QueueDeclare(queue: &quot;task_queue&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 durable: true,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 exclusive: false,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 autoDelete: false,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 arguments: null);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>é˜Ÿåˆ—å£°æ˜çš„æ”¹å˜éœ€è¦åœ¨ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„ä»£ç ä¸­åŒæ—¶åº”ç”¨è¿™ä¸ªæ”¹å˜ã€‚</p><p>æ­¤åˆ»æˆ‘ä»¬å¯ä»¥ç¡®ä¿task_queueé˜Ÿåˆ—ä¸ä¼šä¸¢å¤±å³ä½¿RabbitMQé‡å¯äº†ã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦è®©æˆ‘ä»¬çš„æ¶ˆæ¯æŒä¹…åŒ– â€” é€šè¿‡æŠŠ<code>IBasicProperties.SetPersistent</code>è®¾ç½®æˆ<code>true</code>.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">var properties = channel.CreateBasicProperties();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">properties.SetPersistent(true);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Note:
å…³äºæ¶ˆæ¯æŒä¹…åŒ–</p><p>è®©æ¶ˆæ¯æŒä¹…åŒ–å¹¶ä¸èƒ½ä¿è¯æ¶ˆæ¯ä¸ä¼šä¸¢å¤±ã€‚è™½ç„¶æŒä¹…åŒ–æ¶ˆæ¯ä¼šå‘Šè¯‰RabbitMQæŠŠæ¶ˆæ¯ä¿å­˜åˆ°ç¡¬ç›˜ï¼Œä½†æ˜¯ä¾ç„¶æœ‰RabbitMQæ¥æ”¶æ¶ˆæ¯ä½†æœªèƒ½ä¿å­˜æ¶ˆæ¯çš„çŸ­æ—¶çª—å£æœŸã€‚RabbitMQ ä¹Ÿä¸ä¼šä¸ºæ¯ä¸ªæ¶ˆæ¯æ‰§è¡Œ<code>fsync(2)</code>ï¼Œè¿™å°±ä»…ä»…æ˜¯è¢«ä¿å­˜åˆ°ç¼“å­˜è€Œä¸æ˜¯çœŸæ­£åœ°å†™å…¥åˆ°ç¡¬ç›˜ã€‚è¿™æ ·ç¡®ä¿æŒä¹…åŒ–å¹¶ä¸å¼ºå£®ï¼Œä½†æ˜¯è¿™å¯¹äºæˆ‘ä»¬ç®€å•çš„ä»»åŠ¡é˜Ÿåˆ—æ¥è¯´å·²ç»è¶³å¤Ÿäº†ã€‚å¦‚æœä½ éœ€è¦æ›´å¼ºå£®çš„æ¶ˆæ¯ä¿è¯ï¼Œä½ å¯ä»¥ä½¿ç”¨<strong>å‘å¸ƒè€…ç¡®è®¤</strong>ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="fair-dispatch-å…¬å¹³åˆ†å‘"></a>Fair dispatch å…¬å¹³åˆ†å‘<a class="hash-link" href="#fair-dispatch-å…¬å¹³åˆ†å‘" title="Direct link to heading">#</a></h2><p>ä½ ä¹Ÿè®¸å·²ç»æ³¨æ„åˆ°åˆ†å‘è¿˜ä¸èƒ½åƒä½ æƒ³è¦çš„é‚£æ ·å·¥ä½œã€‚æ¯”å¦‚åœ¨æœ‰ä¸¤è€…å·¥ä½œè€…è¿›ç¨‹çš„æƒ…å†µï¼Œå½“æ‰€æœ‰çš„å¥‡æ•°æ¶ˆæ¯çš„å·¥ä½œé‡å¾ˆå¤§ï¼Œå¶æ•°æ¶ˆæ¯æ˜¯è½»é‡ç®€å•çš„ï¼Œé‚£ä¹ˆä¸€ä¸ªå·¥ä½œè€…è¿›ç¨‹å¸¸å¸¸æ˜¯å¿™ç¢Œçš„ï¼Œè€Œå¦ä¸€ä¸ªå·¥ä½œè€…è¿›ç¨‹å‡ ä¹ä¸ä¼šåšä»»ä½•å·¥ä½œã€‚å—¯ï¼Œå¯¹äºè¿™ç§æƒ…å†µï¼ŒRabbitMQä¸€ç‚¹éƒ½ä¸çŸ¥é“ï¼Œå°†ä¼šä¸€ç›´è¿™æ ·å¹³å‡åœ°åˆ†å‘æ¶ˆæ¯ã€‚</p><p> å¯¼è‡´è¿™æ ·çš„äº‹æƒ…æ˜¯å› ä¸ºå½“æ¶ˆæ¯è¿›å…¥é˜Ÿåˆ—æ—¶ï¼ŒRabbitMQ åªæ˜¯åˆ†å‘æ¶ˆæ¯ã€‚å®ƒä¸ä¼šæ ¹æ®æ¯ä¸ªæ¶ˆè´¹è€…æœªç¡®è®¤æ¶ˆæ¯æ•°é‡æ¥åˆ†å‘æ¶ˆæ¯ï¼Œè€Œæ˜¯ç›²ç›®åœ°å°†ç¬¬Nä¸ªæ¶ˆæ¯å‘é€ç»™ç¬¬Nçš„æ¶ˆè´¹è€…ã€‚</p><p> <img src="http://www.rabbitmq.com/img/tutorials/prefetch-count.png" alt="fair dispatch"></p><p>ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>basicQos</code>æ–¹æ³•æŠŠ<code>prefetchCount</code>è®¾ç½®æˆ<code>1</code>ã€‚è¿™ä¼šå‘Šè¯‰RabbitMQä¸€æ¬¡ä¸è¦ç»™å·¥ä½œè€…è¿›ç¨‹è¶…è¿‡ä¸€æ¡æ¶ˆæ¯ã€‚æˆ–è€…ï¼Œæ¢å¥è¯è¯´ï¼Œç›´åˆ°å·¥ä½œè€…è¿›ç¨‹å¤„ç†å¹¶ç¡®è®¤ä¸Šä¸€æ¡æ¶ˆæ¯ä¹‹å‰ä¸è¦å†ç»™è¿™ä¸ªå·¥ä½œè€…è¿›ç¨‹åˆ†å‘æ–°çš„æ¶ˆæ¯ã€‚ç›¸åï¼ŒRabbitMQä¼šæŠŠæ¶ˆæ¯å‘é€åˆ°ä¸‹ä¸€ä¸ªä¸å¿™ç¢Œçš„å·¥ä½œè€…è¿›ç¨‹ã€‚</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">channel.BasicQos(0, 1, false);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><blockquote><p>å…³äºé˜Ÿåˆ—å¤§å°
å¦‚æœæ‰€æœ‰çš„å·¥ä½œè€…è¿›ç¨‹éƒ½å¿™ç¢Œï¼Œä½ çš„é˜Ÿåˆ—å¯èƒ½ä¼šå¡æ»¡æ¶ˆæ¯ã€‚ä½ å¯èƒ½éœ€è¦ç›‘è§†å µå¡ï¼Œç„¶åå¯èƒ½éœ€è¦æ·»åŠ æ›´å¤šçš„å·¥ä½œè€…è¿›ç¨‹ï¼Œæˆ–è€…ä½¿ç”¨ä¸€äº›å…¶ä»–çš„ç­–ç•¥ã€‚</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="putting-it-all-together"></a>Putting it all together<a class="hash-link" href="#putting-it-all-together" title="Direct link to heading">#</a></h2><p><code>NewTask.cs</code>ç±»æœ€ç»ˆä»£ç :</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">using System;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">using RabbitMQ.Client;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">using System.Text;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class NewTask</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public static void Main(string[] args)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        var factory = new ConnectionFactory() { HostName = &quot;localhost&quot; };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        using(var connection = factory.CreateConnection())</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        using(var channel = connection.CreateModel())</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            channel.QueueDeclare(queue: &quot;task_queue&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                 durable: true,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                 exclusive: false,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                 autoDelete: false,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                 arguments: null);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            var message = GetMessage(args);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            var body = Encoding.UTF8.GetBytes(message);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            var properties = channel.CreateBasicProperties();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            properties.SetPersistent(true);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            channel.BasicPublish(exchange: &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                 routingKey: &quot;task_queue&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                 basicProperties: properties,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                 body: body);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            Console.WriteLine(&quot; [x] Sent {0}&quot;, message);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        Console.WriteLine(&quot; Press [enter] to exit.&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        Console.ReadLine();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    private static string GetMessage(string[] args)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return ((args.Length &gt; 0) ? string.Join(&quot; &quot;, args) : &quot;Hello World!&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><a href="http://github.com/rabbitmq/rabbitmq-tutorials/blob/master/dotnet/NewTask.cs" target="_blank" rel="noopener noreferrer">NewTask.cs soruce</a></p><p><code>Worker.cs</code> ä»£ç :</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">using System;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">using RabbitMQ.Client;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">using RabbitMQ.Client.Events;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">using System.Text;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">using System.Threading;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class Worker</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public static void Main()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        var factory = new ConnectionFactory() { HostName = &quot;localhost&quot; };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        using(var connection = factory.CreateConnection())</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        using(var channel = connection.CreateModel())</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            channel.QueueDeclare(queue: &quot;task_queue&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                 durable: true,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                 exclusive: false,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                 autoDelete: false,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                 arguments: null);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            channel.BasicQos(prefetchSize: 0, prefetchCount: 1, global: false);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            Console.WriteLine(&quot; [*] Waiting for messages.&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            var consumer = new EventingBasicConsumer(channel);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            consumer.Received += (model, ea) =&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                var body = ea.Body;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                var message = Encoding.UTF8.GetString(body);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                Console.WriteLine(&quot; [x] Received {0}&quot;, message);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                int dots = message.Split(&#x27;.&#x27;).Length - 1;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                Thread.Sleep(dots * 1000);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                Console.WriteLine(&quot; [x] Done&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                channel.BasicAck(deliveryTag: ea.DeliveryTag, multiple: false);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            channel.BasicConsume(queue: &quot;task_queue&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                 noAck: false,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                 consumer: consumer);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            Console.WriteLine(&quot; Press [enter] to exit.&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            Console.ReadLine();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><a href="http://github.com/rabbitmq/rabbitmq-tutorials/blob/master/dotnet/Worker.cs" target="_blank" rel="noopener noreferrer">Worker.cs</a></p><p>ä½¿ç”¨æ¶ˆæ¯ç¡®è®¤å’Œ <code>BasicQos</code> ä½ å¯ä»¥å¯¹å·¥ä½œé˜Ÿåˆ—è¿›è¡Œè®¾ç½®ã€‚æŒä¹…åŒ–é€‰é¡¹è®©ä»»åŠ¡åœ¨RabbitMQé‡å¯ä¹‹åä¹Ÿèƒ½å­˜æ´»ã€‚</p><p>ä½ å¯ä»¥æµè§ˆ <a href="http://www.rabbitmq.com/releases/rabbitmq-dotnet-client/v3.2.2/rabbitmq-dotnet-client-3.2.2-client-htmldoc/html/index.html" target="_blank" rel="noopener noreferrer">RabbitMQ .NET API</a> åœ¨çº¿å‚è€ƒèµ„æ–™ æ¥è·å–æ›´å¤šå…³äºIModelæ–¹æ³•å’ŒIBasicPropertiesçš„ä¿¡æ¯ã€‚</p><p>ç°åœ¨æˆ‘ä»¬ç»§ç»­ç¬¬ä¸‰ç¯‡æ•™ç¨‹ï¼Œå­¦ä¹ å¦‚ä½•æƒ³å¤šä¸ªæ¶ˆè´¹è€…é€’é€ç›¸åŒçš„æ¶ˆæ¯ã€‚</p></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/articles/rabbitmq-guide/1-hello-world"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Hello World</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/articles/rabbitmq-guide/3-Publish-Subscribe"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Publish/Subscribe Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#preparation" class="table-of-contents__link">Preparation</a></li><li><a href="#round-robin-dispatching" class="table-of-contents__link">Round-robin dispatching</a></li><li><a href="#message-acknowledgment" class="table-of-contents__link">Message acknowledgment</a></li><li><a href="#message-durability" class="table-of-contents__link">Message durability</a></li><li><a href="#fair-dispatch-å…¬å¹³åˆ†å‘" class="table-of-contents__link">Fair dispatch å…¬å¹³åˆ†å‘</a></li><li><a href="#putting-it-all-together" class="table-of-contents__link">Putting it all together</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">æ–‡ç« åˆ—è¡¨</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/articles/es6-in-depth/0-introduction">æ·±å…¥æµ…å‡ºES6 - InfoQ.cn</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/articles/why-java-sucks-and-csharp-rocks/1-compare-purpose">Why Java Sucks and C# Rocks - èµµåŠ¼</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/reading">é˜…è¯»ç¬”è®°</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/archives/git-guides">åšæ–‡å½’æ¡£</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">æ–‡æ¡£ç¿»è¯‘</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="/docs/guides/blog">Docusaurus Blog</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="/docs/guides/docs/markdown-features">Docusaurus Markdown</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">æ›´å¤š</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="/tool/wh-fgj/">æ­¦æ±‰æˆ¿ç®¡å±€ä½æˆ¿ç»Ÿè®¡æ•°æ®</a></li><li class="footer__item"><a href="https://github.com/alanwei43/node-auto-update" target="_blank" rel="noopener noreferrer" class="footer__link-item">node-auto-update - GitHub</a></li><li class="footer__item"><a href="https://github.com/alanwei43/docker-puppeteer" target="_blank" rel="noopener noreferrer" class="footer__link-item">docker-puppeteer - GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Alan&#x27;s Blog</div><div><a href="https://www.upyun.com/?utm_source=lianmeng&amp;utm_medium=referral" target="_blank">æœ¬ç½‘ç«™ç”±<img class="youPaiLogo_NvIi" src="https://gitee.com/alanway/resources/raw/master/images/youpai-logo.png">æä¾›CDNåŠ é€Ÿ/äº‘å­˜å‚¨æœåŠ¡</a></div></div></div></footer></div>
<script src="/styles.662c80e0.js"></script>
<script src="/runtime~main.83bebc2c.js"></script>
<script src="/main.da5f51c0.js"></script>
<script src="/1.e5cdeb53.js"></script>
<script src="/2.37ac7cec.js"></script>
<script src="/3.338728b3.js"></script>
<script src="/1be78505.3001f991.js"></script>
<script src="/309.74df1db2.js"></script>
<script src="/935f2afb.7bea3a99.js"></script>
<script src="/17896441.85b2881d.js"></script>
<script src="/6c627f36.79d70a53.js"></script>
</body>
</html>