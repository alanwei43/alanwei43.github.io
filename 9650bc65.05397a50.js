(window.webpackJsonp=window.webpackJsonp||[]).push([[226],{298:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return a})),n.d(t,"metadata",(function(){return c})),n.d(t,"toc",(function(){return p})),n.d(t,"default",(function(){return s}));var r=n(3),i=n(7),o=(n(0),n(470)),a={title:"\u8c03\u7528",hide_title:!1,hide_table_of_contents:!1,keywords:["okhttp","java"],description:"okhttp\u8c03\u7528"},c={unversionedId:"articles/okhttp-guide/2-calls",id:"articles/okhttp-guide/2-calls",isDocsHomePage:!1,title:"\u8c03\u7528",description:"okhttp\u8c03\u7528",source:"@site/src/docs/articles/okhttp-guide/2-calls.md",slug:"/articles/okhttp-guide/2-calls",permalink:"/docs/articles/okhttp-guide/2-calls",editUrl:"https://github.com/alanwei43/blog/tree/master/src/docs/articles/okhttp-guide/2-calls.md",version:"current",sidebar:"docs",previous:{title:"\u6982\u8ff0",permalink:"/docs/articles/okhttp-guide/1-overview"},next:{title:"\u7f13\u5b58",permalink:"/docs/articles/okhttp-guide/3-caching"}},p=[{value:"Requests",id:"requests",children:[]},{value:"Responses",id:"responses",children:[]},{value:"Rewriting Requests",id:"rewriting-requests",children:[]},{value:"Rewriting Responses",id:"rewriting-responses",children:[]},{value:"Follow-up Request",id:"follow-up-request",children:[]},{value:"Retrying Requests",id:"retrying-requests",children:[]},{value:"Calls",id:"calls",children:[]},{value:"Dispatch",id:"dispatch",children:[]}],l={toc:p};function s(e){var t=e.components,n=Object(i.a)(e,["components"]);return Object(o.b)("wrapper",Object(r.a)({},l,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,"HTTP client \u7684\u4efb\u52a1\u5c31\u662f\u63a5\u53d7\u4f60\u4f20\u9012\u7684\u8bf7\u6c42(request)\uff0c\u7136\u540e\u4ea7\u751f\u54cd\u5e94(response)\u3002\u539f\u7406\u5f88\u7b80\u5355\uff0c\u5728\u5b9e\u8df5\u4e2d\u5374\u6bd4\u8f83\u590d\u6742\u3002"),Object(o.b)("h2",{id:"requests"},Object(o.b)("a",{parentName:"h2",href:"http://square.github.io/okhttp/4.x/okhttp/okhttp3/-response/"},"Requests")),Object(o.b)("p",null,"\u6bcf\u4e00\u4e2a\u8bf7\u6c42\u90fd\u5305\u542b\u4e00\u4e2aURL\uff0c\u4e00\u4e2a\u65b9\u6cd5(\u6bd4\u5982",Object(o.b)("inlineCode",{parentName:"p"},"GET"),"\u6216\u8005",Object(o.b)("inlineCode",{parentName:"p"},"POST"),")\uff0c\u548c\u8bf7\u6c42\u5934\u5217\u8868\u3002\u8bf7\u6c42\u8fd8\u6709\u53ef\u80fd\u5305\u542b\u4e00\u4e2abody\uff1a\u6307\u5b9a\u5185\u5bb9\u7c7b\u578b\u7684\u6570\u636e\u6d41\u3002"),Object(o.b)("h2",{id:"responses"},Object(o.b)("a",{parentName:"h2",href:"http://square.github.io/okhttp/4.x/okhttp/okhttp3/-response/"},"Responses")),Object(o.b)("p",null,"\u54cd\u5e94(response)\u56de\u5e94\u8bf7\u6c42, \u5e76\u5e26\u6709\u72b6\u6001\u7801(\u6bd4\u5982200\u8868\u793a\u6210\u529f\uff0c404\u8868\u793a\u6ca1\u627e\u5230\u8d44\u6e90), \u54cd\u5e94\u5934\u4ee5\u53ca\u53ef\u9009\u7684\u54cd\u5e94\u4f53(body)."),Object(o.b)("h2",{id:"rewriting-requests"},"Rewriting Requests"),Object(o.b)("p",null,"\u5f53\u4f60\u63d0\u4f9b\u4e00\u4e2aHTTP request\u7ed9OkHttp\u7684\u65f6\u5019\uff0c\u4f60\u662f\u7ad9\u5728\u4e0a\u5c42\u63cf\u8ff0\u4e00\u4e2a\u8bf7\u6c42\u7684: \u4f7f\u7528\u8fd9\u4e9b\u8bf7\u6c42\u5934\u53bb\u8bf7\u6c42\u8fd9\u4e2aURL\u3002\u4e3a\u4e86\u6b63\u786e\u6027\u548c\u9ad8\u6548\uff0cOkHttp\u5728\u4f20\u9001\u8bf7\u6c42\u4e4b\u524d\u4f1a\u91cd\u5199\u4f60\u63d0\u4f9b\u7684\u8bf7\u6c42\u4fe1\u606f\u3002"),Object(o.b)("p",null,"OkHttp\u4f1a\u6dfb\u52a0\u7f3a\u5c11\u7684\u8bf7\u6c42\u5934\uff0c\u5305\u62ec ",Object(o.b)("inlineCode",{parentName:"p"},"Content-Length"),", ",Object(o.b)("inlineCode",{parentName:"p"},"Transfer-Encoding"),", ",Object(o.b)("inlineCode",{parentName:"p"},"User-Agent"),", ",Object(o.b)("inlineCode",{parentName:"p"},"Host"),", ",Object(o.b)("inlineCode",{parentName:"p"},"Connection"),", \u4ee5\u53ca ",Object(o.b)("inlineCode",{parentName:"p"},"Content-Type"),"\u3002\u5bf9\u4e8e\u900f\u660e\u7684\u54cd\u5e94\u4e5f\u4f1a\u6dfb\u52a0",Object(o.b)("inlineCode",{parentName:"p"},"Accept-Encoding"),"\u8bf7\u6c42\u5934\uff0c\u9664\u975e\u8fd9\u4e2a\u8bf7\u6c42\u5934\u5df2\u7ecf\u63d0\u4f9b\u4e86\u3002\u5982\u679c\u4f60\u6709cookie\uff0cOkHttp\u4f1a\u628acookie\u6dfb\u52a0\u5230",Object(o.b)("inlineCode",{parentName:"p"},"Cookie"),"\u8bf7\u6c42\u5934\u91cc\u3002"),Object(o.b)("p",null,"\u6709\u4e00\u4e9b\u8bf7\u6c42\u5c06\u4f1a\u5f97\u5230\u4e00\u4e2a\u7f13\u5b58\u540e\u7684\u54cd\u5e94\u3002\u5f53\u8fd9\u4e2a\u7f13\u5b58\u540e\u7684\u54cd\u5e94\u8fc7\u671f\u4e4b\u540e\uff0cOkHttp\u4f1a\u6267\u884c\u4e00\u4e2a ",Object(o.b)("em",{parentName:"p"},"conditional GET")," \u7684\u8bf7\u6c42\uff0c\u5982\u679c\u54cd\u5e94\u6bd4\u4e4b\u524d\u7684\u7f13\u5b58\u66f4\u65b0\uff0c\u5c31\u4f1a\u4e0b\u8f7d\u5e76\u66f4\u65b0\u7f13\u5b58\u3002\u8fd9\u8981\u6c42\u6709\u7c7b\u4f3c",Object(o.b)("inlineCode",{parentName:"p"},"If-Modified-Since"),"\u548c",Object(o.b)("inlineCode",{parentName:"p"},"If-None-Match"),"\u7684\u8bf7\u6c42\u5934\u3002"),Object(o.b)("h2",{id:"rewriting-responses"},"Rewriting Responses"),Object(o.b)("p",null,"\u5982\u679c\u4f7f\u7528\u4e86\u516c\u5f00\u7684\u538b\u7f29\uff0cOkHttp\u5c06\u4f1a\u4e22\u5f03\u76f8\u5e94\u7684\u54cd\u5e94\u5934 ",Object(o.b)("inlineCode",{parentName:"p"},"Content-Encoding")," \u548c ",Object(o.b)("inlineCode",{parentName:"p"},"Content-Length"),"\uff0c\u56e0\u4e3a\u8fd9\u4e9b\u54cd\u5e94\u5934\u4e0d\u9002\u7528\u89e3\u538b\u7f29\u540e\u7684\u54cd\u5e94\u4f53\u3002"),Object(o.b)("p",null,"\u5982\u679c conditional GET \u8bf7\u6c42\u6210\u529f\u4e86\uff0c\u7f51\u7edc\u54cd\u5e94\u7684\u5185\u5bb9\u5c06\u4f1a\u6309\u7167\u89c4\u8303\u76f4\u63a5\u5408\u5e76\u5230\u7f13\u5b58\u4e2d\u3002"),Object(o.b)("h2",{id:"follow-up-request"},"Follow-up Request"),Object(o.b)("p",null,"\u5f53\u4f60\u8bf7\u6c42\u7684URL\u53d1\u751f\u4e86\u79fb\u52a8\uff0cweb\u670d\u52a1\u5668\u5c06\u4f1a\u8fd4\u56de\u4e00\u4e2a\u72b6\u6001\u7801\u4e3a",Object(o.b)("inlineCode",{parentName:"p"},"302"),"\u7684\u54cd\u5e94\uff0c\u6307\u5b9a\u6587\u6863\u7684\u65b0URL\u5730\u5740\uff0cOkHttp\u5c06\u4f1a\u8bf7\u6c42\u8df3\u8f6c\u540e\u7684\u5730\u5740\u83b7\u53d6\u6700\u7ec8\u7684\u54cd\u5e94\u3002"),Object(o.b)("p",null,"\u5982\u679c\u54cd\u5e94\u8981\u6c42\u8ba4\u8bc1\uff0cOkHttp\u5c06\u4f1a\u8be2\u95ee",Object(o.b)("a",{parentName:"p",href:"http://square.github.io/okhttp/4.x/okhttp/okhttp3/-authenticator/"},"Authenticator"),"\u5b8c\u6210\u8ba4\u8bc1\u3002\u5982\u679c\u8ba4\u8bc1\u5668\u63d0\u4f9b\u4e86\u8bc1\u4e66\uff0c\u8bf7\u6c42\u4f1a\u5e26\u4e0a\u8bc1\u4e66\u91cd\u8bd5\u3002"),Object(o.b)("h2",{id:"retrying-requests"},"Retrying Requests"),Object(o.b)("p",null,"\u6709\u65f6\u8fde\u63a5\u4f1a\u5931\u8d25\uff1a\u4e0d\u7ba1\u662f\u8fde\u63a5\u6c60\u51fa\u73b0\u95ee\u9898\u65ad\u5f00\u4e86\u8fde\u63a5\uff0c\u8fd8\u662fweb\u670d\u52a1\u5668\u672c\u8eab\u4e0d\u53ef\u8fbe\u3002\u5982\u679c\u6709\u4e0d\u540c\u8def\u7531\u662f\u53ef\u7528\u7684\uff0cOkHttp\u90fd\u4f1a\u91cd\u65b0\u8bf7\u6c42\u3002"),Object(o.b)("h2",{id:"calls"},Object(o.b)("a",{parentName:"h2",href:"http://square.github.io/okhttp/4.x/okhttp/okhttp3/-call/"},"Calls")),Object(o.b)("p",null,"\u901a\u8fc7 rewrites, redirect, follo-ups \u4ee5\u53ca retries\uff0c\u7b80\u5355\u7684\u8bf7\u6c42\u53ef\u80fd\u6709\u591a\u6b21\u8bf7\u6c42\u548c\u54cd\u5e94\u3002OkHttp\u4f7f\u7528Call\u8868\u793a\u4e00\u4e2a\u5b8c\u6574\u7684\u8bf7\u6c42\u4efb\u52a1\uff0c\u5373\u4fbf\u4e2d\u95f4\u53ef\u80fd\u9700\u8981\u591a\u6b21\u8bf7\u6c42\u548c\u54cd\u5e94\u3002"),Object(o.b)("p",null,"Call\u4ee5\u4e0b\u9762\u5176\u4e2d\u4e00\u79cd\u65b9\u5f0f\u6267\u884c:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"\u540c\u6b65"),": \u7ebf\u7a0b\u963b\u585e\u5230\u54cd\u5e94\u53ef\u8bfb"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"\u5f02\u6b65"),": \u8bf7\u6c42\u5728\u5176\u4ed6\u7ebf\u7a0b\u6392\u961f\u7b49\u5f85\uff0c\u5f53\u54cd\u5e94\u53ef\u8bfb\u65f6\u56de\u8c03\u51fd\u6570\u4f1a\u5728\u5176\u4ed6\u7ebf\u7a0b\u6267\u884c")),Object(o.b)("p",null,"Call\u53ef\u4ee5\u5728\u4efb\u610f\u7ebf\u7a0b\u53d6\u6d88\u3002\u5f53Call\u8fd8\u672a\u5b8c\u6210\u65f6\u5c31\u53d6\u6d88\uff0c\u5c06\u4f1a\u5bfc\u81f4Call\u5931\u8d25\uff0c\u6b63\u5728\u5f80\u8bf7\u6c42\u4f53\u91cc\u5199\u6570\u636e\u7684\u4ee3\u7801\uff0c\u6216\u8005\u4ece\u54cd\u5e94\u4f53\u91cc\u8bfb\u6570\u636e\u7684\u4ee3\u7801\u5c06\u4f1a\u8dd1\u51fa IOException\u5f02\u5e38\u3002"),Object(o.b)("h2",{id:"dispatch"},"Dispatch"),Object(o.b)("p",null,"\u5bf9\u4e8e\u540c\u6b65\u8bf7\u6c42\u8c03\u7528\uff0c\u4f60\u9700\u8981\u8d1f\u8d23\u7ba1\u7406\u53ef\u4ee5\u6709\u591a\u5c11\u5e76\u53d1\u8bf7\u6c42. \u592a\u591a\u7684\u5e76\u53d1\u8fde\u63a5\u4f1a\u6d6a\u8d39\u8d44\u6e90\uff0c\u592a\u5c11\u7684\u5e76\u53d1\u8fde\u63a5\u4f1a\u635f\u5bb3\u5ef6\u8fdf\u3002"),Object(o.b)("p",null,"\u5bf9\u4e8e\u4e00\u90e8\u8bf7\u6c42\u8c03\u7528\uff0c",Object(o.b)("a",{parentName:"p",href:"http://square.github.io/okhttp/4.x/okhttp/okhttp3/-dispatcher/"},"Dispatcher"),"\u5b9e\u73b0\u4e86\u6700\u5927\u5e76\u53d1\u8bf7\u6c42\u7b56\u7565\u3002\u4f60\u53ef\u4ee5\u8bbe\u7f6e\u6700\u5927\u6570\u91cf per-webserver(\u9ed8\u8ba4\u662f5)\uff0c\u6216\u8005 overall\uff08\u9ed8\u8ba4\u662f64\uff09\u3002"),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},Object(o.b)("a",{parentName:"p",href:"https://square.github.io/okhttp/calls/"},"\u539f\u6587 - Calls"))))}s.isMDXComponent=!0},470:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return O}));var r=n(0),i=n.n(r);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=i.a.createContext({}),s=function(e){var t=i.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},b=function(e){var t=s(e.components);return i.a.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},d=i.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,a=e.parentName,l=p(e,["components","mdxType","originalType","parentName"]),b=s(n),d=r,O=b["".concat(a,".").concat(d)]||b[d]||u[d]||o;return n?i.a.createElement(O,c(c({ref:t},l),{},{components:n})):i.a.createElement(O,c({ref:t},l))}));function O(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,a=new Array(o);a[0]=d;var c={};for(var p in t)hasOwnProperty.call(t,p)&&(c[p]=t[p]);c.originalType=e,c.mdxType="string"==typeof e?e:r,a[1]=c;for(var l=2;l<o;l++)a[l]=n[l];return i.a.createElement.apply(null,a)}return i.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"}}]);