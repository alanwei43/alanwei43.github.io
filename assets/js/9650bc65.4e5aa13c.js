"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[92119],{8451:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>l,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"okhttp-guide/calls","title":"\u8c03\u7528","description":"okhttp\u8c03\u7528","source":"@site/src/docs/articles/okhttp-guide/2-calls.md","sourceDirName":"okhttp-guide","slug":"/okhttp-guide/calls","permalink":"/docs/articles/okhttp-guide/calls","draft":false,"unlisted":false,"editUrl":"https://github.com/alanwei43/blog/tree/master/src/docs/articles/okhttp-guide/2-calls.md","tags":[],"version":"current","lastUpdatedAt":1618146770000,"sidebarPosition":2,"frontMatter":{"title":"\u8c03\u7528","hide_title":false,"hide_table_of_contents":false,"keywords":["okhttp","java"],"description":"okhttp\u8c03\u7528"},"sidebar":"tutorialSidebar","previous":{"title":"\u6982\u8ff0","permalink":"/docs/articles/okhttp-guide/overview"},"next":{"title":"\u7f13\u5b58","permalink":"/docs/articles/okhttp-guide/caching"}}');var i=s(74848),r=s(28453);const l={title:"\u8c03\u7528",hide_title:!1,hide_table_of_contents:!1,keywords:["okhttp","java"],description:"okhttp\u8c03\u7528"},o=void 0,c={},d=[{value:"Requests",id:"requests",level:2},{value:"Responses",id:"responses",level:2},{value:"Rewriting Requests",id:"rewriting-requests",level:2},{value:"Rewriting Responses",id:"rewriting-responses",level:2},{value:"Follow-up Request",id:"follow-up-request",level:2},{value:"Retrying Requests",id:"retrying-requests",level:2},{value:"Calls",id:"calls",level:2},{value:"Dispatch",id:"dispatch",level:2}];function h(e){const t={a:"a",blockquote:"blockquote",code:"code",em:"em",h2:"h2",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.p,{children:"HTTP client \u7684\u4efb\u52a1\u5c31\u662f\u63a5\u53d7\u4f60\u4f20\u9012\u7684\u8bf7\u6c42(request)\uff0c\u7136\u540e\u4ea7\u751f\u54cd\u5e94(response)\u3002\u539f\u7406\u5f88\u7b80\u5355\uff0c\u5728\u5b9e\u8df5\u4e2d\u5374\u6bd4\u8f83\u590d\u6742\u3002"}),"\n",(0,i.jsx)(t.h2,{id:"requests",children:(0,i.jsx)(t.a,{href:"http://square.github.io/okhttp/4.x/okhttp/okhttp3/-response/",children:"Requests"})}),"\n",(0,i.jsxs)(t.p,{children:["\u6bcf\u4e00\u4e2a\u8bf7\u6c42\u90fd\u5305\u542b\u4e00\u4e2aURL\uff0c\u4e00\u4e2a\u65b9\u6cd5(\u6bd4\u5982",(0,i.jsx)(t.code,{children:"GET"}),"\u6216\u8005",(0,i.jsx)(t.code,{children:"POST"}),")\uff0c\u548c\u8bf7\u6c42\u5934\u5217\u8868\u3002\u8bf7\u6c42\u8fd8\u6709\u53ef\u80fd\u5305\u542b\u4e00\u4e2abody\uff1a\u6307\u5b9a\u5185\u5bb9\u7c7b\u578b\u7684\u6570\u636e\u6d41\u3002"]}),"\n",(0,i.jsx)(t.h2,{id:"responses",children:(0,i.jsx)(t.a,{href:"http://square.github.io/okhttp/4.x/okhttp/okhttp3/-response/",children:"Responses"})}),"\n",(0,i.jsx)(t.p,{children:"\u54cd\u5e94(response)\u56de\u5e94\u8bf7\u6c42, \u5e76\u5e26\u6709\u72b6\u6001\u7801(\u6bd4\u5982200\u8868\u793a\u6210\u529f\uff0c404\u8868\u793a\u6ca1\u627e\u5230\u8d44\u6e90), \u54cd\u5e94\u5934\u4ee5\u53ca\u53ef\u9009\u7684\u54cd\u5e94\u4f53(body)."}),"\n",(0,i.jsx)(t.h2,{id:"rewriting-requests",children:"Rewriting Requests"}),"\n",(0,i.jsx)(t.p,{children:"\u5f53\u4f60\u63d0\u4f9b\u4e00\u4e2aHTTP request\u7ed9OkHttp\u7684\u65f6\u5019\uff0c\u4f60\u662f\u7ad9\u5728\u4e0a\u5c42\u63cf\u8ff0\u4e00\u4e2a\u8bf7\u6c42\u7684: \u4f7f\u7528\u8fd9\u4e9b\u8bf7\u6c42\u5934\u53bb\u8bf7\u6c42\u8fd9\u4e2aURL\u3002\u4e3a\u4e86\u6b63\u786e\u6027\u548c\u9ad8\u6548\uff0cOkHttp\u5728\u4f20\u9001\u8bf7\u6c42\u4e4b\u524d\u4f1a\u91cd\u5199\u4f60\u63d0\u4f9b\u7684\u8bf7\u6c42\u4fe1\u606f\u3002"}),"\n",(0,i.jsxs)(t.p,{children:["OkHttp\u4f1a\u6dfb\u52a0\u7f3a\u5c11\u7684\u8bf7\u6c42\u5934\uff0c\u5305\u62ec ",(0,i.jsx)(t.code,{children:"Content-Length"}),", ",(0,i.jsx)(t.code,{children:"Transfer-Encoding"}),", ",(0,i.jsx)(t.code,{children:"User-Agent"}),", ",(0,i.jsx)(t.code,{children:"Host"}),", ",(0,i.jsx)(t.code,{children:"Connection"}),", \u4ee5\u53ca ",(0,i.jsx)(t.code,{children:"Content-Type"}),"\u3002\u5bf9\u4e8e\u900f\u660e\u7684\u54cd\u5e94\u4e5f\u4f1a\u6dfb\u52a0",(0,i.jsx)(t.code,{children:"Accept-Encoding"}),"\u8bf7\u6c42\u5934\uff0c\u9664\u975e\u8fd9\u4e2a\u8bf7\u6c42\u5934\u5df2\u7ecf\u63d0\u4f9b\u4e86\u3002\u5982\u679c\u4f60\u6709cookie\uff0cOkHttp\u4f1a\u628acookie\u6dfb\u52a0\u5230",(0,i.jsx)(t.code,{children:"Cookie"}),"\u8bf7\u6c42\u5934\u91cc\u3002"]}),"\n",(0,i.jsxs)(t.p,{children:["\u6709\u4e00\u4e9b\u8bf7\u6c42\u5c06\u4f1a\u5f97\u5230\u4e00\u4e2a\u7f13\u5b58\u540e\u7684\u54cd\u5e94\u3002\u5f53\u8fd9\u4e2a\u7f13\u5b58\u540e\u7684\u54cd\u5e94\u8fc7\u671f\u4e4b\u540e\uff0cOkHttp\u4f1a\u6267\u884c\u4e00\u4e2a ",(0,i.jsx)(t.em,{children:"conditional GET"})," \u7684\u8bf7\u6c42\uff0c\u5982\u679c\u54cd\u5e94\u6bd4\u4e4b\u524d\u7684\u7f13\u5b58\u66f4\u65b0\uff0c\u5c31\u4f1a\u4e0b\u8f7d\u5e76\u66f4\u65b0\u7f13\u5b58\u3002\u8fd9\u8981\u6c42\u6709\u7c7b\u4f3c",(0,i.jsx)(t.code,{children:"If-Modified-Since"}),"\u548c",(0,i.jsx)(t.code,{children:"If-None-Match"}),"\u7684\u8bf7\u6c42\u5934\u3002"]}),"\n",(0,i.jsx)(t.h2,{id:"rewriting-responses",children:"Rewriting Responses"}),"\n",(0,i.jsxs)(t.p,{children:["\u5982\u679c\u4f7f\u7528\u4e86\u516c\u5f00\u7684\u538b\u7f29\uff0cOkHttp\u5c06\u4f1a\u4e22\u5f03\u76f8\u5e94\u7684\u54cd\u5e94\u5934 ",(0,i.jsx)(t.code,{children:"Content-Encoding"})," \u548c ",(0,i.jsx)(t.code,{children:"Content-Length"}),"\uff0c\u56e0\u4e3a\u8fd9\u4e9b\u54cd\u5e94\u5934\u4e0d\u9002\u7528\u89e3\u538b\u7f29\u540e\u7684\u54cd\u5e94\u4f53\u3002"]}),"\n",(0,i.jsx)(t.p,{children:"\u5982\u679c conditional GET \u8bf7\u6c42\u6210\u529f\u4e86\uff0c\u7f51\u7edc\u54cd\u5e94\u7684\u5185\u5bb9\u5c06\u4f1a\u6309\u7167\u89c4\u8303\u76f4\u63a5\u5408\u5e76\u5230\u7f13\u5b58\u4e2d\u3002"}),"\n",(0,i.jsx)(t.h2,{id:"follow-up-request",children:"Follow-up Request"}),"\n",(0,i.jsxs)(t.p,{children:["\u5f53\u4f60\u8bf7\u6c42\u7684URL\u53d1\u751f\u4e86\u79fb\u52a8\uff0cweb\u670d\u52a1\u5668\u5c06\u4f1a\u8fd4\u56de\u4e00\u4e2a\u72b6\u6001\u7801\u4e3a",(0,i.jsx)(t.code,{children:"302"}),"\u7684\u54cd\u5e94\uff0c\u6307\u5b9a\u6587\u6863\u7684\u65b0URL\u5730\u5740\uff0cOkHttp\u5c06\u4f1a\u8bf7\u6c42\u8df3\u8f6c\u540e\u7684\u5730\u5740\u83b7\u53d6\u6700\u7ec8\u7684\u54cd\u5e94\u3002"]}),"\n",(0,i.jsxs)(t.p,{children:["\u5982\u679c\u54cd\u5e94\u8981\u6c42\u8ba4\u8bc1\uff0cOkHttp\u5c06\u4f1a\u8be2\u95ee",(0,i.jsx)(t.a,{href:"http://square.github.io/okhttp/4.x/okhttp/okhttp3/-authenticator/",children:"Authenticator"}),"\u5b8c\u6210\u8ba4\u8bc1\u3002\u5982\u679c\u8ba4\u8bc1\u5668\u63d0\u4f9b\u4e86\u8bc1\u4e66\uff0c\u8bf7\u6c42\u4f1a\u5e26\u4e0a\u8bc1\u4e66\u91cd\u8bd5\u3002"]}),"\n",(0,i.jsx)(t.h2,{id:"retrying-requests",children:"Retrying Requests"}),"\n",(0,i.jsx)(t.p,{children:"\u6709\u65f6\u8fde\u63a5\u4f1a\u5931\u8d25\uff1a\u4e0d\u7ba1\u662f\u8fde\u63a5\u6c60\u51fa\u73b0\u95ee\u9898\u65ad\u5f00\u4e86\u8fde\u63a5\uff0c\u8fd8\u662fweb\u670d\u52a1\u5668\u672c\u8eab\u4e0d\u53ef\u8fbe\u3002\u5982\u679c\u6709\u4e0d\u540c\u8def\u7531\u662f\u53ef\u7528\u7684\uff0cOkHttp\u90fd\u4f1a\u91cd\u65b0\u8bf7\u6c42\u3002"}),"\n",(0,i.jsx)(t.h2,{id:"calls",children:(0,i.jsx)(t.a,{href:"http://square.github.io/okhttp/4.x/okhttp/okhttp3/-call/",children:"Calls"})}),"\n",(0,i.jsx)(t.p,{children:"\u901a\u8fc7 rewrites, redirect, follo-ups \u4ee5\u53ca retries\uff0c\u7b80\u5355\u7684\u8bf7\u6c42\u53ef\u80fd\u6709\u591a\u6b21\u8bf7\u6c42\u548c\u54cd\u5e94\u3002OkHttp\u4f7f\u7528Call\u8868\u793a\u4e00\u4e2a\u5b8c\u6574\u7684\u8bf7\u6c42\u4efb\u52a1\uff0c\u5373\u4fbf\u4e2d\u95f4\u53ef\u80fd\u9700\u8981\u591a\u6b21\u8bf7\u6c42\u548c\u54cd\u5e94\u3002"}),"\n",(0,i.jsx)(t.p,{children:"Call\u4ee5\u4e0b\u9762\u5176\u4e2d\u4e00\u79cd\u65b9\u5f0f\u6267\u884c:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"\u540c\u6b65"}),": \u7ebf\u7a0b\u963b\u585e\u5230\u54cd\u5e94\u53ef\u8bfb"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"\u5f02\u6b65"}),": \u8bf7\u6c42\u5728\u5176\u4ed6\u7ebf\u7a0b\u6392\u961f\u7b49\u5f85\uff0c\u5f53\u54cd\u5e94\u53ef\u8bfb\u65f6\u56de\u8c03\u51fd\u6570\u4f1a\u5728\u5176\u4ed6\u7ebf\u7a0b\u6267\u884c"]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"Call\u53ef\u4ee5\u5728\u4efb\u610f\u7ebf\u7a0b\u53d6\u6d88\u3002\u5f53Call\u8fd8\u672a\u5b8c\u6210\u65f6\u5c31\u53d6\u6d88\uff0c\u5c06\u4f1a\u5bfc\u81f4Call\u5931\u8d25\uff0c\u6b63\u5728\u5f80\u8bf7\u6c42\u4f53\u91cc\u5199\u6570\u636e\u7684\u4ee3\u7801\uff0c\u6216\u8005\u4ece\u54cd\u5e94\u4f53\u91cc\u8bfb\u6570\u636e\u7684\u4ee3\u7801\u5c06\u4f1a\u8dd1\u51fa IOException\u5f02\u5e38\u3002"}),"\n",(0,i.jsx)(t.h2,{id:"dispatch",children:"Dispatch"}),"\n",(0,i.jsx)(t.p,{children:"\u5bf9\u4e8e\u540c\u6b65\u8bf7\u6c42\u8c03\u7528\uff0c\u4f60\u9700\u8981\u8d1f\u8d23\u7ba1\u7406\u53ef\u4ee5\u6709\u591a\u5c11\u5e76\u53d1\u8bf7\u6c42. \u592a\u591a\u7684\u5e76\u53d1\u8fde\u63a5\u4f1a\u6d6a\u8d39\u8d44\u6e90\uff0c\u592a\u5c11\u7684\u5e76\u53d1\u8fde\u63a5\u4f1a\u635f\u5bb3\u5ef6\u8fdf\u3002"}),"\n",(0,i.jsxs)(t.p,{children:["\u5bf9\u4e8e\u4e00\u90e8\u8bf7\u6c42\u8c03\u7528\uff0c",(0,i.jsx)(t.a,{href:"http://square.github.io/okhttp/4.x/okhttp/okhttp3/-dispatcher/",children:"Dispatcher"}),"\u5b9e\u73b0\u4e86\u6700\u5927\u5e76\u53d1\u8bf7\u6c42\u7b56\u7565\u3002\u4f60\u53ef\u4ee5\u8bbe\u7f6e\u6700\u5927\u6570\u91cf per-webserver(\u9ed8\u8ba4\u662f5)\uff0c\u6216\u8005 overall\uff08\u9ed8\u8ba4\u662f64\uff09\u3002"]}),"\n",(0,i.jsxs)(t.blockquote,{children:["\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.a,{href:"https://square.github.io/okhttp/calls/",children:"\u539f\u6587 - Calls"})}),"\n"]})]})}function p(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>l,x:()=>o});var n=s(96540);const i={},r=n.createContext(i);function l(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);