"use strict";(self.webpackChunkalan_blog=self.webpackChunkalan_blog||[]).push([[1294],{3905:function(e,n,t){t.d(n,{Zo:function(){return s},kt:function(){return k}});var o=t(67294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,o,r=function(e,n){if(null==e)return{};var t,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var l=o.createContext({}),d=function(e){var n=o.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},s=function(e){var n=d(e.components);return o.createElement(l.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},u=o.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,s=c(e,["components","mdxType","originalType","parentName"]),u=d(t),k=r,v=u["".concat(l,".").concat(k)]||u[k]||p[k]||i;return t?o.createElement(v,a(a({ref:n},s),{},{components:t})):o.createElement(v,a({ref:n},s))}));function k(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,a=new Array(i);a[0]=u;var c={};for(var l in n)hasOwnProperty.call(n,l)&&(c[l]=n[l]);c.originalType=e,c.mdxType="string"==typeof e?e:r,a[1]=c;for(var d=2;d<i;d++)a[d]=t[d];return o.createElement.apply(null,a)}return o.createElement.apply(null,t)}u.displayName="MDXCreateElement"},80956:function(e,n,t){t.r(n),t.d(n,{assets:function(){return s},contentTitle:function(){return l},default:function(){return k},frontMatter:function(){return c},metadata:function(){return d},toc:function(){return p}});var o=t(87462),r=t(63366),i=(t(67294),t(3905)),a=["components"],c={title:"VS Code \u5bb9\u5668\u5f00\u53d1\u7b80\u4ecb",hide_title:!1,hide_table_of_contents:!1,custom_edit_url:null,keywords:["vsc","visual studio code","docker"],tags:["vsc","Visual Studio Code"],sidebar_position:4},l=void 0,d={unversionedId:"articles/vsc-container/samples",id:"articles/vsc-container/samples",title:"VS Code \u5bb9\u5668\u5f00\u53d1\u7b80\u4ecb",description:"\u4ee5\u4e0b\u5217\u51fa\u4e24\u4e2a\u793a\u4f8b:",source:"@site/src/docs/articles/vsc-container/samples.md",sourceDirName:"articles/vsc-container",slug:"/articles/vsc-container/samples",permalink:"/docs/articles/vsc-container/samples",draft:!1,editUrl:null,tags:[{label:"vsc",permalink:"/docs/tags/vsc"},{label:"Visual Studio Code",permalink:"/docs/tags/visual-studio-code"}],version:"current",sidebarPosition:4,frontMatter:{title:"VS Code \u5bb9\u5668\u5f00\u53d1\u7b80\u4ecb",hide_title:!1,hide_table_of_contents:!1,custom_edit_url:null,keywords:["vsc","visual studio code","docker"],tags:["vsc","Visual Studio Code"],sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Advanced Containers",permalink:"/docs/articles/vsc-container/advanced-containers"},next:{title:"Docker",permalink:"/docs/articles/docker"}},s={},p=[{value:"\u5feb\u901f\u5f00\u59cbNode\u9879\u76ee\u5bb9\u5668\u5f00\u53d1",id:"\u5feb\u901f\u5f00\u59cbnode\u9879\u76ee\u5bb9\u5668\u5f00\u53d1",level:2},{value:"<code>devcontainer.json</code>",id:"devcontainerjson",level:3},{value:"<code>dev.Dockerfile</code>:",id:"devdockerfile",level:3},{value:"Node\u9879\u76ee\u5171\u4eabNPM\u4f9d\u8d56",id:"node\u9879\u76ee\u5171\u4eabnpm\u4f9d\u8d56",level:2},{value:"<code>devcontainer.json</code>",id:"devcontainerjson-1",level:3},{value:"<code>dev.Dockerfile</code>:",id:"devdockerfile-1",level:3},{value:"<code>dev.Dockerfile.dockerignore</code>",id:"devdockerfiledockerignore",level:3},{value:"<code>dep.Dockerfile</code>",id:"depdockerfile",level:3},{value:"<code>dep.Dockerfile.dockerignore</code>",id:"depdockerfiledockerignore",level:3},{value:"<code>build-dependency.sh</code>",id:"build-dependencysh",level:3},{value:"\u4f7f\u7528",id:"\u4f7f\u7528",level:3}],u={toc:p};function k(e){var n=e.components,t=(0,r.Z)(e,a);return(0,i.kt)("wrapper",(0,o.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"\u4ee5\u4e0b\u5217\u51fa\u4e24\u4e2a\u793a\u4f8b:"),(0,i.kt)("h2",{id:"\u5feb\u901f\u5f00\u59cbnode\u9879\u76ee\u5bb9\u5668\u5f00\u53d1"},"\u5feb\u901f\u5f00\u59cbNode\u9879\u76ee\u5bb9\u5668\u5f00\u53d1"),(0,i.kt)("p",null,"\u672c\u793a\u4f8b\u65b9\u4fbf\u5feb\u901f\u8fdb\u884cnode\u9879\u76ee\u5bb9\u5668\u5f00\u53d1."),(0,i.kt)("p",null,"\u5047\u5982\u4f60\u7684\u9879\u76ee\u540d\u79f0\u53eb ",(0,i.kt)("inlineCode",{parentName:"p"},"my-vsc-container-app")),(0,i.kt)("p",null,"\u9879\u76ee\u6839\u76ee\u5f55\u521b\u5efa\u6587\u4ef6\u5939 ",(0,i.kt)("inlineCode",{parentName:"p"},".devcontainer"),", \u6587\u4ef6\u5939\u4e0b\u521b\u5efa\u4ee5\u4e0b\u6587\u4ef6:"),(0,i.kt)("h3",{id:"devcontainerjson"},(0,i.kt)("inlineCode",{parentName:"h3"},"devcontainer.json")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:'title=".devcontainer/devcontainer.json"',title:'".devcontainer/devcontainer.json"'},'// https://code.visualstudio.com/docs/remote/devcontainerjson-reference\n{\n  "name": "Node.js Dev",\n  "build": {\n    "dockerfile": "dev.Dockerfile",\n    "context": "."\n  },\n  "customizations": {\n    "vscode": {\n      "settings": {\n        "terminal.integrated.shell.linux": "/bin/bash"\n      }\n    }\n  },\n  "forwardPorts": [\n    3000\n  ],\n  "postCreateCommand": "npm install",\n  "workspaceMount": "source=${localWorkspaceFolder}/,target=/workspace,type=bind,consistency=cached",\n  "workspaceFolder": "/workspace",\n  "mounts": [\n    "source=my-vsc-container-app-node-modules,target=${containerWorkspaceFolder}/node_modules,type=volume"\n  ],\n  "extensions": [\n    "allanoricil.nuxt-vscode-extension",\n    "eamodio.gitlens",\n    "editorconfig.editorconfig",\n    "esbenp.prettier-vscode",\n    "octref.vetur"\n  ]\n  // "remoteUser": "node"\n}\n')),(0,i.kt)("h3",{id:"devdockerfile"},(0,i.kt)("inlineCode",{parentName:"h3"},"dev.Dockerfile"),":"),(0,i.kt)("p",null,"\u8be5\u6587\u4ef6\u662f Remote - Contaienr \u5b9e\u9645\u4f7f\u7528\u7684\u955c\u50cf, \u5728\u8fd9\u4e2a\u6587\u4ef6\u91cc\u53ef\u4ee5\u5b89\u88c5\u4e00\u4e9b\u5de5\u5177: "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-dockerfile",metastring:'title=".devcontainer/dev.Dockerfile"',title:'".devcontainer/dev.Dockerfile"'},"FROM node:lts\n\n# \u6839\u636e\u9700\u8981\u662f\u5426\u5728\u5bb9\u5668\u91cc\u5b89\u88c5\u5176\u4ed6\u5de5\u5177\nRUN apt install -y git \n")),(0,i.kt)("h2",{id:"node\u9879\u76ee\u5171\u4eabnpm\u4f9d\u8d56"},"Node\u9879\u76ee\u5171\u4eabNPM\u4f9d\u8d56"),(0,i.kt)("p",null,"\u672c\u793a\u4f8b\u4f1a\u5c06\u9879\u76ee\u7684npm\u4f9d\u8d56\u505a\u6210\u955c\u50cf, \u65b9\u4fbf\u5176\u4ed6\u4eba\u4f7f\u7528\u9879\u76ee\u5f00\u53d1."),(0,i.kt)("p",null,"\u5047\u5982\u4f60\u7684\u9879\u76ee\u540d\u79f0\u53eb ",(0,i.kt)("inlineCode",{parentName:"p"},"my-vsc-container-app")),(0,i.kt)("p",null,"\u9879\u76ee\u6839\u76ee\u5f55\u521b\u5efa\u6587\u4ef6\u5939 ",(0,i.kt)("inlineCode",{parentName:"p"},".devcontainer"),", \u6587\u4ef6\u5939\u4e0b\u521b\u5efa\u4ee5\u4e0b\u6587\u4ef6:"),(0,i.kt)("h3",{id:"devcontainerjson-1"},(0,i.kt)("inlineCode",{parentName:"h3"},"devcontainer.json")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:'title=".devcontainer/devcontainer.json"',title:'".devcontainer/devcontainer.json"'},'// https://code.visualstudio.com/docs/remote/devcontainerjson-reference\n{\n  "name": "Node.js Dev",\n  "build": {\n    "dockerfile": "dev.Dockerfile",\n    "context": "."\n  },\n  "customizations": {\n    "vscode": {\n      "settings": {\n        "terminal.integrated.shell.linux": "/bin/bash"\n      }\n    }\n  },\n  "forwardPorts": [\n    3000\n  ],\n  "postCreateCommand": "tar -xvf /data/dep.tar.gz --directory ./",\n  "workspaceMount": "source=${localWorkspaceFolder}/,target=/workspace,type=bind,consistency=cached",\n  "workspaceFolder": "/workspace",\n  "mounts": [\n    "source=my-vsc-container-app-node-modules,target=${containerWorkspaceFolder}/node_modules,type=volume"\n  ],\n  "extensions": [\n    "allanoricil.nuxt-vscode-extension",\n    "eamodio.gitlens",\n    "editorconfig.editorconfig",\n    "esbenp.prettier-vscode",\n    "octref.vetur"\n  ]\n  // "remoteUser": "node"\n}\n')),(0,i.kt)("h3",{id:"devdockerfile-1"},(0,i.kt)("inlineCode",{parentName:"h3"},"dev.Dockerfile"),":"),(0,i.kt)("p",null,"\u8be5\u6587\u4ef6\u662f Remote - Contaienr \u5b9e\u9645\u4f7f\u7528\u7684\u955c\u50cf, \u5728\u8fd9\u4e2a\u6587\u4ef6\u91cc\u53ef\u4ee5\u5b89\u88c5\u4e00\u4e9b\u5de5\u5177: "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-dockerfile",metastring:'title=".devcontainer/dev.Dockerfile"',title:'".devcontainer/dev.Dockerfile"'},"FROM your-private-docker-hub-host/my-vsc-container-app-dep:latest\n")),(0,i.kt)("p",null,"\u8fd9\u91cc\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"FROM")," \u6307\u4ee4\u6307\u5b9a\u7684\u955c\u50cf\u662f\u4e0b\u9762 ",(0,i.kt)("inlineCode",{parentName:"p"},"dev.Dockerfile")," "),(0,i.kt)("h3",{id:"devdockerfiledockerignore"},(0,i.kt)("inlineCode",{parentName:"h3"},"dev.Dockerfile.dockerignore")),(0,i.kt)("p",null,"\u8be5\u6587\u4ef6\u6392\u9664 ",(0,i.kt)("inlineCode",{parentName:"p"},"node_modules")," \u76ee\u5f55, \u662f ",(0,i.kt)("inlineCode",{parentName:"p"},"dev.Dockerfile")," \u6784\u5efa\u662f\u6392\u9664\u7684\u6587\u4ef6"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ignore"},"node_modules\n")),(0,i.kt)("h3",{id:"depdockerfile"},(0,i.kt)("inlineCode",{parentName:"h3"},"dep.Dockerfile")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-Dockerfile",metastring:'title="dep.Dockerfile"',title:'"dep.Dockerfile"'},"FROM node:16\n\nWORKDIR /data\nCOPY ./*.json ./\nCOPY ./.npmrc ./\n# \u8fd9\u91cc\u5b89\u88c5\u4f9d\u8d56\u5e76\nRUN npm ci && \\\n  tar -czf dep.tar.gz ./node_modules && \\\n  rm -rf ./node_modules\n")),(0,i.kt)("h3",{id:"depdockerfiledockerignore"},(0,i.kt)("inlineCode",{parentName:"h3"},"dep.Dockerfile.dockerignore")),(0,i.kt)("p",null,"\u8be5\u6587\u4ef6\u914d\u7f6e ",(0,i.kt)("inlineCode",{parentName:"p"},"dep.Dockerfile")," \u4f7f\u7528, \u7528\u4e8e\u6784\u5efa\u955c\u50cf\u65f6\u5ffd\u7565\u7684\u6587\u4ef6:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"*\n!*.json\n!.npmrc\n")),(0,i.kt)("h3",{id:"build-dependencysh"},(0,i.kt)("inlineCode",{parentName:"h3"},"build-dependency.sh")),(0,i.kt)("p",null,"\u8be5\u811a\u672c\u7528\u4e8e\u6784\u5efa\u955c\u50cf: ",(0,i.kt)("inlineCode",{parentName:"p"},"my-vsc-container-app-dep")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"DOCKER_BUILDKIT=1 docker build --progress=plain -t my-vsc-container-app-dep:latest --file dep.Dockerfile ../ && \\\ndocker tag my-vsc-container-app-dep:latest your-private-docker-hub-host/my-vsc-container-app-dep:latest && \\\ndocker push your-private-docker-hub-host/my-vsc-container-app-dep:latest\n")),(0,i.kt)("h3",{id:"\u4f7f\u7528"},"\u4f7f\u7528"),(0,i.kt)("p",null,"\u521b\u5efa\u4ee5\u4e0a\u6587\u4ef6\u540e, \u7b2c\u4e00\u6b21\u9700\u8981\u5728\u9879\u76ee\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},".devcontainer")," \u6587\u4ef6\u5939\u5185\u6267\u884c ",(0,i.kt)("inlineCode",{parentName:"p"},"build-dependency.sh")," \u811a\u672c\u521b\u5efa\u4f9d\u8d56\u955c\u50cf\u5e76\u63a8\u9001\u5230\u79c1\u670d(\u6ce8\u610f\u4e00\u5b9a\u8981\u4f7f\u7528\u7ec8\u7aef\u8fdb\u5165\u5230 ",(0,i.kt)("inlineCode",{parentName:"p"},".devcontainer"),"\u76ee\u5f55\u540e\u5728\u6267\u884c\u6539\u811a\u672c, \u56e0\u4e3a\u8be5\u811a\u672c\u91cc\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"docker build")," \u4f20\u5165\u7684\u76ee\u5f55\u662f\u7236\u7ea7\u76ee\u5f55). \u7136\u540e\u5176\u4ed6\u4eba\u83b7\u53d6\u5b8c\u9879\u76ee\u5c31\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u5bb9\u5668\u5f00\u53d1\u4e86."))}k.isMDXComponent=!0}}]);