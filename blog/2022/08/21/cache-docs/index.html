<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Caching Tutorial for Web Authors and Webmasters  -  Alan&#x27;s Blog</title><meta data-rh="true" name="baidu-site-verification" content="code-7RGpEH8jty"><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://blog.alanwei.com/blog/2022/08/21/cache-docs"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Caching Tutorial for Web Authors and Webmasters  -  Alan&#x27;s Blog"><meta data-rh="true" name="description" content="原文 Caching Tutorial for Web Authors and Webmasters"><meta data-rh="true" property="og:description" content="原文 Caching Tutorial for Web Authors and Webmasters"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2022-08-21T00:00:00.000Z"><meta data-rh="true" property="article:tag" content="HTTP,Cache,CDN"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://blog.alanwei.com/blog/2022/08/21/cache-docs"><link data-rh="true" rel="alternate" href="https://blog.alanwei.com/blog/2022/08/21/cache-docs" hreflang="en"><link data-rh="true" rel="alternate" href="https://blog.alanwei.com/blog/2022/08/21/cache-docs" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://7SQ6A6EP36-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Alan&#39;s Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Alan&#39;s Blog Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Alan&#39;s Blog" href="/opensearch.xml">





<link rel="stylesheet" href="/styles/global.css">
<script src="/scripts/baidu.js"></script>
<script src="/scripts/bing-clarity.js"></script>
<script src="/scripts/google.js"></script><link rel="stylesheet" href="/assets/css/styles.46ae3731.css">
<link rel="preload" href="/assets/js/runtime~main.48be7bf4.js" as="script">
<link rel="preload" href="/assets/js/main.084633aa.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Alan&#x27;s Blog</b></a><a class="navbar__item navbar__link" href="/docs/articles">Articles</a><a class="navbar__item navbar__link" href="/docs/reading">Reading</a><a class="navbar__item navbar__link" href="/docs/built-in">Documents</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/me">Abount me</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/alanwei43" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_brwN thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_r4Q1 margin-bottom--md">Top posts</div><ul class="sidebarItemList_QwSx clean-list"><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2022/03/12/caddy-intro/">Caddy 简介</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2022/11/27/fnm-node-version-manager">fnm - Node版本管理工具</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2022/07/21/graphql-intro">GraphQL intro</a></li></ul><div class="sidebarItemTitle_r4Q1 margin-bottom--md">Recent posts</div><ul class="sidebarItemList_QwSx clean-list"><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/09/18/webm-to-mp4">webm转换mp4</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/08/06/vscode-previous-release-versions-download">VSCode 历史版本下载</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/07/28/chrome-touchevent-passive">Chrome TouchEvent passive 参数介绍</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/06/23/macos-wechat-backup-location">macOS 系统微信聊天记录备份目录</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/06/14/linux-port-forward-socat">Linux系统端口转发</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/06/12/javascript-shuffle">JavaScript 乱序(洗牌)算法</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/05/28/ubuntu-chinese-input-method">Ubuntu 安装中文输入法</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/05/11/vim-json">Vim format JSON</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/05/04/dingtalk-update">钉钉 Ubuntu/Debian 下载地址</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/05/03/docker-offline-install">Downloading docker image for transfer to non-internet-connected machine</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/04/30/rsync-with-custom-port">rsync 同步文件指定端口号</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/04/30/vmware-install-android">使用 VMware 安装 Android</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/04/15/gradle-development">Gradle 开发配置</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/03/27/nginx-location-directive">NGINX location 指令示例</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/03/17/gnome-shell">Ubuntu install gnome</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/03/09/vue-cli-es5">Vue2项目构建没有转换ES6语法</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/03/07/nuxt-insert-inline-script">Nuxt 插入内联脚本</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/02/21/chrome-redirect-https-from-http">解决 Chrome 记住 HTTP 自动跳转 HTTPS</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/02/12/docusaurus-multi-documents">Docusaurus 多个文档</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/02/10/linux-skills">Linux 技巧</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/02/08/ubuntu-permanently-remove-sidebar-video">删除 Files 侧边栏预置目录</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/02/05/amazon-kindle-backup">Amazon Kindle 电子书备份</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/02/04/linux-chrome-disable-password">Ubuntu启动Chrome去掉每次输入密码</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/01/09/awesome-code-snippet">Awesome Code Snippet</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/01/08/live-stream-server">Live Stream Server</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2022/12/29/pm2-config">PM2 配置文件介绍</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2022/12/26/flutter-develop-environment-setup">Flutter 开发环境设置</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2022/11/22/linux-install-vmware-workstation">Linux install VMware Workstation</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2022/11/22/resolve-npm-install-fail">国内 .npmrc 配置</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="title_f1Hy" itemprop="headline">Caching Tutorial for Web Authors and Webmasters</h1><div class="container_mt6G margin-vert--md"><time datetime="2022-08-21T00:00:00.000Z" itemprop="datePublished">August 21, 2022</time> · <!-- -->33 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><span itemprop="name">Mark Nottingham</span></div></div></div></div></div></header><div id="post-content" class="markdown" itemprop="articleBody"><p><a href="https://www.mnot.net/cache_docs/" target="_blank" rel="noopener noreferrer">原文 Caching Tutorial for Web Authors and Webmasters</a></p><p>This is an informational document. Although technical in nature, it attempts to make the concepts involved understandable and applicable in real-world situations. Because of this, some aspects of the material are simplified or omitted, for the sake of clarity. If you are interested in the minutia of the subject, please explore the <a href="https://www.mnot.net/cache_docs/#REF" target="_blank" rel="noopener noreferrer">References and Further Information</a> at the end.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="whats-a-web-cache-why-do-people-use-them">What’s a Web Cache? Why do people use them?<a href="#whats-a-web-cache-why-do-people-use-them" class="hash-link" aria-label="Direct link to What’s a Web Cache? Why do people use them?" title="Direct link to What’s a Web Cache? Why do people use them?">​</a></h2><p>A Web cache sits between one or more Web servers (also known as <em>origin servers</em>) and a client or many clients, and watches requests come by, saving copies of the responses — like HTML pages, images and files (collectively known as <em>representations</em>) — for itself. Then, if there is another request for the same URL, it can use the response that it has, instead of asking the origin server for it again.</p><p>There are two main reasons that Web caches are used:</p><ul><li>To <strong>reduce latency</strong> — Because the request is satisfied from the cache (which is closer to the client) instead of the origin server, it takes less time for it to get the representation and display it. This makes the Web seem more responsive.</li><li><strong>To reduce network traffic</strong> — Because representations are reused, it reduces the amount of bandwidth used by a client. This saves money if the client is paying for traffic, and keeps their bandwidth requirements lower and more manageable.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="kinds-of-web-caches">Kinds of Web Caches<a href="#kinds-of-web-caches" class="hash-link" aria-label="Direct link to Kinds of Web Caches" title="Direct link to Kinds of Web Caches">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="browser-caches">Browser Caches<a href="#browser-caches" class="hash-link" aria-label="Direct link to Browser Caches" title="Direct link to Browser Caches">​</a></h3><p>If you examine the preferences dialog of any modern Web browser (like Internet Explorer, Safari or Mozilla), you’ll probably notice a “cache” setting. This lets you set aside a section of your computer’s hard disk to store representations that you’ve seen, just for you. The browser cache works according to fairly simple rules. It will check to make sure that the representations are fresh, usually once a session (that is, the once in the current invocation of the browser).</p><p>This cache is especially useful when users hit the “back” button or click a link to see a page they’ve just looked at. Also, if you use the same navigation images throughout your site, they’ll be served from browsers’ caches almost instantaneously.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="proxy-caches">Proxy Caches<a href="#proxy-caches" class="hash-link" aria-label="Direct link to Proxy Caches" title="Direct link to Proxy Caches">​</a></h3><p>Web proxy caches work on the same principle, but a much larger scale. Proxies serve hundreds or thousands of users in the same way; large corporations and ISPs often set them up on their firewalls, or as standalone devices (also known as <em>intermediaries</em>).</p><p>Because proxy caches aren’t part of the client or the origin server, but instead are out on the network, requests have to be routed to them somehow. One way to do this is to use your browser’s proxy setting to manually tell it what proxy to use; another is using interception. Interception proxies have Web requests redirected to them by the underlying network itself, so that clients don’t need to be configured for them, or even know about them.</p><p>Proxy caches are a type of shared cache; rather than just having one person using them, they usually have a large number of users, and because of this they are very good at reducing latency and network traffic. That’s because popular representations are reused a number of times.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="gateway-caches">Gateway Caches<a href="#gateway-caches" class="hash-link" aria-label="Direct link to Gateway Caches" title="Direct link to Gateway Caches">​</a></h3><p>Also known as “reverse proxy caches” or “surrogate caches,” gateway caches are also intermediaries, but instead of being deployed by network administrators to save bandwidth, they’re typically deployed by Webmasters themselves, to make their sites more scalable, reliable and better performing.</p><p>Requests can be routed to gateway caches by a number of methods, but typically some form of load balancer is used to make one or more of them look like the origin server to clients.</p><p>Content delivery networks (CDNs) distribute gateway caches throughout the Internet (or a part of it) and sell caching to interested Web sites. Speedera and Akamai are examples of CDNs.</p><p>This tutorial focuses mostly on browser and proxy caches, although some of the information is suitable for those interested in gateway caches as well.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="arent-web-caches-bad-for-me-why-should-i-help-them">Aren’t Web Caches bad for me? Why should I help them?<a href="#arent-web-caches-bad-for-me-why-should-i-help-them" class="hash-link" aria-label="Direct link to Aren’t Web Caches bad for me? Why should I help them?" title="Direct link to Aren’t Web Caches bad for me? Why should I help them?">​</a></h2><p>Web caching is one of the most misunderstood technologies on the Internet. Webmasters in particular fear losing control of their site, because a proxy cache can “hide” their users from them, making it difficult to see who’s using the site.</p><p>Unfortunately for them, even if Web caches didn’t exist, there are too many variables on the Internet to assure that they’ll be able to get an accurate picture of how users see their site. If this is a big concern for you, this tutorial will teach you how to get the statistics you need without making your site cache-unfriendly.</p><p>Another concern is that caches can serve content that is out of date, or stale. However, this tutorial can show you how to configure your server to control how your content is cached.</p><blockquote><p>CDNs are an interesting development, because unlike many proxy caches, their gateway caches are aligned with the interests of the Web site being cached, so that these problems aren’t seen. However, even when you use a CDN, you still have to consider that there will be proxy and browser caches downstream.</p></blockquote><p>On the other hand, if you plan your site well, caches can help your Web site load faster, and save load on your server and Internet link. The difference can be dramatic; a site that is difficult to cache may take several seconds to load, while one that takes advantage of caching can seem instantaneous in comparison. Users will appreciate a fast-loading site, and will visit more often.</p><p>Think of it this way; many large Internet companies are spending millions of dollars setting up farms of servers around the world to replicate their content, in order to make it as fast to access as possible for their users. Caches do the same for you, and they’re even closer to the end user. Best of all, you don’t have to pay for them.</p><p>The fact is that proxy and browser caches will be used whether you like it or not. If you don’t configure your site to be cached correctly, it will be cached using whatever defaults the cache’s administrator decides upon.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="how-web-caches-work">How Web Caches Work<a href="#how-web-caches-work" class="hash-link" aria-label="Direct link to How Web Caches Work" title="Direct link to How Web Caches Work">​</a></h2><p>All caches have a set of rules that they use to determine when to serve a representation from the cache, if it’s available. Some of these rules are set in the protocols (HTTP 1.0 and 1.1), and some are set by the administrator of the cache (either the user of the browser cache, or the proxy administrator).</p><p>Generally speaking, these are the most common rules that are followed (don’t worry if you don’t understand the details, it will be explained below):</p><ul><li>If the response’s headers tell the cache not to keep it, it won’t.</li><li>If the request is authenticated or secure (i.e., HTTPS), it won’t be cached by shared caches.</li><li>A cached representation is considered fresh (that is, able to be sent to a client without checking with the origin server) if:<ul><li>It has an expiry time or other age-controlling header set, and is still within the fresh period, or</li><li>If the cache has seen the representation recently, and it was modified relatively long ago.</li><li>Fresh representations are served directly from the cache, without checking with the origin server.</li></ul></li><li>If a representation is stale, the origin server will be asked to validate it, or tell the cache whether the copy that it has is still good.</li><li>Under certain circumstances — for example, when it’s disconnected from a network — a cache can serve stale responses without checking with the origin server.</li></ul><p>If no validator (an <code>ETag</code> or <code>Last-Modified</code> header) is present on a response, <em>and</em> it doesn&#x27;t have any explicit freshness information, it will usually — but not always — be considered uncacheable.</p><p>Together, freshness and validation are the most important ways that a cache works with content. A fresh representation will be available instantly from the cache, while a validated representation will avoid sending the entire representation over again if it hasn’t changed.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="how-and-how-not-to-control-caches">How (and how not) to Control Caches<a href="#how-and-how-not-to-control-caches" class="hash-link" aria-label="Direct link to How (and how not) to Control Caches" title="Direct link to How (and how not) to Control Caches">​</a></h2><p>There are several tools that Web designers and Webmasters can use to fine-tune how caches will treat their sites. It may require getting your hands a little dirty with your server’s configuration, but the results are worth it. For details on how to use these tools with your server, see the <a href="https://www.mnot.net/cache_docs/#IMP-SERVER" target="_blank" rel="noopener noreferrer">Implementation</a> sections below.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="html-meta-tags-and-http-headers">HTML Meta Tags and HTTP Headers<a href="#html-meta-tags-and-http-headers" class="hash-link" aria-label="Direct link to HTML Meta Tags and HTTP Headers" title="Direct link to HTML Meta Tags and HTTP Headers">​</a></h2><p>HTML authors can put tags in a document’s <code>&lt;HEAD&gt;</code> section that describe its attributes. These <em>meta tags</em> are often used in the belief that they can mark a document as uncacheable, or expire it at a certain time.</p><p>Meta tags are easy to use, but aren’t very effective. That’s because they’re only honored by a few browser caches, not proxy caches (which almost never read the HTML in the document). While it may be tempting to put a Pragma: no-cache meta tag into a Web page, it won’t necessarily cause it to be kept fresh.</p><blockquote><p>If your site is hosted at an ISP or hosting farm and they don’t give you the ability to set arbitrary HTTP headers (like <code>Expires</code> and <code>Cache-Control</code>), complain loudly; these are tools necessary for doing your job.</p></blockquote><p>On the other hand, true <em>HTTP</em> headers give you a lot of control over how both browser caches and proxies handle your representations. They can’t be seen in the HTML, and are usually automatically generated by the Web server. However, you can control them to some degree, depending on the server you use. In the following sections, you’ll see what HTTP headers are interesting, and how to apply them to your site.</p><p>HTTP headers are sent by the server before the HTML, and only seen by the browser and any intermediate caches. Typical HTTP 1.1 response headers might look like this:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">HTTP/1.1 200 OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Date: Fri, 30 Oct 1998 13:19:41 GMT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Server: Apache/1.3.3 (Unix)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cache-Control: max-age=3600, must-revalidate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Expires: Fri, 30 Oct 1998 14:19:41 GMT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Last-Modified: Mon, 29 Jun 1998 02:28:12 GMT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ETag: &quot;3e86-410-3596fbbc&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Length: 1040</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type: text/html</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The HTML would follow these headers, separated by a blank line. See the <a href="https://www.mnot.net/cache_docs/#IMP-SERVER" target="_blank" rel="noopener noreferrer">Implementation</a> sections for information about how to set HTTP headers.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="pragma-http-headers-and-why-they-dont-work">Pragma HTTP Headers (and why they don’t work)<a href="#pragma-http-headers-and-why-they-dont-work" class="hash-link" aria-label="Direct link to Pragma HTTP Headers (and why they don’t work)" title="Direct link to Pragma HTTP Headers (and why they don’t work)">​</a></h2><p>Many people believe that assigning a Pragma: no-cache HTTP header to a representation will make it uncacheable. This is not necessarily true; the HTTP specification does not set any guidelines for Pragma response headers; instead, Pragma request headers (the headers that a browser sends to a server) are discussed. Although a few caches may honor this header, the majority won’t, and it won’t have any effect. Use the headers below instead.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="controlling-freshness-with-the-expires-http-header">Controlling Freshness with the Expires HTTP Header<a href="#controlling-freshness-with-the-expires-http-header" class="hash-link" aria-label="Direct link to Controlling Freshness with the Expires HTTP Header" title="Direct link to Controlling Freshness with the Expires HTTP Header">​</a></h2><p>The Expires HTTP header is a basic means of controlling caches; it tells all caches how long the associated representation is fresh for. After that time, caches will always check back with the origin server to see if a document is changed. Expires headers are supported by practically every cache.</p><p>Most Web servers allow you to set Expires response headers in a number of ways. Commonly, they will allow setting an absolute time to expire, a time based on the last time that the client retrieved the representation (last access time), or a time based on the last time the document changed on your server (last <em>modification time</em>).</p><p>Expires headers are especially good for making static images (like navigation bars and buttons) cacheable. Because they don’t change much, you can set extremely long expiry time on them, making your site appear much more responsive to your users. They’re also useful for controlling caching of a page that is regularly changed. For instance, if you update a news page once a day at 6am, you can set the representation to expire at that time, so caches will know when to get a fresh copy, without users having to hit ‘reload’.</p><p>The <strong>only</strong> value valid in an Expires header is a HTTP date; anything else will most likely be interpreted as ‘in the past’, so that the representation is uncacheable. Also, remember that the time in a HTTP date is Greenwich Mean Time (GMT), not local time.</p><p>For example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Expires: Fri, 30 Oct 1998 14:19:41 GMT</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>It’s important to make sure that your Web server’s clock is accurate if you use the <code>Expires</code> header. One way to do this is using the <a href="http://www.ntp.org/" target="_blank" rel="noopener noreferrer">Network Time Protocol</a> (NTP); talk to your local system administrator to find out more.</p></blockquote><p>Although the <code>Expires</code> header is useful, it has some limitations. First, because there’s a date involved, the clocks on the Web server and the cache must be synchronised; if they have a different idea of the time, the intended results won’t be achieved, and caches might wrongly consider stale content as fresh.</p><p>Another problem with <code>Expires</code> is that it’s easy to forget that you’ve set some content to expire at a particular time. If you don’t update an <code>Expires</code> time before it passes, each and every request will go back to your Web server, increasing load and latency.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cache-control-http-headers">Cache-Control HTTP Headers<a href="#cache-control-http-headers" class="hash-link" aria-label="Direct link to Cache-Control HTTP Headers" title="Direct link to Cache-Control HTTP Headers">​</a></h2><p>HTTP 1.1 introduced a new class of headers, Cache-Control response headers, to give Web publishers more control over their content, and to address the limitations of Expires.</p><p>Useful <code>Cache-Control</code> response headers include:</p><ul><li><code>max-age=</code>[seconds]<!-- --> — specifies the maximum amount of time that a representation will be considered fresh. Similar to <code>Expires</code>, this directive is relative to the time of the request, rather than absolute. <code>[seconds]</code> is the number of seconds from the time of the request you wish the representation to be fresh for.</li><li><code>s-maxage=</code>[seconds]<!-- --> — similar to <code>max-age</code>, except that it only applies to shared (e.g., proxy) caches.</li><li><code>public</code> — marks authenticated responses as cacheable; normally, if HTTP authentication is required, responses are automatically private.</li><li><code>private</code> — allows caches that are specific to one user (e.g., in a browser) to store the response; shared caches (e.g., in a proxy) may not.</li><li><code>no-cache</code> — forces caches to submit the request to the origin server for validation before releasing a cached copy, every time. This is useful to assure that authentication is respected (in combination with public), or to maintain rigid freshness, without sacrificing all of the benefits of caching.</li><li><code>no-store</code> — instructs caches not to keep a copy of the representation under any conditions.</li><li><code>must-revalidate</code> — tells caches that they must obey any freshness information you give them about a representation. HTTP allows caches to serve stale representations under special conditions; by specifying this header, you’re telling the cache that you want it to strictly follow your rules.</li><li><code>proxy-revalidate</code> — similar to <code>must-revalidate</code>, except that it only applies to proxy caches.</li></ul><p>For example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Cache-Control: max-age=3600, must-revalidate</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When both <code>Cache-Control</code> and <code>Expires</code> are present, <code>Cache-Control</code> takes precedence. If you plan to use the <code>Cache-Control</code> headers, you should have a look at the excellent documentation in HTTP 1.1; see <a href="https://www.mnot.net/cache_docs/#REF" target="_blank" rel="noopener noreferrer">References and Further Information</a>.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="validators-and-validation">Validators and Validation<a href="#validators-and-validation" class="hash-link" aria-label="Direct link to Validators and Validation" title="Direct link to Validators and Validation">​</a></h2><p>In <a href="https://www.mnot.net/cache_docs/#WORK" target="_blank" rel="noopener noreferrer">How Web Caches Work</a>, we said that validation is used by servers and caches to communicate when a representation has changed. By using it, caches avoid having to download the entire representation when they already have a copy locally, but they’re not sure if it’s still fresh.</p><p>Validators are very important; if one isn’t present, and there isn’t any freshness information (<code>Expires</code> or <code>Cache-Control</code>) available, caches will not store a representation at all.</p><p>The most common validator is the time that the document last changed, as communicated in <code>Last-Modified</code> header. When a cache has a representation stored that includes a <code>Last-Modified</code> header, it can use it to ask the server if the representation has changed since the last time it was seen, with an <code>If-Modified-Since</code> request.</p><p>HTTP 1.1 introduced a new kind of validator called the <code>ETag</code>. ETags are unique identifiers that are generated by the server and changed every time the representation does. Because the server controls how the ETag is generated, caches can be sure that if the ETag matches when they make a <code>If-None-Match</code> request, the representation really is the same.</p><p>Almost all caches use Last-Modified times as validators; ETag validation is also becoming prevalent.</p><p>Most modern Web servers will generate both <code>ETag</code> and <code>Last-Modified</code> headers to use as validators for static content (i.e., files) automatically; you won’t have to do anything. However, they don’t know enough about dynamic content (like CGI, ASP or database sites) to generate them; see <a href="https://www.mnot.net/cache_docs/#SCRIPT" target="_blank" rel="noopener noreferrer">Writing Cache-Aware Scripts</a>.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="tips-for-building-a-cache-aware-site">Tips for Building a Cache-Aware Site<a href="#tips-for-building-a-cache-aware-site" class="hash-link" aria-label="Direct link to Tips for Building a Cache-Aware Site" title="Direct link to Tips for Building a Cache-Aware Site">​</a></h2><p>Besides using freshness information and validation, there are a number of other things you can do to make your site more cache-friendly.</p><ul><li>Use URLs consistently — this is the golden rule of caching. If you serve the same content on different pages, to different users, or from different sites, it should use the same URL. This is the easiest and most effective way to make your site cache-friendly. For example, if you use “/index.html” in your HTML as a reference once, always use it that way.</li><li>Use a common library of images and other elements and refer back to them from different places.</li><li>Make caches store images and pages that don’t change often by using a Cache-Control: max-age header with a large value.</li><li>Make caches recognise regularly updated pages by specifying an appropriate max-age or expiration time.</li><li>If a resource (especially a downloadable file) changes, change its name. That way, you can make it expire far in the future, and still guarantee that the correct version is served; the page that links to it is the only one that will need a short expiry time.</li><li>Don’t change files unnecessarily. If you do, everything will have a falsely young Last-Modified date. For instance, when updating your site, don’t copy over the entire site; just move the files that you’ve changed.</li><li>Use cookies only where necessary — cookies are difficult to cache, and aren’t needed in most situations. If you must use a cookie, limit its use to dynamic pages.</li><li>Check your pages with <a href="https://redbot.org/" target="_blank" rel="noopener noreferrer">REDbot</a> — it can help you apply many of the concepts in this tutorial.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="writing-cache-aware-scripts">Writing Cache-Aware Scripts<a href="#writing-cache-aware-scripts" class="hash-link" aria-label="Direct link to Writing Cache-Aware Scripts" title="Direct link to Writing Cache-Aware Scripts">​</a></h2><p>By default, most scripts won’t return a validator (a <code>Last-Modified</code> or <code>ETag</code> response header) or freshness information (<code>Expires</code> or <code>Cache-Control</code>). While some scripts really are dynamic (meaning that they return a different response for every request), many (like search engines and database-driven sites) can benefit from being cache-friendly.</p><p>Generally speaking, if a script produces output that is reproducible with the same request at a later time (whether it be minutes or days later), it should be cacheable. If the content of the script changes only depending on what’s in the URL, it is cacheable; if the output depends on a cookie, authentication information or other external criteria, it probably isn’t.</p><ul><li>The best way to make a script cache-friendly (as well as perform better) is to dump its content to a plain file whenever it changes. The Web server can then treat it like any other Web page, generating and using validators, which makes your life easier. Remember to only write files that have changed, so the <code>Last-Modified</code> times are preserved.</li><li>Another way to make a script cacheable in a limited fashion is to set an age-related header for as far in the future as practical. Although this can be done with <code>Expires</code>, it’s probably easiest to do so with <code>Cache-Control: max-age</code>, which will make the request fresh for an amount of time after the request.</li><li>If you can’t do that, you’ll need to make the script generate a validator, and then respond to <code>If-Modified-Since</code> and/or <code>If-None-Match</code> requests. This can be done by parsing the HTTP headers, and then responding with <code>304 Not Modified</code> when appropriate. Unfortunately, this is not a trival task.</li></ul><p>Some other tips;</p><ul><li><strong>Don’t use POST</strong> unless it’s appropriate. Responses to the POST method aren’t kept by most caches; if you send information in the path or query (via GET), caches can store that information for the future.</li><li><strong>Don’t embed user-specific information in the URL</strong> unless the content generated is completely unique to that user.</li><li><strong>Don’t count on all requests from a user coming from the same host</strong>, because caches often work together.</li><li><strong>Generate <code>Content-Length</code> response headers</strong>. It’s easy to do, and it will allow the response of your script to be used in a <em>persistent connection</em>. This allows clients to request multiple representations on one TCP/IP connection, instead of setting up a connection for every request. It makes your site seem much faster.</li></ul><p>See the <a href="https://www.mnot.net/cache_docs/#IMP-SCRIPT" target="_blank" rel="noopener noreferrer">Implementation Notes</a> for more specific information.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="frequently-asked-questions">Frequently Asked Questions<a href="#frequently-asked-questions" class="hash-link" aria-label="Direct link to Frequently Asked Questions" title="Direct link to Frequently Asked Questions">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="what-are-the-most-important-things-to-make-cacheable">What are the most important things to make cacheable?<a href="#what-are-the-most-important-things-to-make-cacheable" class="hash-link" aria-label="Direct link to What are the most important things to make cacheable?" title="Direct link to What are the most important things to make cacheable?">​</a></h3><p>A good strategy is to identify the most popular, largest representations (especially images) and work with them first.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="how-can-i-make-my-pages-as-fast-as-possible-with-caches">How can I make my pages as fast as possible with caches?<a href="#how-can-i-make-my-pages-as-fast-as-possible-with-caches" class="hash-link" aria-label="Direct link to How can I make my pages as fast as possible with caches?" title="Direct link to How can I make my pages as fast as possible with caches?">​</a></h3><p>The most cacheable representation is one with a long freshness time set. Validation does help reduce the time that it takes to see a representation, but the cache still has to contact the origin server to see if it’s fresh. If the cache already knows it’s fresh, it will be served directly.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="i-understand-that-caching-is-good-but-i-need-to-keep-statistics-on-how-many-people-visit-my-page">I understand that caching is good, but I need to keep statistics on how many people visit my page!<a href="#i-understand-that-caching-is-good-but-i-need-to-keep-statistics-on-how-many-people-visit-my-page" class="hash-link" aria-label="Direct link to I understand that caching is good, but I need to keep statistics on how many people visit my page!" title="Direct link to I understand that caching is good, but I need to keep statistics on how many people visit my page!">​</a></h3><p>If you must know every time a page is accessed, select ONE small item on a page (or the page itself), and make it uncacheable, by giving it a suitable headers. For example, you could refer to a 1x1 transparent uncacheable image from each page. The Referer header will contain information about what page called it.</p><p>Be aware that even this will not give truly accurate statistics about your users, and is unfriendly to the Internet and your users; it generates unnecessary traffic, and forces people to wait for that uncached item to be downloaded. For more information about this, see On Interpreting Access Statistics in the <a href="https://www.mnot.net/cache_docs/#REF" target="_blank" rel="noopener noreferrer">references</a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="how-can-i-see-a-representations-http-headers">How can I see a representation’s HTTP headers?<a href="#how-can-i-see-a-representations-http-headers" class="hash-link" aria-label="Direct link to How can I see a representation’s HTTP headers?" title="Direct link to How can I see a representation’s HTTP headers?">​</a></h3><p>Many Web browsers let you see the <code>Expires</code> and <code>Last-Modified</code> headers are in a “page info” or similar interface. If available, this will give you a menu of the page and any representations (like images) associated with it, along with their details.</p><p>To see the full headers of a representation, you can manually connect to the Web server using a Telnet client.</p><p>To do so, you may need to type the port (be default, 80) into a separate field, or you may need to connect to <code>www.example.com:80</code> or <code>www.example.com 80</code> (note the space). Consult your Telnet client’s documentation.</p><p>Once you’ve opened a connection to the site, type a request for the representation. For instance, if you want to see the headers for <a href="http://www.example.com/foo.html" target="_blank" rel="noopener noreferrer">http://www.example.com/foo.html</a>, connect to <a href="http://www.example.com" target="_blank" rel="noopener noreferrer">www.example.com</a>, port 80, and type:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET /foo.html HTTP/1.1 [return]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Host: www.example.com [return][return]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Press the Return key every time you see <code>[return];</code> make sure to press it twice at the end. This will print the headers, and then the full representation. To see the headers only, substitute HEAD for GET.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="my-pages-are-password-protected-how-do-proxy-caches-deal-with-them">My pages are password-protected; how do proxy caches deal with them?<a href="#my-pages-are-password-protected-how-do-proxy-caches-deal-with-them" class="hash-link" aria-label="Direct link to My pages are password-protected; how do proxy caches deal with them?" title="Direct link to My pages are password-protected; how do proxy caches deal with them?">​</a></h3><p>By default, pages protected with HTTP authentication are considered private; they will not be kept by shared caches. However, you can make authenticated pages public with a Cache-Control: public header; HTTP 1.1-compliant caches will then allow them to be cached.</p><p>If you’d like such pages to be cacheable, but still authenticated for every user, combine the <code>Cache-Control: public</code> and <code>no-cache</code> headers. This tells the cache that it must submit the new client’s authentication information to the origin server before releasing the representation from the cache. This would look like:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Cache-Control: public, no-cache</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Whether or not this is done, it’s best to minimize use of authentication; for example, if your images are not sensitive, put them in a separate directory and configure your server not to force authentication for it. That way, those images will be naturally cacheable.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="should-i-worry-about-security-if-people-access-my-site-through-a-cache">Should I worry about security if people access my site through a cache?<a href="#should-i-worry-about-security-if-people-access-my-site-through-a-cache" class="hash-link" aria-label="Direct link to Should I worry about security if people access my site through a cache?" title="Direct link to Should I worry about security if people access my site through a cache?">​</a></h3><p><code>https://</code> pages are not cached (or decrypted) by proxy caches, so you don’t have to worry about that. However, because caches store <code>http:// </code>responses and URLs fetched through them, you should be conscious about unsecured sites; an unscrupulous administrator could conceivably gather information about their users, especially in the URL.</p><p>In fact, any administrator on the network between your server and your clients could gather this type of information. One particular problem is when CGI scripts put usernames and passwords in the URL itself; this makes it trivial for others to find and use their login.</p><p>If you’re aware of the issues surrounding Web security in general, you shouldn’t have any surprises from proxy caches.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="im-looking-for-an-integrated-web-publishing-solution-which-ones-are-cache-aware">I’m looking for an integrated Web publishing solution. Which ones are cache-aware?<a href="#im-looking-for-an-integrated-web-publishing-solution-which-ones-are-cache-aware" class="hash-link" aria-label="Direct link to I’m looking for an integrated Web publishing solution. Which ones are cache-aware?" title="Direct link to I’m looking for an integrated Web publishing solution. Which ones are cache-aware?">​</a></h3><p>It varies. Generally speaking, the more complex a solution is, the more difficult it is to cache. The worst are ones which dynamically generate all content and don’t provide validators; they may not be cacheable at all. Speak with your vendor’s technical staff for more information, and see the Implementation notes below.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="my-images-expire-a-month-from-now-but-i-need-to-change-them-in-the-caches-now">My images expire a month from now, but I need to change them in the caches now!<a href="#my-images-expire-a-month-from-now-but-i-need-to-change-them-in-the-caches-now" class="hash-link" aria-label="Direct link to My images expire a month from now, but I need to change them in the caches now!" title="Direct link to My images expire a month from now, but I need to change them in the caches now!">​</a></h3><p>The Expires header can’t be circumvented; unless the cache (either browser or proxy) runs out of room and has to delete the representations, the cached copy will be used until then.</p><p>The most effective solution is to change any links to them; that way, completely new representations will be loaded fresh from the origin server. Remember that any page that refers to these representations will be cached as well. Because of this, it’s best to make static images and similar representations very cacheable, while keeping the HTML pages that refer to them on a tight leash.</p><p>If you want to reload a representation from a specific cache, you can either force a reload (in Firefox, holding down shift while pressing ‘reload’ will do this by issuing a Pragma: no-cache request header) while using the cache. Or, you can have the cache administrator delete the representation through their interface.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="i-run-a-web-hosting-service-how-can-i-let-my-users-publish-cache-friendly-pages">I run a Web Hosting service. How can I let my users publish cache-friendly pages?<a href="#i-run-a-web-hosting-service-how-can-i-let-my-users-publish-cache-friendly-pages" class="hash-link" aria-label="Direct link to I run a Web Hosting service. How can I let my users publish cache-friendly pages?" title="Direct link to I run a Web Hosting service. How can I let my users publish cache-friendly pages?">​</a></h3><p>If you’re using Apache, consider allowing them to use .htaccess files and providing appropriate documentation.</p><p>Otherwise, you can establish predetermined areas for various caching attributes in each virtual server. For instance, you could specify a directory /cache-1m that will be cached for one month after access, and a /no-cache area that will be served with headers instructing caches not to store representations from it.</p><p>Whatever you are able to do, it is best to work with your largest customers first on caching. Most of the savings (in bandwidth and in load on your servers) will be realized from high-volume sites.
I’ve marked my pages as cacheable, but my browser keeps requesting them on every request. How do I force the cache to keep representations of them?</p><p>Caches aren’t required to keep a representation and reuse it; they’re only required to not keep or use them under some conditions. All caches make decisions about which representations to keep based upon their size, type (e.g., image vs. html), or by how much space they have left to keep local copies. Yours may not be considered worth keeping around, compared to more popular or larger representations.</p><p>Some caches do allow their administrators to prioritize what kinds of representations are kept, and some allow representations to be “pinned” in cache, so that they’re always available.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="implementation-notes--web-servers">Implementation Notes — Web Servers<a href="#implementation-notes--web-servers" class="hash-link" aria-label="Direct link to Implementation Notes — Web Servers" title="Direct link to Implementation Notes — Web Servers">​</a></h3><p>Generally speaking, it’s best to use the latest version of whatever Web server you’ve chosen to deploy. Not only will they likely contain more cache-friendly features, new versions also usually have important security and performance improvements.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="apache-http-server">Apache HTTP Server<a href="#apache-http-server" class="hash-link" aria-label="Direct link to Apache HTTP Server" title="Direct link to Apache HTTP Server">​</a></h3><p>Apache uses optional modules to include headers, including both Expires and Cache-Control. Both modules are available in the 1.2 or greater distribution.</p><p>The modules need to be built into Apache; although they are included in the distribution, they are not turned on by default. To find out if the modules are enabled in your server, find the httpd binary and run httpd -l; this should print a list of the available modules (note that this only lists compiled-in modules; on later versions of Apache, use httpd -M to include dynamically loaded modules as well). The modules we’re looking for are expires_module and headers_module.</p><ul><li>If they aren’t available, and you have administrative access, you can recompile Apache to include them. This can be done either by uncommenting the appropriate lines in the Configuration file, or using the <code>-enable-module=expires</code> and -enable-module=headers arguments to configure (1.3 or greater). Consult the INSTALL file found with the Apache distribution.</li></ul><p>Once you have an Apache with the appropriate modules, you can use mod_expires to specify when representations should expire, either in .htaccess files or in the server’s access.conf file. You can specify expiry from either access or modification time, and apply it to a file type or as a default. See the module documentation for more information, and speak with your local Apache guru if you have trouble.</p><p>To apply Cache-Control headers, you’ll need to use the mod_headers module, which allows you to specify arbitrary HTTP headers for a resource. See the <a href="http://www.apache.org/docs/mod/mod_expires.html" target="_blank" rel="noopener noreferrer">mod_headers documentation</a>.</p><p>Here’s an example .htaccess file that demonstrates the use of some headers.</p><ul><li><code>.htaccess</code> files allow web publishers to use commands normally only found in configuration files. They affect the content of the directory they’re in and their subdirectories. Talk to your server administrator to find out if they’re enabled.</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">### activate mod_expires</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ExpiresActive On</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Expire .gif&#x27;s 1 month from when they&#x27;re accessed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ExpiresByType image/gif A2592000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Expire everything else 1 day from when it&#x27;s last modified</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### (this uses the Alternative syntax)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ExpiresDefault &quot;modification plus 1 day&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Apply a Cache-Control header to index.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;Files index.html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Header append Cache-Control &quot;public, must-revalidate&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/Files&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Note that mod_expires automatically calculates and inserts a <code>Cache-Control:max-age</code> header as appropriate.</li></ul><p>Apache 2’s configuration is very similar to that of 1.3; see the 2.2 <a href="http://httpd.apache.org/docs/2.2/mod/mod_expires.html" target="_blank" rel="noopener noreferrer">mod_expires</a> and <a href="http://httpd.apache.org/docs/2.2/mod/mod_headers.html" target="_blank" rel="noopener noreferrer">mod_headers</a> documentation for more information.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="microsoft-iis">Microsoft IIS<a href="#microsoft-iis" class="hash-link" aria-label="Direct link to Microsoft IIS" title="Direct link to Microsoft IIS">​</a></h2><p>Microsoft’s Internet Information Server makes it very easy to set headers in a somewhat flexible way. Note that this is only possible in version 4 of the server, which will run only on NT Server.</p><p>To specify headers for an area of a site, select it in the Administration Tools interface, and bring up its properties. After selecting the HTTP Headers tab, you should see two interesting areas; Enable Content Expiration and Custom HTTP headers. The first should be self-explanatory, and the second can be used to apply Cache-Control headers.</p><p>See the ASP section below for information about setting headers in Active Server Pages. It is also possible to set headers from ISAPI modules; refer to MSDN for details.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="netscapeiplanet-enterprise-server">Netscape/iPlanet Enterprise Server<a href="#netscapeiplanet-enterprise-server" class="hash-link" aria-label="Direct link to Netscape/iPlanet Enterprise Server" title="Direct link to Netscape/iPlanet Enterprise Server">​</a></h2><p>As of version 3.6, Enterprise Server does not provide any obvious way to set Expires headers. However, it has supported HTTP 1.1 features since version 3.0. This means that HTTP 1.1 caches (proxy and browser) will be able to take advantage of Cache-Control settings you make.</p><p>To use Cache-Control headers, choose Content Management | Cache Control Directives in the administration server. Then, using the Resource Picker, choose the directory where you want to set the headers. After setting the headers, click ‘OK’. For more information, see the NES manual.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="implementation-notes--server-side-scripting">Implementation Notes — Server-Side Scripting<a href="#implementation-notes--server-side-scripting" class="hash-link" aria-label="Direct link to Implementation Notes — Server-Side Scripting" title="Direct link to Implementation Notes — Server-Side Scripting">​</a></h2><blockquote><p>One thing to keep in mind is that it may be easier to set HTTP headers with your Web server rather than in the scripting language. Try both.</p></blockquote><p>Because the emphasis in server-side scripting is on dynamic content, it doesn’t make for very cacheable pages, even when the content could be cached. If your content changes often, but not on every page hit, consider setting a Cache-Control: max-age header; most users access pages again in a relatively short period of time. For instance, when users hit the ‘back’ button, if there isn’t any validator or freshness information available, they’ll have to wait until the page is re-downloaded from the server to see it.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cgi">CGI<a href="#cgi" class="hash-link" aria-label="Direct link to CGI" title="Direct link to CGI">​</a></h2><p>CGI scripts are one of the most popular ways to generate content. You can easily append HTTP response headers by adding them before you send the body; Most CGI implementations already require you to do this for the Content-Type header. For instance, in Perl;</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/usr/bin/perl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print &quot;Content-type: text/html\n&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print &quot;Expires: Thu, 29 Oct 1998 17:04:19 GMT\n&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print &quot;\n&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### the content body follows...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Since it’s all text, you can easily generate Expires and other date-related headers with in-built functions. It’s even easier if you use Cache-Control: max-age;</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">print &quot;Cache-Control: max-age=600\n&quot;;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This will make the script cacheable for 10 minutes after the request, so that if the user hits the ‘back’ button, they won’t be resubmitting the request.</p><p>The CGI specification also makes request headers that the client sends available in the environment of the script; each header has ‘HTTP_’ prepended to its name. So, if a client makes an If-Modified-Since request, it will show up as HTTP_IF_MODIFIED_SINCE.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="server-side-includes">Server Side Includes<a href="#server-side-includes" class="hash-link" aria-label="Direct link to Server Side Includes" title="Direct link to Server Side Includes">​</a></h2><p>SSI (often used with the extension .shtml) is one of the first ways that Web publishers were able to get dynamic content into pages. By using special tags in the pages, a limited form of in-HTML scripting was available.</p><p>Most implementations of SSI do not set validators, and as such are not cacheable. However, Apache’s implementation does allow users to specify which SSI files can be cached, by setting the group execute permissions on the appropriate files, combined with the XbitHack full directive. For more information, see the mod_include documentation.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="php">PHP<a href="#php" class="hash-link" aria-label="Direct link to PHP" title="Direct link to PHP">​</a></h3><p>PHP is a server-side scripting language that, when built into the server, can be used to embed scripts inside a page’s HTML, much like SSI, but with a far larger number of options. PHP can be used as a CGI script on any Web server (Unix or Windows), or as an Apache module.</p><p>By default, representations processed by PHP are not assigned validators, and are therefore uncacheable. However, developers can set HTTP headers by using the Header() function.</p><p>For example, this will create a Cache-Control header, as well as an Expires header three days in the future:</p><div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;?php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Header(&quot;Cache-Control: must-revalidate&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $offset = 60 * 60 * 24 * 3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $ExpStr = &quot;Expires: &quot; . gmdate(&quot;D, d M Y H:i:s&quot;, time() + $offset) . &quot; GMT&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Header($ExpStr);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">?&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Remember that the Header() function MUST come before any other output.</p><p>As you can see, you’ll have to create the HTTP date for an Expires header by hand; PHP doesn’t provide a function to do it for you (although recent versions have made it easier; see the PHP&#x27;s date documentation). Of course, it’s easy to set a Cache-Control: max-age header, which is just as good for most situations.</p><p>For more information, see the manual entry for header.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cold-fusion">Cold Fusion<a href="#cold-fusion" class="hash-link" aria-label="Direct link to Cold Fusion" title="Direct link to Cold Fusion">​</a></h3><p>Cold Fusion, by Macromedia is a commercial server-side scripting engine, with support for several Web servers on Windows, Linux and several flavors of Unix.</p><p>Cold Fusion makes setting arbitrary HTTP headers relatively easy, with the CFHEADER tag. Unfortunately, their example for setting an Expires header, as below, is a bit misleading.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;CFHEADER NAME=&quot;Expires&quot; VALUE=&quot;#Now()#&quot;&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It doesn’t work like you might think, because the time (in this case, when the request is made) doesn’t get converted to a HTTP-valid date; instead, it just gets printed as a representation of Cold Fusion’s Date/Time object. Most clients will either ignore such a value, or convert it to a default, like January 1, 1970.</p><p>However, Cold Fusion does provide a date formatting function that will do the job; GetHttpTimeString. In combination with DateAdd, it’s easy to set Expires dates; here, we set a header to declare that representations of the page expire in one month;</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;cfheader name=&quot;Expires&quot; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  value=&quot;#GetHttpTimeString(DateAdd(&#x27;m&#x27;, 1, Now()))#&quot;&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can also use the CFHEADER tag to set Cache-Control: max-age and other headers.</p><p>Remember that Web server headers are passed through in some deployments of Cold Fusion (such as CGI); check yours to determine whether you can use this to your advantage, by setting headers on the server instead of in Cold Fusion.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="asp-and-aspnet">ASP and ASP.NET<a href="#asp-and-aspnet" class="hash-link" aria-label="Direct link to ASP and ASP.NET" title="Direct link to ASP and ASP.NET">​</a></h3><p>When setting HTTP headers from ASPs, make sure you either place the Response method calls before any HTML generation, or use Response.Buffer to buffer the output. Also, note that some versions of IIS set a Cache-Control: private header on ASPs by default, and must be declared public to be cacheable by shared caches.</p><p>Active Server Pages, built into IIS and also available for other Web servers, also allows you to set HTTP headers. For instance, to set an expiry time, you can use the properties of the Response object;</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;% Response.Expires=1440 %&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>specifying the number of minutes from the request to expire the representation. <code>Cache-Control</code> headers can be added like this:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;% Response.CacheControl=&quot;public&quot; %&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In ASP.NET, Response.Expires is deprecated; the proper way to set cache-related headers is with Response.Cache;</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Response.Cache.SetExpires ( DateTime.Now.AddMinutes ( 60 ) ) ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Response.Cache.SetCacheability ( HttpCacheability.Public ) ;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="references-and-further-information">References and Further Information<a href="#references-and-further-information" class="hash-link" aria-label="Direct link to References and Further Information" title="Direct link to References and Further Information">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="http-11-specification"><a href="http://www.ietf.org/rfc/rfc2616.txt" target="_blank" rel="noopener noreferrer">HTTP 1.1 Specification</a><a href="#http-11-specification" class="hash-link" aria-label="Direct link to http-11-specification" title="Direct link to http-11-specification">​</a></h3><p>The HTTP 1.1 spec has many extensions for making pages cacheable, and is the authoritative guide to implementing the protocol. See sections 13, 14.9, 14.21, and 14.25.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="web-cachingcom"><a href="http://www.web-caching.com/" target="_blank" rel="noopener noreferrer">Web-Caching.com</a><a href="#web-cachingcom" class="hash-link" aria-label="Direct link to web-cachingcom" title="Direct link to web-cachingcom">​</a></h3><p>An excellent introduction to caching concepts, with links to other online resources.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="on-interpreting-access-statistics"><a href="http://www.goldmark.org/netrants/webstats/" target="_blank" rel="noopener noreferrer">On Interpreting Access Statistics</a><a href="#on-interpreting-access-statistics" class="hash-link" aria-label="Direct link to on-interpreting-access-statistics" title="Direct link to on-interpreting-access-statistics">​</a></h3><p>Jeff Goldberg’s informative rant on why you shouldn’t rely on access statistics and hit counters.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="redbot"><a href="https://redbot.org/" target="_blank" rel="noopener noreferrer">REDbot</a><a href="#redbot" class="hash-link" aria-label="Direct link to redbot" title="Direct link to redbot">​</a></h3><p>Examines HTTP resources to determine how they will interact with Web caches, and generally how well they use the protocol.
About This Document</p><p>This document is Copyright © 1998-2013 Mark Nottingham <em><a href="mailto:mnot@mnot.net" target="_blank" rel="noopener noreferrer">mnot@mnot.net</a></em>. This work is licensed under a Creative Commons Attribution-Noncommercial-No Derivative Works 3.0 Unported License.</p><p>All trademarks within are property of their respective holders.</p><p>Although the author believes the contents to be accurate at the time of publication, no liability is assumed for them, their application or any consequences thereof. If any misrepresentations, errors or other need for clarification is found, please contact the author immediately.</p><p>The latest revision of this document can always be obtained from <a href="https://www.mnot.net/cache_docs/" target="_blank" rel="noopener noreferrer">https://www.mnot.net/cache_docs/</a></p><p>Translations are available in: Chinese, Czech, German, and French.</p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/http">HTTP</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/cache">Cache</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/cdn">CDN</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/alanwei43/blog/tree/master/src/blog/2022/08/21-cache-docs.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/2022/09/04/fix-nuxt-node-fs-resolver-problem"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">解决nuxt依赖Node原生模块导致构建失败问题</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/2022/07/21/graphql-intro"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">GraphQL 项目搭建</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#whats-a-web-cache-why-do-people-use-them" class="table-of-contents__link toc-highlight">What’s a Web Cache? Why do people use them?</a></li><li><a href="#kinds-of-web-caches" class="table-of-contents__link toc-highlight">Kinds of Web Caches</a><ul><li><a href="#browser-caches" class="table-of-contents__link toc-highlight">Browser Caches</a></li><li><a href="#proxy-caches" class="table-of-contents__link toc-highlight">Proxy Caches</a></li><li><a href="#gateway-caches" class="table-of-contents__link toc-highlight">Gateway Caches</a></li></ul></li><li><a href="#arent-web-caches-bad-for-me-why-should-i-help-them" class="table-of-contents__link toc-highlight">Aren’t Web Caches bad for me? Why should I help them?</a></li><li><a href="#how-web-caches-work" class="table-of-contents__link toc-highlight">How Web Caches Work</a></li><li><a href="#how-and-how-not-to-control-caches" class="table-of-contents__link toc-highlight">How (and how not) to Control Caches</a></li><li><a href="#html-meta-tags-and-http-headers" class="table-of-contents__link toc-highlight">HTML Meta Tags and HTTP Headers</a></li><li><a href="#pragma-http-headers-and-why-they-dont-work" class="table-of-contents__link toc-highlight">Pragma HTTP Headers (and why they don’t work)</a></li><li><a href="#controlling-freshness-with-the-expires-http-header" class="table-of-contents__link toc-highlight">Controlling Freshness with the Expires HTTP Header</a></li><li><a href="#cache-control-http-headers" class="table-of-contents__link toc-highlight">Cache-Control HTTP Headers</a></li><li><a href="#validators-and-validation" class="table-of-contents__link toc-highlight">Validators and Validation</a></li><li><a href="#tips-for-building-a-cache-aware-site" class="table-of-contents__link toc-highlight">Tips for Building a Cache-Aware Site</a></li><li><a href="#writing-cache-aware-scripts" class="table-of-contents__link toc-highlight">Writing Cache-Aware Scripts</a></li><li><a href="#frequently-asked-questions" class="table-of-contents__link toc-highlight">Frequently Asked Questions</a><ul><li><a href="#what-are-the-most-important-things-to-make-cacheable" class="table-of-contents__link toc-highlight">What are the most important things to make cacheable?</a></li><li><a href="#how-can-i-make-my-pages-as-fast-as-possible-with-caches" class="table-of-contents__link toc-highlight">How can I make my pages as fast as possible with caches?</a></li><li><a href="#i-understand-that-caching-is-good-but-i-need-to-keep-statistics-on-how-many-people-visit-my-page" class="table-of-contents__link toc-highlight">I understand that caching is good, but I need to keep statistics on how many people visit my page!</a></li><li><a href="#how-can-i-see-a-representations-http-headers" class="table-of-contents__link toc-highlight">How can I see a representation’s HTTP headers?</a></li><li><a href="#my-pages-are-password-protected-how-do-proxy-caches-deal-with-them" class="table-of-contents__link toc-highlight">My pages are password-protected; how do proxy caches deal with them?</a></li><li><a href="#should-i-worry-about-security-if-people-access-my-site-through-a-cache" class="table-of-contents__link toc-highlight">Should I worry about security if people access my site through a cache?</a></li><li><a href="#im-looking-for-an-integrated-web-publishing-solution-which-ones-are-cache-aware" class="table-of-contents__link toc-highlight">I’m looking for an integrated Web publishing solution. Which ones are cache-aware?</a></li><li><a href="#my-images-expire-a-month-from-now-but-i-need-to-change-them-in-the-caches-now" class="table-of-contents__link toc-highlight">My images expire a month from now, but I need to change them in the caches now!</a></li><li><a href="#i-run-a-web-hosting-service-how-can-i-let-my-users-publish-cache-friendly-pages" class="table-of-contents__link toc-highlight">I run a Web Hosting service. How can I let my users publish cache-friendly pages?</a></li><li><a href="#implementation-notes--web-servers" class="table-of-contents__link toc-highlight">Implementation Notes — Web Servers</a></li><li><a href="#apache-http-server" class="table-of-contents__link toc-highlight">Apache HTTP Server</a></li></ul></li><li><a href="#microsoft-iis" class="table-of-contents__link toc-highlight">Microsoft IIS</a></li><li><a href="#netscapeiplanet-enterprise-server" class="table-of-contents__link toc-highlight">Netscape/iPlanet Enterprise Server</a></li><li><a href="#implementation-notes--server-side-scripting" class="table-of-contents__link toc-highlight">Implementation Notes — Server-Side Scripting</a></li><li><a href="#cgi" class="table-of-contents__link toc-highlight">CGI</a></li><li><a href="#server-side-includes" class="table-of-contents__link toc-highlight">Server Side Includes</a><ul><li><a href="#php" class="table-of-contents__link toc-highlight">PHP</a></li><li><a href="#cold-fusion" class="table-of-contents__link toc-highlight">Cold Fusion</a></li><li><a href="#asp-and-aspnet" class="table-of-contents__link toc-highlight">ASP and ASP.NET</a></li></ul></li><li><a href="#references-and-further-information" class="table-of-contents__link toc-highlight">References and Further Information</a><ul><li><a href="#http-11-specification" class="table-of-contents__link toc-highlight">HTTP 1.1 Specification</a></li><li><a href="#web-cachingcom" class="table-of-contents__link toc-highlight">Web-Caching.com</a></li><li><a href="#on-interpreting-access-statistics" class="table-of-contents__link toc-highlight">On Interpreting Access Statistics</a></li><li><a href="#redbot" class="table-of-contents__link toc-highlight">REDbot</a></li></ul></li></ul></div></div></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Recommend</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/articles/es6-in-depth/introduction">深入浅出ES6 - InfoQ.cn</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/articles/why-java-sucks-and-csharp-rocks/compare-purpose">Why Java Sucks and C# Rocks - 赵劼</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/reading">阅读笔记</a></li></ul></div><div class="col footer__col"><div class="footer__title">Translate</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/built-in/docusaurus/">Docusaurus Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/built-in/docusaurus/docs/markdown-features">Docusaurus Markdown</a></li><li class="footer__item"><a class="footer__link-item" href="/blog/2022/03/12/caddy-intro">Caddy 简介</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/alanwei43/node-io-lib" target="_blank" rel="noopener noreferrer" class="footer__link-item">node-io-lib - GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/alanwei43/docker-puppeteer" target="_blank" rel="noopener noreferrer" class="footer__link-item">docker-puppeteer - GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/alanwei43/code-server" target="_blank" rel="noopener noreferrer" class="footer__link-item">code-server - GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Alan's Blog</div></div></div></footer></div>
<script src="/assets/js/runtime~main.48be7bf4.js"></script>
<script src="/assets/js/main.084633aa.js"></script>
</body>
</html>