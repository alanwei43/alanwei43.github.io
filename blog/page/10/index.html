<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-list-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">博客  -  Alan&#x27;s Blog</title><meta data-rh="true" name="baidu-site-verification" content="code-7RGpEH8jty"><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://blog.alanwei.com/blog/page/10"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="博客  -  Alan&#x27;s Blog"><meta data-rh="true" name="description" content="Alan的博文列表"><meta data-rh="true" property="og:description" content="Alan的博文列表"><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://blog.alanwei.com/blog/page/10"><link data-rh="true" rel="alternate" href="https://blog.alanwei.com/blog/page/10" hreflang="en"><link data-rh="true" rel="alternate" href="https://blog.alanwei.com/blog/page/10" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://7SQ6A6EP36-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Alan&#39;s Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Alan&#39;s Blog Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Alan&#39;s Blog" href="/opensearch.xml">



<script src="/scripts/baidu.js"></script>
<script src="/scripts/bing-clarity.js"></script><link rel="stylesheet" href="/assets/css/styles.eb6e99d3.css">
<link rel="preload" href="/assets/js/runtime~main.561933f1.js" as="script">
<link rel="preload" href="/assets/js/main.c3ec37e0.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Alan&#x27;s Blog</b></a><a class="navbar__item navbar__link" href="/docs/articles">Articles</a><a class="navbar__item navbar__link" href="/docs/reading">Reading</a><a class="navbar__item navbar__link" href="/docs/built-in">Documents</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/me">Abount me</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/alanwei43" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_brwN thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_r4Q1 margin-bottom--md">Top posts</div><ul class="sidebarItemList_QwSx clean-list"><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2022/03/12/caddy-intro/">Caddy 简介</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2022/11/27/fnm-node-version-manager">fnm - Node版本管理工具</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2022/07/21/graphql-intro">GraphQL intro</a></li></ul><div class="sidebarItemTitle_r4Q1 margin-bottom--md">Recent posts</div><ul class="sidebarItemList_QwSx clean-list"><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/03/27/nginx-location-directive">NGINX location 指令示例</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/03/17/gnome-shell">Ubuntu install gnome</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/03/09/vue-cli-es5">Vue2项目构建没有转换ES6语法</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/03/07/nuxt-insert-inline-script">Nuxt 插入内联脚本</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/02/21/chrome-redirect-https-from-http">解决 Chrome 记住 HTTP 自动跳转 HTTPS</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/02/12/docusaurus-multi-documents">Docusaurus 多个文档</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/02/10/linux-skills">Linux 技巧</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/02/08/ubuntu-permanently-remove-sidebar-video">删除 Files 侧边栏预置目录</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/02/05/amazon-kindle-backup">Amazon Kindle 电子书备份</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/02/04/linux-chrome-disable-password">Ubuntu启动Chrome去掉每次输入密码</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/01/09/awesome-code-snippet">Awesome Code Snippet</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2023/01/08/live-stream-server">Live Stream Server</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2022/12/29/pm2-config">PM2 配置文件介绍</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2022/12/26/flutter-develop-environment-setup">Flutter 开发环境设置</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2022/11/22/linux-install-vmware-workstation">Linux install VMware Workstation</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2022/11/22/resolve-npm-install-fail">国内 .npmrc 配置</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2022/11/22/ubuntu-downgrade-package-version">Ubuntu 降低包版本号</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2022/11/18/docker-run-as-non-root-user">以非root账号方式运行Docker</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2022/11/13/google-cn-resources">google.cn 资源整理</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2022/09/04/fix-nuxt-node-fs-resolver-problem">解决nuxt依赖Node原生模块导致构建失败问题</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2022/08/21/cache-docs">Caching Tutorial for Web Authors and Webmasters</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2022/07/12/await-try-catch">为什么try catch能捕捉await后promise错误？ 和执行栈有关系吗？</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2022/07/12/pass-all-props-to-children">Pass all props to children in Vue</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2022/07/12/why-async-await-better-stackful-coroutine">async/await异步模型是否优于stackful coroutine模型？</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2022/06/17/typescript-ignore-rules">TypeScript禁用规则</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2022/06/17/typescript-this-implicitly-has-type-any">解决 TypeScript 中出现的 &#x27;this&#x27; implicitly has type &#x27;any&#x27; error 问题</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2022/06/11/calculate-tow-square-overlap">计算两个矩形重叠面积</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/2022/05/22/how-to-change-ubuntu-timezone">如何设置Ubuntu 20.04 的时区</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2021/03/21/chromium-command-line-switches">Chromium 所有开关(flag)列表</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-03-21T00:00:00.000Z" itemprop="datePublished">March 21, 2021</time> · <!-- -->131 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/alanwei43" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/2927578?s=460&amp;u=153132e7aa3be8295a1703af9b759ca22338f557&amp;v=4" alt="Alan"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/alanwei43" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Alan</span></a></div><small class="avatar__subtitle" itemprop="description">Maintainer of blog</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p><a href="https://peter.sh/experiments/chromium-command-line-switches/" target="_blank" rel="noopener noreferrer">原文 - List of Chromium Command Line Switches</a></p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/chrome">chrome</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/chromium">chromium</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/chrome-flags">chrome flags</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/chrome-switches">chrome switches</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Chromium 所有开关(flag)列表" href="/blog/2021/03/21/chromium-command-line-switches"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2021/03/21/docusaurus-github-deploy">Docusaurus 配置 GitHub Action 自动发布</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-03-21T00:00:00.000Z" itemprop="datePublished">March 21, 2021</time> · <!-- -->3 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/alanwei43" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/2927578?s=460&amp;u=153132e7aa3be8295a1703af9b759ca22338f557&amp;v=4" alt="Alan"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/alanwei43" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Alan</span></a></div><small class="avatar__subtitle" itemprop="description">Maintainer of blog</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p><a href="https://v2.docusaurus.io/docs/deployment/#deploying-to-github-pages" target="_blank" rel="noopener noreferrer">原文 - Deploying to GitHub Pages</a></p><p>记录一下我是如何利用 GitHub Action，自动发布我的 Docusaurus(以下简称Doc) 博客的。</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/github">github</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/docusaurus">Docusaurus</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/github-action">github action</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Docusaurus 配置 GitHub Action 自动发布" href="/blog/2021/03/21/docusaurus-github-deploy"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2021/03/21/frp-eof">frp连接 EOF 失败问题</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-03-21T00:00:00.000Z" itemprop="datePublished">March 21, 2021</time> · <!-- -->5 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://blog.phpgao.com/author/1/" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">老高</span></a></div><small class="avatar__subtitle" itemprop="description">记录和分享，与你每天进步一点点。</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/frp">frp</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about frp连接 EOF 失败问题" href="/blog/2021/03/21/frp-eof"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2021/03/21/linux-all-ps-connection">linux下查看指定进程的所有连接信息</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-03-21T00:00:00.000Z" itemprop="datePublished">March 21, 2021</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/alanwei43" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/2927578?s=460&amp;u=153132e7aa3be8295a1703af9b759ca22338f557&amp;v=4" alt="Alan"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/alanwei43" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Alan</span></a></div><small class="avatar__subtitle" itemprop="description">Maintainer of blog</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>Ref: <a href="https://blog.fatedier.com/2016/07/18/stat-all-connection-info-of-special-process-in-linux/" target="_blank" rel="noopener noreferrer">linux下查看指定进程的所有连接信息</a></p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/linux">linux</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about linux下查看指定进程的所有连接信息" href="/blog/2021/03/21/linux-all-ps-connection"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2021/03/21/linux-view-port-using">显示Linux端口占用</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-03-21T00:00:00.000Z" itemprop="datePublished">March 21, 2021</time> · <!-- -->One min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/alanwei43" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/2927578?s=460&amp;u=153132e7aa3be8295a1703af9b759ca22338f557&amp;v=4" alt="Alan"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/alanwei43" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Alan</span></a></div><small class="avatar__subtitle" itemprop="description">Maintainer of blog</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>On Linux, you must be root or the owner of the process to get the information you desire. As such, for processes running as another user, prepending sudo is most of what you need. In addition to that, on modern Linux systems, ss is tool to use to do this:</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/linux">linux</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about 显示Linux端口占用" href="/blog/2021/03/21/linux-view-port-using"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2021/03/21/maven-aliyun">阿里云Maven镜像</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-03-21T00:00:00.000Z" itemprop="datePublished">March 21, 2021</time> · <!-- -->One min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/alanwei43" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/2927578?s=460&amp;u=153132e7aa3be8295a1703af9b759ca22338f557&amp;v=4" alt="Alan"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/alanwei43" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Alan</span></a></div><small class="avatar__subtitle" itemprop="description">Maintainer of blog</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>配置Maven使用阿里云镜像:</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/maven">maven</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/java">java</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/mirror">mirror</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about 阿里云Maven镜像" href="/blog/2021/03/21/maven-aliyun"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2021/03/21/node-tls">解决 Node.js HTTP 请求出现的自签名证书校验失败问题</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-03-21T00:00:00.000Z" itemprop="datePublished">March 21, 2021</time> · <!-- -->One min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/alanwei43" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/2927578?s=460&amp;u=153132e7aa3be8295a1703af9b759ca22338f557&amp;v=4" alt="Alan"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/alanwei43" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Alan</span></a></div><small class="avatar__subtitle" itemprop="description">Maintainer of blog</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>程序执行之前先执行以下代码, 设置环境变量:</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">env</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">NODE_TLS_REJECT_UNAUTHORIZED</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0&quot;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/node-js">node.js</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2021/03/21/npm-taobao">NPM的淘宝镜像</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-03-21T00:00:00.000Z" itemprop="datePublished">March 21, 2021</time> · <!-- -->One min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/alanwei43" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/2927578?s=460&amp;u=153132e7aa3be8295a1703af9b759ca22338f557&amp;v=4" alt="Alan"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/alanwei43" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Alan</span></a></div><small class="avatar__subtitle" itemprop="description">Maintainer of blog</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>下面简单介绍一下NPM淘宝镜像使用:</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/npm">npm</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/node-js">node.js</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/镜像">镜像</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about NPM的淘宝镜像" href="/blog/2021/03/21/npm-taobao"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2021/03/20/visual-studio-code-reveal">Visual Studio Code 侧边栏定位到当前文件</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-03-20T00:00:00.000Z" itemprop="datePublished">March 20, 2021</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/alanwei43" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/2927578?s=460&amp;u=153132e7aa3be8295a1703af9b759ca22338f557&amp;v=4" alt="Alan"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/alanwei43" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Alan</span></a></div><small class="avatar__subtitle" itemprop="description">Maintainer of blog</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>项目文件比较多时, 如何在侧边栏快速定位到当前文件是一个常用的功能，下面介绍我的配置。</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/vsc">vsc</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/visual-studio-code">visual studio code</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/editor">editor</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Visual Studio Code 侧边栏定位到当前文件" href="/blog/2021/03/20/visual-studio-code-reveal"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2021/03/15/chrome-flags">Chrome flags</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-03-15T00:00:00.000Z" itemprop="datePublished">March 15, 2021</time> · <!-- -->6 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/alanwei43" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/2927578?s=460&amp;u=153132e7aa3be8295a1703af9b759ca22338f557&amp;v=4" alt="Alan"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/alanwei43" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Alan</span></a></div><small class="avatar__subtitle" itemprop="description">Maintainer of blog</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>Chrome 工具 flags 列表, 摘自 <a href="https://github.com/GoogleChrome/chrome-launcher/blob/master/docs/chrome-flags-for-tools.md" target="_blank" rel="noopener noreferrer">Chrome Flags for Tooling</a>:</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/chrome-flags">chrome flags</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/chrome">chrome</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/puppeteer">puppeteer</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/chrome-launcher">chrome-launcher</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Chrome flags" href="/blog/2021/03/15/chrome-flags"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2021/03/14/lets-encrypt-ssl-certificate">Let&#x27;s Encrypt证书申请及配置</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-03-14T00:00:00.000Z" itemprop="datePublished">March 14, 2021</time> · <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/alanwei43" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/2927578?s=460&amp;u=153132e7aa3be8295a1703af9b759ca22338f557&amp;v=4" alt="Alan"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/alanwei43" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Alan</span></a></div><small class="avatar__subtitle" itemprop="description">Maintainer of blog</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>本文主要介绍使用 <a href="https://letsencrypt.org/" target="_blank" rel="noopener noreferrer">Let&#x27;s Encrypt</a>(一个由非营利性组织 互联网安全研究小组（ISRG）提供的免费、自动化和开放的证书颁发机构（CA）) 签发证书及Nginx配置。</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/ssl">ssl</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/nginx">nginx</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/lets-encrypt">let&#x27;s encrypt</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Let&#x27;s Encrypt证书申请及配置" href="/blog/2021/03/14/lets-encrypt-ssl-certificate"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2021/03/13/back-forward-cache">浏览器的前进后退缓存机制 Back/forward cache</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-03-13T00:00:00.000Z" itemprop="datePublished">March 13, 2021</time> · <!-- -->17 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/philipwalton" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://web-dev.imgix.net/image/admin/ovBM8MF9rYDxVVHUVlcG.jpg?w=128" alt="Philip Walton"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/philipwalton" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Philip Walton</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>Optimize your pages for instant loads when using the browser&#x27;s back and forward buttons. </p><p>Back/forward cache (or bfcache) is a browser optimization that enables instant back and forward navigation. It significantly improves the browsing experience for users—especially those with slower networks or devices.</p><p>As web developers, it&#x27;s critical to understand how to <a href="https://web.dev/bfcache/#optimize-your-pages-for-bfcache" target="_blank" rel="noopener noreferrer">optimize your pages for bfcache</a> across all browsers, so your users can reap the benefits.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="browser-compatibility">Browser compatibility<a href="#browser-compatibility" class="hash-link" aria-label="Direct link to Browser compatibility" title="Direct link to Browser compatibility">​</a></h2><p>bfcache has been supported in both <a href="https://developer.mozilla.org/docs/Mozilla/Firefox/Releases/1.5/Using_Firefox_1.5_caching" target="_blank" rel="noopener noreferrer">Firefox</a> and <a href="https://webkit.org/blog/427/webkit-page-cache-i-the-basics/" target="_blank" rel="noopener noreferrer">Safari</a> for many years, across desktop and mobile.</p><p>Starting in version 86, Chrome has enabled bfcache for <a href="https://web.dev/same-site-same-origin/" target="_blank" rel="noopener noreferrer">cross-site</a> navigations on Android for a small percentage of users. In Chrome 87, bfcache support will be rolled out to all Android users for cross-site navigation, with the intent to support <a href="https://web.dev/same-site-same-origin/" target="_blank" rel="noopener noreferrer">same-site</a> navigation as well in the near future.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="bfcache-basics">bfcache basics<a href="#bfcache-basics" class="hash-link" aria-label="Direct link to bfcache basics" title="Direct link to bfcache basics">​</a></h3><p>bfcache is an in-memory cache that stores a complete snapshot of a page (including the JavaScript heap) as the user is navigating away. With the entire page in memory, the browser can quickly and easily restore it if the user decides to return.</p><p>How many times have you visited a website and clicked a link to go to another page, only to realize it&#x27;s not what you wanted and click the back button? In that moment, bfcache can make a big difference in how fast the previous page loads:</p><ul><li><strong>Without bfcache enabled</strong>  A new request is initiated to load the previous page, and, depending on how well that page has been <a href="https://web.dev/reliable/#the-options-in-your-caching-toolbox" target="_blank" rel="noopener noreferrer">optimized</a> for repeat visits, the browser might have to re-download, re-parse, and re-execute some (or all) of resources it just downloaded. </li><li><strong>With bfcache enabled</strong>  Loading the previous page is <em>essentially instant</em>, because the entire page can be restored from memory, without having to go to the network at all </li></ul><p>Check out <a href="https://youtu.be/cuPsdRckkF0" target="_blank" rel="noopener noreferrer">this video of bfcache in action</a> to understand the speed up it can bring to navigations.</p><p>In the video above, the example with bfcache is quite a bit faster than the example without it.</p><p>bfcache not only speeds up navigation, it also reduces data usage, since resources do not have to be downloaded again.</p><p>Chrome usage data shows that 1 in 10 navigations on desktop and 1 in 5 on mobile are either back or forward. With bfcache enabled, browsers could eliminate the data transfer and time spent loading for billions of web pages every single day!</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="how-the-cache-works">How the &quot;cache&quot; works<a href="#how-the-cache-works" class="hash-link" aria-label="Direct link to How the &quot;cache&quot; works" title="Direct link to How the &quot;cache&quot; works">​</a></h3><p>The &quot;cache&quot; used by bfcache is different from the <a href="https://web.dev/http-cache/" target="_blank" rel="noopener noreferrer">HTTP cache</a> (which is also useful in speeding up repeat navigations). The bfcache is a snapshot of the entire page in memory (including the JavaScript heap), whereas the HTTP cache contains only the responses for previously made requests. Since it&#x27;s quite rare that all requests required to load a page can be fulfilled from the HTTP cache, repeat visits using bfcache restores are always faster than even the most well-optimized non-bfcache navigations.</p><p>Creating a snapshot of a page in memory, however, involves some complexity in terms of how best to preserve in-progress code. For example, how do you handle <code>setTimeout()</code> calls where the timeout is reached while the page is in the bfcache?</p><p>The answer is that browsers pause running any pending timers or unresolved promises—essentially all pending tasks in the <a href="https://html.spec.whatwg.org/multipage/webappapis.html#task-queue" target="_blank" rel="noopener noreferrer">JavaScript task queues</a>—and resume processing tasks when (or if) the page is restored from the bfcache.</p><p>In some cases this is fairly low-risk (for example, timeouts or promises), but in other cases it might lead to very confusing or unexpected behavior. For example, if the browser pauses a task that&#x27;s required as part of an <a href="https://developer.mozilla.org/docs/Web/API/IDBTransaction" target="_blank" rel="noopener noreferrer">IndexedDB transaction</a>, it can affect other open tabs in the same origin (since the same IndexedDB databases can be accessed by multiple tabs simultaneously). As a result, browsers will generally not attempt to cache pages in the middle of an IndexedDB transaction or using APIs that might affect other pages.</p><p>For more details on how various API usage affects a page&#x27;s bfcache eligibility, see <a href="https://web.dev/bfcache/#optimize-your-pages-for-bfcache" target="_blank" rel="noopener noreferrer">Optimize your pages for bfcache</a> below.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="apis-to-observe-bfcache">APIs to observe bfcache<a href="#apis-to-observe-bfcache" class="hash-link" aria-label="Direct link to APIs to observe bfcache" title="Direct link to APIs to observe bfcache">​</a></h3><p>While bfcache is an optimization that browsers do automatically, it&#x27;s still important for developers to know when it&#x27;s happening so they can <a href="https://web.dev/bfcache/#optimize-your-pages-for-bfcache" target="_blank" rel="noopener noreferrer">optimize their pages for it</a> and <a href="https://web.dev/bfcache/#implications-for-analytics-and-performance-measurement" target="_blank" rel="noopener noreferrer">adjust any metrics or performance measurement</a> accordingly.</p><p>The primary events used to observe bfcache are the <a href="https://developer.mozilla.org/docs/Web/API/PageTransitionEvent" target="_blank" rel="noopener noreferrer">page transition events</a>—<code>pageshow</code> and pagehide—which have been around as long as bfcache has and are supported in pretty much <a href="https://caniuse.com/page-transition-events" target="_blank" rel="noopener noreferrer">all browsers in use today</a>.</p><p>The newer <a href="https://developers.google.com/web/updates/2018/07/page-lifecycle-api" target="_blank" rel="noopener noreferrer">Page Lifecycle</a> events—<code>freeze</code> and <code>resume</code>—are also dispatched when pages go in or out of the bfcache, as well as in some other situations. For example when a background tab gets frozen to minimize CPU usage. Note, the Page Lifecycle events are currently only supported in Chromium-based browsers.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="observe-when-a-page-is-restored-from-bfcache">Observe when a page is restored from bfcache<a href="#observe-when-a-page-is-restored-from-bfcache" class="hash-link" aria-label="Direct link to Observe when a page is restored from bfcache" title="Direct link to Observe when a page is restored from bfcache">​</a></h3><p>The <code>pageshow</code> event fires right after the <code>load</code> event when the page is initially loading and any time the page is restored from bfcache. The <code>pageshow</code> event has a <a href="https://developer.mozilla.org/docs/Web/API/PageTransitionEvent/persisted" target="_blank" rel="noopener noreferrer">persisted</a> property which will be <code>true</code> if the page was restored from bfcache (and <code>false</code> if not). You can use the <code>persisted</code> property to distinguish regular page loads from bfcache restores. For example:</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;pageshow&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">persisted</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;This page was restored from the bfcache.&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;This page was loaded normally.&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In browsers that support the Page Lifecycle API, the <code>resume</code> event will also fire when pages are restored from bfcache (immediately before the <code>pageshow</code> event), though it will also fire when a user revisits a frozen background tab. If you want to restore a page&#x27;s state after it&#x27;s frozen (which includes pages in the bfcache), you can use the <code>resume</code> event, but if you want to measure your site&#x27;s bfcache hit rate, you&#x27;d need to use the <code>pageshow</code> event. In some cases, you might need to use both.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>See <a href="https://web.dev/bfcache/#how-bfcache-affects-analytics-and-performance-measurement" target="_blank" rel="noopener noreferrer">Implications for performance and analytics</a> for more details on bfcache measurement best practices.</p></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="observe-when-a-page-is-entering-bfcache">Observe when a page is entering bfcache<a href="#observe-when-a-page-is-entering-bfcache" class="hash-link" aria-label="Direct link to Observe when a page is entering bfcache" title="Direct link to Observe when a page is entering bfcache">​</a></h3><p>The <code>pagehide</code> event is the counterpart to the <code>pageshow</code> event. The <code>pageshow</code> event fires when a page is either loaded normally or restored from the bfcache. The <code>pagehide</code> event fires when the page is either unloaded normally or when the browser attempts to put it into the bfcache.</p><p>The <code>pagehide</code> event also has a <code>persisted</code> property, and if it&#x27;s <code>false</code> then you can be confident a page is not about to enter the bfcache. However, if the <code>persisted</code> property is <code>true</code>, it doesn&#x27;t guarantee that a page will be cached. It means that the browser intends to cache the page, but there may be factors that make it impossible to cache.</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;pagehide&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">persisted</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;This page *might* be entering the bfcache.&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;This page will unload normally and be discarded.&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Similarly, the <code>freeze</code> event will fire immediately after the <code>pagehide</code> event (if the event&#x27;s <code>persisted</code> property is <code>true</code>), but again that only means the browser intends to cache the page. It may still have to discard it for a number of reasons explained below.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="optimize-your-pages-for-bfcache">Optimize your pages for bfcache<a href="#optimize-your-pages-for-bfcache" class="hash-link" aria-label="Direct link to Optimize your pages for bfcache" title="Direct link to Optimize your pages for bfcache">​</a></h2><p>Not all pages get stored in bfcache, and even when a page does get stored there, it won&#x27;t stay there indefinitely. It&#x27;s critical that developers understand what makes pages eligible (and ineligible) for bfcache to maximize their cache-hit rates.</p><p>The following sections outline the best practices to make it as likely as possible that the browser can cache your pages.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="never-use-the-unload-event">Never use the unload event<a href="#never-use-the-unload-event" class="hash-link" aria-label="Direct link to Never use the unload event" title="Direct link to Never use the unload event">​</a></h3><p>The most important way to optimize for bfcache in all browsers is to never use the <code>unload</code> event. Ever!</p><p>The <code>unload</code> event is problematic for browsers because it predates bfcache and many pages on the internet operate under the (reasonable) assumption that a page will not continue to exist after the <code>unload</code> event has fired. This presents a challenge because many of those pages were also built with the assumption that the <code>unload</code> event would fire any time a user is navigating away, which is no longer true (and <a href="https://developers.google.com/web/updates/2018/07/page-lifecycle-api#the-unload-event" target="_blank" rel="noopener noreferrer">hasn&#x27;t been true for a long time</a>).</p><p>So browsers are faced with a dilemma, they have to choose between something that can improve the user experience—but might also risk breaking the page.</p><p>Firefox has chosen to make pages ineligible for bfcache if they add an <code>unload</code> listener, which is less risky but also disqualifies a lot of pages. Safari will attempt to cache some pages with an <code>unload</code> event listener, but to reduce potential breakage it will not run the <code>unload</code> event when a user is navigating away.</p><p>Since 65% of pages in Chrome register an <code>unload</code> event listener, to be able to cache as many pages as possible, Chrome chose to align implementation with Safari.</p><p>Instead of using the <code>unload</code> event, use the <code>pagehide</code> event. The <code>pagehide</code> event fires in all cases where the <code>unload</code> event currently fires, and it also fires when a page is put in the bfcache.</p><p>In fact, Lighthouse v6.2.0 has added a <a href="https://github.com/GoogleChrome/lighthouse/pull/11085" target="_blank" rel="noopener noreferrer">no-unload-listeners</a> audit, which will warn developers if any JavaScript on their pages (including that from third-party libraries) adds an <code>unload</code> event listener.</p><div class="theme-admonition theme-admonition-warning alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_S0QG"><p>Warning: Never add an <code>unload</code> event listener! Use the <code>pagehide</code> event instead. Adding an <code>unload</code> event listener will make your site slower in Firefox, and the code won&#x27;t even run most of the time in Chrome and Safari.</p></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="only-add-beforeunload-listeners-conditionally">Only add beforeunload listeners conditionally<a href="#only-add-beforeunload-listeners-conditionally" class="hash-link" aria-label="Direct link to Only add beforeunload listeners conditionally" title="Direct link to Only add beforeunload listeners conditionally">​</a></h3><p>The <code>beforeunload</code> event will not make your pages ineligible for bfcache in Chrome or Safari, but it will make them ineligible in Firefox, so avoid using it unless absolutely necessary.</p><p>Unlike the <code>unload</code> event, however, there are legitimate uses for <code>beforeunload</code>. For example, when you want to warn the user that they have unsaved changes they&#x27;ll lose if they leave the page. In this case, it&#x27;s recommended that you only add <code>beforeunload</code> listeners when a user has unsaved changes and then remove them immediately after the unsaved changes are saved.</p><div class="theme-admonition theme-admonition-warning alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_S0QG"><p><strong>Don&#x27;t</strong></p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;beforeunload&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">pageHasUnsavedChanges</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">preventDefault</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">returnValue</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Are you sure you want to exit?&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The code above adds a <code>beforeunload</code> listener unconditionally.</p></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p><strong>Do</strong></p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">beforeUnloadListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">preventDefault</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">returnValue</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Are you sure you want to exit?&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// A function that invokes a callback when the page has unsaved changes.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">onPageHasUnsavedChanges</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;beforeunload&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> beforeUnloadListener</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// A function that invokes a callback when the page&#x27;s unsaved changes are resolved.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">onAllChangesSaved</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">removeEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;beforeunload&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> beforeUnloadListener</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The code above only adds the <code>beforeunload</code> listener when it&#x27;s needed (and removes it when it&#x27;s not).</p></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="avoid-windowopener-references">Avoid window.opener references<a href="#avoid-windowopener-references" class="hash-link" aria-label="Direct link to Avoid window.opener references" title="Direct link to Avoid window.opener references">​</a></h3><p>In some browsers (including Chromium-based browsers) if a page was opened using <a href="https://developer.mozilla.org/docs/Web/API/Window/open" target="_blank" rel="noopener noreferrer">window.open()</a> or (in <a href="https://crbug.com/898942" target="_blank" rel="noopener noreferrer">Chromium-based browsers prior to version 88</a>) from a link with <a href="https://developer.mozilla.org/docs/Web/HTML/Element/a#target" target="_blank" rel="noopener noreferrer">target=_blank</a>—without specifying <a href="https://developer.mozilla.org/docs/Web/HTML/Link_types/noopener" target="_blank" rel="noopener noreferrer">rel=&quot;noopener&quot;</a>—then the opening page will have a reference to the window object of the opened page.</p><p>In addition to <a href="https://mathiasbynens.github.io/rel-noopener/" target="_blank" rel="noopener noreferrer">being a security risk</a>, a page with a non-null window.opener reference cannot safely be put into the bfcache because that could break any pages attempting to access it.</p><p>As a result, it&#x27;s best to avoid creating window.opener references by using rel=&quot;noopener&quot; whenever possible. If your site requires opening a window and controlling it through <a href="https://developer.mozilla.org/docs/Web/API/Window/postMessage" target="_blank" rel="noopener noreferrer">window.postMessage()</a> or directly referencing the window object, neither the opened window nor the opener will be eligible for bfcache.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="always-close-open-connections-before-the-user-navigates-away">Always close open connections before the user navigates away<a href="#always-close-open-connections-before-the-user-navigates-away" class="hash-link" aria-label="Direct link to Always close open connections before the user navigates away" title="Direct link to Always close open connections before the user navigates away">​</a></h3><p>As mentioned above, when a page is put into the bfcache all scheduled JavaScript tasks are paused and then resumed when the page is taken out of the cache.</p><p>If these scheduled JavaScript tasks are only accessing DOM APIs—or other APIs isolated to just the current page—then pausing these tasks while the page is not visible to the user is not going to cause any problems.</p><p>However, if these tasks are connected to APIs that are also accessible from other pages in the same origin (for example: IndexedDB, Web Locks, WebSockets, etc.) this can be problematic because pausing these tasks may prevent code in other tabs from running.</p><p>As a result, most browsers will not attempt to put a page in bfcache in the following scenarios:</p><ul><li>Pages with an unfinished <a href="https://developer.mozilla.org/docs/Web/API/IDBTransaction" target="_blank" rel="noopener noreferrer">IndexedDB transaction</a></li><li>Pages with in-progress <a href="https://developer.mozilla.org/docs/Web/API/Fetch_API" target="_blank" rel="noopener noreferrer">fetch()</a> or <a href="https://developer.mozilla.org/docs/Web/API/XMLHttpRequest" target="_blank" rel="noopener noreferrer">XMLHttpRequest</a></li><li>Pages with an open <a href="https://developer.mozilla.org/docs/Web/API/WebSocket" target="_blank" rel="noopener noreferrer">WebSocket</a> or <a href="https://developer.mozilla.org/docs/Web/API/WebRTC_API" target="_blank" rel="noopener noreferrer">WebRTC</a> connection</li></ul><p>If your page is using any of these APIs, it&#x27;s best to always close connections and remove or disconnect observers during the <code>pagehide</code> or <code>freeze</code> event. That will allow the browser to safely cache the page without the risk of it affecting other open tabs.</p><p>Then, if the page is restored from the bfcache, you can re-open or re-connect to those APIs (in the <code>pageshow</code> or <code>resume</code> event).</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>Using the APIs listed above does not disqualify a page from being stored in bfcache, as long as they are not actively in use before the user navigates away. However, there are APIs (Embedded Plugins, Workers, Broadcast Channel, and <a href="https://source.chromium.org/chromium/chromium/src/+/master:content/browser/frame_host/back_forward_cache_impl.cc;l=124;drc=e790fb2272990696f1d16a465832692f25506925?originalUrl=https:%2F%2Fcs.chromium.org%2F" target="_blank" rel="noopener noreferrer">several others</a>) where usage currently does disqualify a page from being cached. While Chrome is intentionally being conservative in its initial release of bfcache, the long-term goal is to make bfcache work with as many APIs as possible.</p></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="test-to-ensure-your-pages-are-cacheable">Test to ensure your pages are cacheable<a href="#test-to-ensure-your-pages-are-cacheable" class="hash-link" aria-label="Direct link to Test to ensure your pages are cacheable" title="Direct link to Test to ensure your pages are cacheable">​</a></h3><p>While there&#x27;s no way to determine whether a page was put into the cache as it&#x27;s unloading, it is possible to assert that a back or forward navigation did restore a page from the cache.</p><p>Currently, in Chrome, a page can remain in the bfcache for up to three minutes, which should be enough time to run a test (using a tool like <a href="https://github.com/puppeteer/puppeteer" target="_blank" rel="noopener noreferrer">Puppeteer</a> or <a href="https://www.w3.org/TR/webdriver/" target="_blank" rel="noopener noreferrer">WebDriver</a>) to ensure that the <code>persisted</code> property of a <code>pageshow</code> event is true after navigating away from a page and then clicking the back button.</p><p>Note that, while under normal conditions a page should remain in the cache for long enough to run a test, it can be evicted silently at any time (for example, if the system is under memory pressure). A failing test doesn&#x27;t necessarily mean your pages are not cacheable, so you need to configure your test or build failure criteria accordingly.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>In Chrome, bfcache is currently only enabled on mobile. To test bfcache on desktop you need to <a href="https://www.chromium.org/developers/how-tos/run-chromium-with-flags" target="_blank" rel="noopener noreferrer">enable the #back-forward-cache flag</a>.</p></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ways-to-opt-out-of-bfcache">Ways to opt out of bfcache<a href="#ways-to-opt-out-of-bfcache" class="hash-link" aria-label="Direct link to Ways to opt out of bfcache" title="Direct link to Ways to opt out of bfcache">​</a></h3><p>If you do not want a page to be stored in the bfcache you can ensure it&#x27;s not cached by setting the <code>Cache-Control</code> header on the top-level page response to <code>no-store</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Cache-Control: no-store</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>All other caching directives (including <code>no-cache</code> or even <code>no-store</code> on a subframe) will not affect a page&#x27;s eligibility for bfcache.</p><p>While this method is effective and works across browsers, it has other caching and performance implications that may be undesirable. To address that, there&#x27;s a proposal to <a href="https://github.com/whatwg/html/issues/5744" target="_blank" rel="noopener noreferrer">add a more explicit opt-out mechanism</a>, including a mechanism to clear the bfcache if needed (for example, when a user logs out of a website on a shared device).</p><p>Also, in Chrome, user-level opt-out is currently possible via <a href="https://www.chromium.org/developers/how-tos/run-chromium-with-flags" target="_blank" rel="noopener noreferrer">the #back-forward-cache flag</a>, as well an <a href="https://cloud.google.com/docs/chrome-enterprise/policies" target="_blank" rel="noopener noreferrer">enterprise policy-based opt-out</a>.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>Caution: Given the significantly better user experience that bfcache delivers, it is not recommended to opt-out unless absolutely necessary for privacy reasons, for example if a user logs out of a website on a shared device.</p></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="how-bfcache-affects-analytics-and-performance-measurement">How bfcache affects analytics and performance measurement<a href="#how-bfcache-affects-analytics-and-performance-measurement" class="hash-link" aria-label="Direct link to How bfcache affects analytics and performance measurement" title="Direct link to How bfcache affects analytics and performance measurement">​</a></h2><p>If you track visits to your site with an analytics tool, you will likely notice a decrease in the total number of pageviews reported as Chrome continues to enable bfcache for more users.</p><p>In fact, you&#x27;re likely already underreporting pageviews from other browsers that implement bfcache since most of the popular analytics libraries do not track bfcache restores as new pageviews.</p><p>If you don&#x27;t want your pageview counts to go down due to Chrome enabling bfcache, you can report bfcache restores as pageviews (recommended) by listening to the <code>pageshow</code> event and checking the <code>persisted</code> property.</p><p>The following example shows how to do this with Google Analytics; the logic should be similar for other analytics tools:</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Send a pageview when the page is first loaded.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">gtag</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;event&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;page_view&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;pageshow&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">persisted</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Send another pageview if the page is restored from bfcache.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">gtag</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;event&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;page_view&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="performance-measurement">Performance measurement<a href="#performance-measurement" class="hash-link" aria-label="Direct link to Performance measurement" title="Direct link to Performance measurement">​</a></h3><p>bfcache can also negatively affect performance metrics collected <a href="https://web.dev/user-centric-performance-metrics/#in-the-field" target="_blank" rel="noopener noreferrer">in the field</a>, specifically metrics that measure page load times.</p><p>Since bfcache navigations restore an existing page rather than initiate a new page load, the total number of page loads collected will decrease when bfcache is enabled. What&#x27;s critical, though, is that the page loads being replaced by bfcache restores would likely have been some of the fastest page loads in your dataset. This is because back and forward navigations, by definition, are repeat visits, and repeat page loads are generally faster than page loads from first time visitors (due to <a href="https://web.dev/http-cache/" target="_blank" rel="noopener noreferrer">HTTP caching</a>, as mentioned earlier).</p><p>The result is fewer fast page loads in your dataset, which will likely skew the distribution slower—despite the fact that the performance experienced by the user has probably improved!</p><p>There are a few ways to deal with this issue. One is to annotate all page load metrics with their respective <a href="https://www.w3.org/TR/navigation-timing-2/#sec-performance-navigation-types" target="_blank" rel="noopener noreferrer">navigation type</a>: <code>navigate</code>, <code>reload</code>, <code>back_forward</code>, or <code>prerender</code>. This will allow you to continue to monitor your performance within these navigation types—even if the overall distribution skews negative. This approach is recommended for non-user-centric page load metrics like <a href="https://web.dev/time-to-first-byte/" target="_blank" rel="noopener noreferrer">Time to First Byte (TTFB)</a>.</p><p>For user-centric metrics like the <a href="https://web.dev/vitals/" target="_blank" rel="noopener noreferrer">Core Web Vitals</a>, a better option is to report a value that more accurately represents what the user experiences.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>Caution: The <code>back_forward</code> navigation type in the <a href="https://www.w3.org/TR/navigation-timing-2/#sec-performance-navigation-types" target="_blank" rel="noopener noreferrer">Navigation Timing API</a> is not to be confused with bfcache restores. The Navigation Timing API only annotates page loads, whereas bfcache restores are re-using a page loaded from a previous navigation.</p></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="impact-on-core-web-vitals">Impact on Core Web Vitals<a href="#impact-on-core-web-vitals" class="hash-link" aria-label="Direct link to Impact on Core Web Vitals" title="Direct link to Impact on Core Web Vitals">​</a></h3><p>Core Web Vitals measure the user&#x27;s experience of a web page across a variety of dimensions (loading speed, interactivity, visual stability), and since users experience bfcache restores as faster navigations than traditional page loads, it&#x27;s important that the Core Web Vitals metrics reflect this. After all, a user doesn&#x27;t care whether or not bfcache was enabled, they just care that the navigation was fast!</p><p>Tools like the Chrome User Experience Report, that collect and report on the Core Web Vitals metrics treat bfcache restores as separate page visits in their dataset.</p><p>And while there aren&#x27;t (yet) dedicated web performance APIs for measuring these metrics after bfcache restores, their values can be approximated using existing web APIs.</p><ul><li>For Largest Contentful Paint (LCP), you can use the delta between the pageshow event&#x27;s timestamp and the timestamp of the next painted frame (since all elements in the frame will be painted at the same time). Note that in the case of a bfcache restore, LCP and FCP will be the same.</li><li>For First Input Delay (FID), you can re-add the event listeners (the same ones used by the FID polyfill) in the pageshow event, and report FID as the delay of the first input after the bfcache restore.</li><li>For Cumulative Layout Shift (CLS), you can continue to keep using your existing Performance Observer; all you have to do is reset the current CLS value to 0.</li></ul><p>For more details on how bfcache affects each metric, refer to the individual Core Web Vitals metric guides pages. And for a specific example of how to implement bfcache versions of these metrics in code, refer to the PR adding them to the web-vitals JS library.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>As of v1, the <a href="https://github.com/GoogleChrome/web-vitals" target="_blank" rel="noopener noreferrer">web-vitals</a> JavaScript library <a href="https://github.com/GoogleChrome/web-vitals/pull/87" target="_blank" rel="noopener noreferrer">supports bfcache restores</a> in the metrics it reports. Developers using v1 or greater should not need to update their code.</p></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="additional-resources">Additional Resources<a href="#additional-resources" class="hash-link" aria-label="Direct link to Additional Resources" title="Direct link to Additional Resources">​</a></h2><ul><li><a href="https://developer.mozilla.org/Firefox/Releases/1.5/Using_Firefox_1.5_caching" target="_blank" rel="noopener noreferrer">Firefox Caching</a> <em>(bfcache in Firefox)</em></li><li><a href="https://webkit.org/blog/427/webkit-page-cache-i-the-basics/" target="_blank" rel="noopener noreferrer">Page Cache</a> <em>(bfcache in Safari)</em></li><li><a href="https://docs.google.com/document/d/1JtDCN9A_1UBlDuwkjn1HWxdhQ1H2un9K4kyPLgBqJUc/edit?usp=sharing" target="_blank" rel="noopener noreferrer">Back/forward cache: web exposed behavior</a> <em>(bfcache differences across browsers)</em></li><li><a href="https://back-forward-cache-tester.glitch.me/?persistent_logs=1" target="_blank" rel="noopener noreferrer">bfcache tester</a> <em>(test how different APIs and events affect bfcache in browsers)</em></li></ul><blockquote><p><a href="https://web.dev/bfcache/" target="_blank" rel="noopener noreferrer">原文 - Back/forward cache</a></p></blockquote></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/javascript">javascript</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/browser">browser</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/译文">译文</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2021/03/13/macos-change-default-behavior-function-keys">macOS - 更改功能键的默认行为</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-03-13T00:00:00.000Z" itemprop="datePublished">March 13, 2021</time> · <!-- -->One min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/alanwei43" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/2927578?s=460&amp;u=153132e7aa3be8295a1703af9b759ca22338f557&amp;v=4" alt="Alan"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/alanwei43" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Alan</span></a></div><small class="avatar__subtitle" itemprop="description">Maintainer of blog</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>如果您要更改顶行按键(F1~F12)以使它们在无需按住 Fn 键的情况下用作标准功能键，请按照以下步骤操作：</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/mac">mac</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/keyboard">keyboard</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about macOS - 更改功能键的默认行为" href="/blog/2021/03/13/macos-change-default-behavior-function-keys"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2021/03/09/remove-http-request-referrer">删除HTTP请求头中的 referrer</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-03-09T00:00:00.000Z" itemprop="datePublished">March 9, 2021</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/alanwei43" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/2927578?s=460&amp;u=153132e7aa3be8295a1703af9b759ca22338f557&amp;v=4" alt="Alan"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/alanwei43" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Alan</span></a></div><small class="avatar__subtitle" itemprop="description">Maintainer of blog</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>删除HTTP请求头中的 <code>Referer</code>，能解决部分防盗链问题。</p><p>在页面的 <code>head</code> 里添加以下代码即可删除<code>Referer</code>请求头：</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/http">http</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/web">web</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about 删除HTTP请求头中的 referrer" href="/blog/2021/03/09/remove-http-request-referrer"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2021/03/07/bei-cui-cheng-xu-yuan-yi-ji-cheng-xu-yuan-be-cui">悲催的程序员，以及程序员的悲催</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-03-07T00:00:00.000Z" itemprop="datePublished">March 7, 2021</time> · <!-- -->12 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="http://blog.sina.cn/dpool/blog/u/1645900192#type=-1" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://portrait1.sinaimg.cn/1645900192/blog/180" alt="苏鹏"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="http://blog.sina.cn/dpool/blog/u/1645900192#type=-1" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">苏鹏</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><section style="margin-top:1em"><hr><ul style="margin-left:-1em"><li>作者: <a href="http://blog.sina.cn/dpool/blog/s/blog_621a71a00100qs5r.html" target="_blank">佚名</a></li><li>原文: <a href="http://blog.sina.cn/dpool/blog/s/blog_621a71a00100qs5r.html" target="_blank">http://blog.sina.cn/dpool/blog/s/blog_621a71a00100qs5r.html</a></li><li>本文仅用于本人学习和存档, 文章所有权归作者 <a href="http://blog.sina.cn/dpool/blog/s/blog_621a71a00100qs5r.html" target="_blank">佚名</a> 所有, 如有侵权请发送邮件至 <a href="mailto:me@alanwei.com?subject=删除侵权文章" target="_top">me#alanwei.com(<i>#换成@</i>)</a> 删除此文.</li></ul><hr></section><p><a href="http://blog.sina.cn/dpool/blog/s/blog_621a71a00100qs5r.html" target="_blank" rel="noopener noreferrer">原文 - 悲催的程序员，以及程序员的悲催[转](转载自http://www.douban.com/note/122664737/水之印象豆瓣）</a></p><p>我尽量用平和一点的口吻跟你说说关于程序员的那点事儿。</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/日志">日志</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/文章">文章</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/摘抄">摘抄</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/转摘">转摘</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about 悲催的程序员，以及程序员的悲催" href="/blog/2021/03/07/bei-cui-cheng-xu-yuan-yi-ji-cheng-xu-yuan-be-cui"><b>Read More</b></a></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/page/9"><div class="pagination-nav__label">Newer Entries</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/page/11"><div class="pagination-nav__label">Older Entries</div></a></nav></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Recommend</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/articles/es6-in-depth/introduction">深入浅出ES6 - InfoQ.cn</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/articles/why-java-sucks-and-csharp-rocks/compare-purpose">Why Java Sucks and C# Rocks - 赵劼</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/reading">阅读笔记</a></li></ul></div><div class="col footer__col"><div class="footer__title">Translate</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/built-in/docusaurus/">Docusaurus Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/built-in/docusaurus/docs/markdown-features">Docusaurus Markdown</a></li><li class="footer__item"><a class="footer__link-item" href="/blog/2022/03/12/caddy-intro">Caddy 简介</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/alanwei43/node-io-lib" target="_blank" rel="noopener noreferrer" class="footer__link-item">node-io-lib - GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/alanwei43/docker-puppeteer" target="_blank" rel="noopener noreferrer" class="footer__link-item">docker-puppeteer - GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/alanwei43/code-server" target="_blank" rel="noopener noreferrer" class="footer__link-item">code-server - GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Alan's Blog</div></div></div></footer></div>
<script src="/assets/js/runtime~main.561933f1.js"></script>
<script src="/assets/js/main.c3ec37e0.js"></script>
</body>
</html>